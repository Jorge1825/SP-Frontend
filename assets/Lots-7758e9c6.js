import{s as I,_ as ye,f as n,h as _e,l as we,m as he,r as p,o as A,c as qe,a as c,d as l,w as r,i,g as F,j as Ve,F as xe,q as f,t as ze,v as z,p as Se,e as Le,x as ee}from"./index-2558a67d.js";import{g as E,m as ke,M as Ie,B as Ee,a as te}from"./ModalForm-db2ed3e8.js";const Oe=async()=>{try{const a=E(),{data:s}=await I.get("/maintenance/lots",{headers:{token:a}});return s}catch(a){console.error(a)}},Ce=async a=>{try{const s=E(),{data:d}=await I.post("/maintenance/lots/register",{name:a.name,areasize:a.areasize,lotestate:a.lotestate,soildstate:a.soildstate,classlote:a.classlote,sowingdensity:a.sowingdensity,description:a.description},{headers:{token:s}});return d}catch(s){console.error(s)}},Ae=async a=>{try{const s=E(),{data:d}=await I.put(`/maintenance/lots/update/${a.id}`,{name:a.name,areasize:a.areasize,lotestate:a.lotestate,soildstate:a.soildstate,classlote:a.classlote,sowingdensity:a.sowingdensity,description:a.description},{headers:{token:s}});return d}catch(s){console.error(s)}},De=async a=>{try{const s=E(),{data:d}=await I.put(`/maintenance/lots/inactive/${a}`,{},{headers:{token:s}});return d}catch(s){console.error(s)}},Me=async a=>{try{const s=E(),{data:d}=await I.put(`/maintenance/lots/active/${a}`,{},{headers:{token:s}});return d}catch(s){console.error(s)}};const G=a=>(Se("data-v-37ea0b2e"),a=a(),Le(),a),Ue={class:"q-py-md table-container"},Te=G(()=>c("h6",{class:"title q-my-lg"},"LOTES",-1)),Ne={class:"container-content"},Be={class:"container-table q-mt-md q-pa-md",rounded:""},We={class:"accions-td"},Re={class:"accions-td"},je=G(()=>c("i",{class:"icon icon-check"},null,-1)),Fe={class:"q-my-md text-center"},Ge={class:"row q-px-xl"},Qe={class:"col-12"},He=G(()=>c("span",{class:"text-required q-pb-sm"},[ee("Todos los campos con "),c("span",{class:"text-red"},"*"),ee(" son obligatorios")],-1)),Je={class:"row justify-center"},Ke={__name:"Lots",setup(a){const s=ke(),d=n(""),O=n(!1),D=n(!0),x=n([]),L=n([]),Q=n(),H=_e(()=>v.value==""),S=[e=>!!e||"Este campo es requerido"];let g=n(""),v=n(""),m=n(""),b=n(""),y=n(""),_=n(""),w=n(""),h=n(""),M=n(""),U=n(""),T=n(""),N=n(""),B=n(""),W=n(""),R=n(""),V=n("active");const q=we(),J=n([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"areasize",label:"Tamaño",field:"areasize",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"lotestate",label:"Estado del lote",field:"lotestate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"soildstate",label:"Estado del suelo",field:"soildstate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"classlot",label:"Clase",field:"classlot",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"sowingdensity",label:"Densidad de siembra",field:"sowingdensity",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),ae=e=>{v.value=e},oe=e=>{m.value=e},le=e=>{b.value=e},se=e=>{y.value=e},ne=e=>{_.value=e},ie=e=>{w.value=e},re=e=>{h.value=e},ue=()=>{d.value="REGISTRAR LOTE",M.value="",U.value="",T.value="",N.value="",B.value="",W.value="",R.value="",D.value=!0,s.toggleModal(),v.value="",m.value="",b.value="",y.value="",_.value="",w.value="",h.value=""},ce=e=>{d.value="EDITAR LOTE",D.value=!1,Q.value=e._id,M.value=e.name,U.value=e.areasize,T.value=e.lotestate,N.value=e.soildstate,B.value=e.classlot,W.value=e.sowingdensity,R.value=e.description,v.value=e.name,m.value=e.areasize,b.value=e.lotestate,y.value=e.soildstate,_.value=e.classlot,w.value=e.sowingdensity,h.value=e.description,s.toggleModal()};async function de(e){try{const o=await De(e);q.notify({type:"positive",message:"Lote desactivado correctamente",position:"top"}),x.value=[],L.value=[],k()}catch{q.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function ve(){s.toggleModal();try{const e=await Ce({name:v.value,areasize:m.value,lotestate:b.value,soildstate:y.value,classlot:_.value,sowingdensity:w.value,description:h.value});q.notify({type:"positive",message:"Lote registrado correctamente",position:"top"}),x.value=[],k()}catch{q.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const k=async()=>{x.value=[],L.value=[],O.value=!0;try{const{lots:e}=await Oe();let o=1,C=1;e.forEach(u=>{u.status=u.status?"Inactivo":"Activo",u.status=="Activo"?(u.id=o++,x.value.push(u)):(u.id=C++,L.value.push(u)),u.description=u.description.trim()==""?"No registra":u.description}),O.value=!1}catch{q.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function pe(){try{const e=await Ae({id:Q.value,name:v.value,areasize:m.value,lotestate:b.value,soildstate:y.value,classlot:_.value,sowingdensity:w.value,description:h.value});q.notify({type:"positive",position:"top",message:"Lote actualizado correctamente"}),s.toggleModal(),x.value=[],k()}catch{q.notify({type:"negative",position:"top",message:"Ocurrió un error"})}v.value="",m.value="",b.value="",y.value="",_.value="",w.value="",h.value=""}async function fe(e){try{const o=await Me(e);q.notify({type:"positive",message:"Lote activado correctamente",position:"top"}),x.value=[],L.value=[],k()}catch{q.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return he(()=>{k()}),(e,o)=>{const C=p("q-separator"),u=p("q-tab"),ge=p("q-tabs"),K=p("q-icon"),P=p("q-input"),j=p("q-btn"),X=p("q-btn-group"),Y=p("q-table"),Z=p("q-tab-panel"),me=p("q-tab-panels"),be=p("q-card");return A(),qe(xe,null,[c("div",Ue,[Te,l(C,{class:"separator"}),c("div",Ne,[l(Ee,{onOnClick:ue,label:"Crear nuevo lote"}),c("div",Be,[l(be,null,{default:r(()=>[l(ge,{modelValue:i(V),"onUpdate:modelValue":o[0]||(o[0]=t=>f(V)?V.value=t:V=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[l(u,{name:"active",label:"Activos"}),l(u,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(C),l(me,{modelValue:i(V),"onUpdate:modelValue":o[3]||(o[3]=t=>f(V)?V.value=t:V=t),animated:""},{default:r(()=>[l(Z,{name:"active"},{default:r(()=>[l(Y,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:x.value,columns:J.value,filter:i(g),loading:O.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[l(P,{borderless:"",dense:"",debounce:"300",modelValue:i(g),"onUpdate:modelValue":o[1]||(o[1]=t=>f(g)?g.value=t:g=t),placeholder:"Search"},{append:r(()=>[l(K,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(t=>[c("td",We,[l(X,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[l(j,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:$=>ce(t.row)},null,8,["onClick"]),l(j,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:$=>de(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(Z,{name:"inactive"},{default:r(()=>[l(Y,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:L.value,columns:J.value,filter:i(g),loading:O.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[l(P,{borderless:"",dense:"",debounce:"300",modelValue:i(g),"onUpdate:modelValue":o[2]||(o[2]=t=>f(g)?g.value=t:g=t),placeholder:"Search"},{append:r(()=>[l(K,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(t=>[c("td",Re,[l(X,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[l(j,{"text-color":"blue-10",class:"col q-pa-none",onClick:$=>fe(t.row._id)},{default:r(()=>[je]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),i(s).modalIsOpen?(A(),F(Ie,{key:0},{default:r(()=>[c("h6",Fe,ze(d.value),1),c("div",Ge,[c("div",Qe,[l(z,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:S,value:i(M),modelValue:i(v),"onUpdate:modelValue":o[4]||(o[4]=t=>f(v)?v.value=t:v=t),onOnWrite:ae},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Tamaño",type:"number",required:!0,ruless:S,value:i(U),modelValue:i(m),"onUpdate:modelValue":o[5]||(o[5]=t=>f(m)?m.value=t:m=t),onOnWrite:oe},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Estado del lote",type:"text",required:!0,ruless:S,value:i(T),modelValue:i(b),"onUpdate:modelValue":o[6]||(o[6]=t=>f(b)?b.value=t:b=t),onOnWrite:le},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Estado del suelo",type:"text",required:!0,ruless:S,value:i(N),modelValue:i(y),"onUpdate:modelValue":o[7]||(o[7]=t=>f(y)?y.value=t:y=t),onOnWrite:se},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Clase",type:"text",required:!0,ruless:S,value:i(B),modelValue:i(_),"onUpdate:modelValue":o[8]||(o[8]=t=>f(_)?_.value=t:_=t),onOnWrite:ne},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Densidad de siembra",type:"number",required:!0,ruless:S,value:i(W),modelValue:i(w),"onUpdate:modelValue":o[9]||(o[9]=t=>f(w)?w.value=t:w=t),onOnWrite:ie},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Descripción",type:"text",required:!1,value:i(R),modelValue:i(h),"onUpdate:modelValue":o[10]||(o[10]=t=>f(h)?h.value=t:h=t),onOnWrite:re},null,8,["value","modelValue"]),He,c("div",Je,[D.value?(A(),F(te,{key:0,disable:i(H),onOnClick:ve},null,8,["disable"])):(A(),F(te,{key:1,disable:i(H),onOnClick:pe},null,8,["disable"]))])])])]),_:1})):Ve("",!0)],64)}}},Ye=ye(Ke,[["__scopeId","data-v-37ea0b2e"]]);export{Ye as default};
