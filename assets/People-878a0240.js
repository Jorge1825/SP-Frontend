import{l as C,s as T,_ as Pe,m as Se,q as Ve,g as s,v as ke,f as oe,x as xe,y as Ee,r as m,o as M,c as ze,a as r,d as l,w as c,h as u,i as U,M as Oe,j as Ae,F as Ie,S as F,z as w,t as Ce,E as j,A as W,B as ne,p as Te,e as De,C as se}from"./index-38b4e5a2.js";import{B as Ne}from"./ButtonAdd-30112040.js";const Me=async o=>{try{const d=C(),{data:n}=await T.get("/maintenance/people",{headers:{token:d,farm:o}});return n}catch(d){return d}},Be=async(o,d)=>{try{const n=C(),{data:p}=await T.post("/maintenance/people/register",{name:o.name,tpdct:o.tpdct,document:o.document,phone:o.phone,eps:o.eps,typePeople:o.typePeople},{headers:{token:n,farm:d}});return p}catch(n){return n}},Re=async(o,d)=>{try{const n=C(),{data:p}=await T.post(`/maintenance/people/update/${o.id}`,{name:o.name,tpdct:o.tpdct,document:o.document,phone:o.phone,eps:o.eps,typePeople:o.typePeople},{headers:{token:n,farm:d}});return p}catch(n){return n}},Ue=async(o,d)=>{try{const n=C(),{data:p}=await T.put(`/maintenance/people/inactive/${o}`,{},{headers:{token:n,farm:d}});return p}catch(n){return n}},Fe=async(o,d)=>{try{const n=C(),{data:p}=await T.put(`/maintenance/people/active/${o}`,{},{headers:{token:n,farm:d}});return p}catch(n){return n}};const G=o=>(Te("data-v-5e655017"),o=o(),De(),o),je={class:"q-py-md table-container"},We={class:"row"},Ge=G(()=>r("h6",{class:"title q-my-lg"},"PERSONAS",-1)),Le={class:"container-content"},Qe={class:"container-table q-mt-md q-pa-md",rounded:""},$e={class:"accions-td"},He={class:"accions-td"},Je=G(()=>r("i",{class:"icon icon-check"},null,-1)),Ke={class:"modal-people"},Xe={class:"q-my-md text-center"},Ye={class:"row q-px-xl"},Ze={class:"col-12"},ea={class:"row"},aa=G(()=>r("span",{class:"text-required q-pb-sm"},[se("Todos los campos con "),r("span",{class:"text-red"},"*"),se(" son obligatorios")],-1)),ta={class:"row justify-center"},la={__name:"People",setup(o){const d=Se(),n=Ve(),p=s(""),B=s(!0),L=s(),ue=ke(),k=s(!1),x=s([]),v=s(!1),A=s([]),Q=oe(()=>g.value==""||b.value==""||y.value==""||h.value==""||i.value==""||q.value==""?!0:k.value==!0),E=[e=>!!e||"Este campo es requerido"];let _=s(""),V=s("active"),g=s(""),b=s(""),y=s(""),h=s(""),i=s(""),q=s(""),$=s(""),H=s(""),J=s(""),K=s(""),X=s(""),Y=s("");const Z=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"document",label:"Tipo",field:"tpdct",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"document",label:"Documento",field:"document",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"phone",label:"Teléfono",field:"phone",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"eps",label:"Eps",field:"eps",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"typePeople",label:"Tipo de Persona",field:"typePeople",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),re=e=>{g.value=e},ce=e=>{b.value=e},ie=e=>{y.value=e},de=e=>{h.value=e},pe=e=>{i.value=e},ve=e=>{q.value=e},fe=()=>{p.value="REGISTRAR PERSONA",me(),B.value=!0,n.toggleModal()},me=()=>{g.value="",b.value="",y.value="",h.value="",i.value="",q.value=""},_e=async e=>{p.value="EDITAR PERSONA",B.value=!1,L.value=e._id,g.value=e.tpdct,$.value=e.tpdct,b.value=e.document,H.value=e.document,y.value=e.name,J.value=e.name,h.value=e.phone,K.value=e.phone,q.value=e.typePeople,Y.value=e.typePeople,i.value=e.eps,X.value=e.eps,n.toggleModal()},P=(e,a)=>{d.notify({type:e,message:a,position:"top"})};async function z(){x.value=[],A.value=[],v.value=!0;try{const{people:e}=await Me(S.value),{eps:a}=await F(S.value);let D=1,N=1;e.forEach(f=>{f.status=f.status?"Inactivo":"Activo";let O=f.eps;a.forEach(I=>{I._id==O&&(O=I.name)}),f.eps=O,f.status=="Activo"?(f.id=D++,x.value.push(f)):(f.id=N++,A.value.push(f))}),v.value=!1}catch{v.value=!1,P("negative","Ocurrió un error")}}async function ge(){const{eps:e}=await F(S.value);e.forEach(a=>{a.name==i.value&&(i.value=a._id)}),k.value=!0;try{const a=await Be({name:y.value,tpdct:g.value,document:b.value,phone:h.value,eps:i.value,typePeople:q.value},S.value);k.value=!1,P("positive","Se registró correctamente"),n.toggleModal(),x.value=[],z()}catch{k.value=!1,P("negative","Ocurrió un error")}}async function be(){const{eps:e}=await F(S.value);e.forEach(a=>{a.name==i.value&&(i.value=a._id)}),k.value=!0;try{const a=await Re({id:L.value,name:y.value,tpdct:g.value,document:b.value,phone:h.value,eps:i.value,typePeople:q.value},S.value);k.value=!1,P("positive","Se actualizó correctamente"),n.toggleModal(),x.value=[],z()}catch{k.value=!1,P("negative","Ocurrió un error")}}async function ye(e){v.value=!0;try{const a=await Fe(e,S.value);P("positive","Se activó correctamente"),v.value=!1,x.value=[],A.value=[],z()}catch{v.value=!1,P("negative","Ocurrió un error")}}async function he(e){v.value=!0;try{const a=await Ue(e,S.value);P("positive","Se inactivó correctamente"),v.value=!1,x.value=[],A.value=[],z()}catch{v.value=!1,P("negative","Ocurrió un error")}}const S=oe(()=>ue.idSelected);return xe(S,()=>{z()}),Ee(()=>{z()}),(e,a)=>{const D=m("q-separator"),N=m("q-tab"),f=m("q-tabs"),O=m("q-icon"),I=m("q-input"),R=m("q-btn"),ee=m("q-btn-group"),ae=m("q-table"),te=m("q-tab-panel"),qe=m("q-tab-panels"),we=m("q-card");return M(),ze(Ie,null,[r("div",je,[r("div",We,[r("i",{class:"icon icon-backRoute q-pt-lg",onClick:a[0]||(a[0]=t=>e.$router.back())}),Ge]),l(D,{class:"separator"}),r("div",Le,[l(Ne,{onOnClick:fe,label:"Crear nueva persona"}),r("div",Qe,[l(we,null,{default:c(()=>[l(f,{modelValue:u(V),"onUpdate:modelValue":a[1]||(a[1]=t=>w(V)?V.value=t:V=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[l(N,{name:"active",label:"Activos"}),l(N,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(D),l(qe,{modelValue:u(V),"onUpdate:modelValue":a[4]||(a[4]=t=>w(V)?V.value=t:V=t),animated:""},{default:c(()=>[l(te,{name:"active"},{default:c(()=>[l(ae,{flat:"",bordered:"",title:"Personas","row-key":"name",rows:x.value,columns:Z.value,filter:u(_),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[l(I,{borderless:"",dense:"",debounce:"300",modelValue:u(_),"onUpdate:modelValue":a[2]||(a[2]=t=>w(_)?_.value=t:_=t),placeholder:"Buscar"},{append:c(()=>[l(O,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(t=>[r("td",$e,[l(ee,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[l(R,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:le=>_e(t.row)},null,8,["onClick"]),l(R,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:le=>he(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(te,{name:"inactive"},{default:c(()=>[l(ae,{flat:"",bordered:"",title:"Personas","row-key":"name",rows:A.value,columns:Z.value,filter:u(_),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[l(I,{borderless:"",dense:"",debounce:"300",modelValue:u(_),"onUpdate:modelValue":a[3]||(a[3]=t=>w(_)?_.value=t:_=t),placeholder:"Search"},{append:c(()=>[l(O,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(t=>[r("td",He,[l(ee,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[l(R,{"text-color":"blue-10",class:"col q-pa-none",onClick:le=>ye(t.row._id)},{default:c(()=>[Je]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),u(n).modalIsOpen?(M(),U(Oe,{key:0,class:"modal"},{default:c(()=>[r("div",Ke,[r("h6",Xe,Ce(p.value),1),r("div",Ye,[r("div",Ze,[r("div",ea,[l(j,{class:"col-5 q-mb-lg q-pr-sm",type:"documents",label:"Tipo de Documento",ruless:E,modelValue:u(g),"onUpdate:modelValue":a[5]||(a[5]=t=>w(g)?g.value=t:g=t),value:u($),onOnSelect:re},null,8,["modelValue","value"]),l(W,{class:"col-7 q-pb-xs",label:"Número de Documento",required:!0,type:"number",ruless:E,value:u(H),modelValue:u(b),"onUpdate:modelValue":a[6]||(a[6]=t=>w(b)?b.value=t:b=t),onOnWrite:ce},null,8,["value","modelValue"])]),l(W,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:E,value:u(J),modelValue:u(y),"onUpdate:modelValue":a[7]||(a[7]=t=>w(y)?y.value=t:y=t),onOnWrite:ie},null,8,["value","modelValue"]),l(W,{class:"q-pb-xs",label:"Teléfono",required:!0,type:"text",ruless:E,modelValue:u(h),"onUpdate:modelValue":a[8]||(a[8]=t=>w(h)?h.value=t:h=t),value:u(K),onOnWrite:de},null,8,["modelValue","value"]),l(j,{class:"q-pb-xs q-mb-md",label:"EPS",required:!0,ruless:E,value:u(X),modelValue:u(i),"onUpdate:modelValue":a[9]||(a[9]=t=>w(i)?i.value=t:i=t),type:"eps",onOnSelect:pe},null,8,["value","modelValue"]),l(j,{class:"q-pb-xs",label:"Tipo de Persona",required:!0,type:"person",ruless:E,value:u(Y),modelValue:u(q),"onUpdate:modelValue":a[10]||(a[10]=t=>w(q)?q.value=t:q=t),onOnSelect:ve},null,8,["value","modelValue"]),aa,r("div",ta,[B.value?(M(),U(ne,{key:0,disable:u(Q),onOnClick:ge},null,8,["disable"])):(M(),U(ne,{key:1,disable:u(Q),onOnClick:be},null,8,["disable"]))])])])])]),_:1})):Ae("",!0)],64)}}},sa=Pe(la,[["__scopeId","data-v-5e655017"]]);export{sa as default};
