import{l as E,s as I,_ as ye,m as he,q as qe,g as n,v as we,f as Z,x as Ce,y as ke,r as d,o as A,c as ee,a as i,d as o,w as c,h as r,i as $,M as xe,j as te,F as Ve,D as j,z as x,t as Te,A as W,E as Se,B as ae,p as Oe,e as Ae,C as oe}from"./index-3a09a4c6.js";import{B as Ee}from"./ButtonAdd-4b004f79.js";const Ie=async l=>{try{const u=E(),{data:s}=await I.get("/transformation/costtrans",{headers:{token:u,farm:l}});return s}catch(u){return u}},ze=async(l,u)=>{try{const s=E(),{data:v}=await I.post("/transformation/costtrans/register",{name:l.name,description:l.description,lot:l.lot,cost:l.cost},{headers:{token:s,farm:u}});return v}catch(s){return s}},De=async(l,u)=>{try{const s=E(),{data:v}=await I.put(`/transformation/costtrans/update/${l.id}`,{name:l.name,description:l.description,lot:l.lot,cost:l.cost},{headers:{token:s,farm:u}});return v}catch(s){return s}},Be=async(l,u)=>{try{const s=E(),{data:v}=await I.put(`/transformation/costtrans/inactive/${l}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}},Ne=async(l,u)=>{try{const s=E(),{data:v}=await I.put(`/transformation/costtrans/active/${l}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}};const G=l=>(Oe("data-v-ac5b34a0"),l=l(),Ae(),l),Me={class:"q-py-sm table-container"},Re={class:"row"},Ue=G(()=>i("h6",{class:"title q-my-lg"},"Costos de transformación",-1)),Le={class:"container-content"},Fe={class:"container-table q-mt-md q-pa-md",rounded:""},$e={class:"accions-td"},je={class:"accions-td"},We=G(()=>i("i",{class:"icon icon-check"},null,-1)),Ge={class:"modal-transformation"},Qe={class:"q-my-md text-center"},He={class:"row q-px-xl"},Je={class:"col-12"},Ke=G(()=>i("span",{class:"text-required q-pb-sm"},[oe("Todos los campos con "),i("span",{class:"text-red"},"*"),oe(" son obligatorios")],-1)),Pe={class:"row justify-center"},Xe={key:0,class:"spinner"},Ye={__name:"CostTransformation",setup(l){const u=he(),s=qe(),v=n(""),f=n(!1),N=n(!0),k=n([]),S=n([]),Q=n(),se=we(),w=n(!1),H=Z(()=>m.value==""||_.value==""||p.value==""?!0:w.value==!0),z=[e=>!!e||"Este campo es requerido"];let y=n(""),C=n("active"),m=n(""),p=n(""),_=n(""),g=n(""),M=n(""),R=n(""),U=n(""),L=n("");const J=n([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"lot",label:"Lote",field:"lot",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"cost",label:"Costo",field:"cost",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),le=e=>{m.value=e},ne=e=>{p.value=e},re=e=>{_.value=e},ie=e=>{g.value=e},ce=()=>{v.value="REGISTRAR COSTO",ue(),N.value=!0,s.toggleModal()},ue=()=>{M.value="",R.value="",U.value="",L.value="",m.value="",p.value="",_.value="",g.value=""},de=e=>{v.value="EDITAR COSTO",N.value=!1,Q.value=e._id,M.value=e.name,R.value=e.description,U.value=e.cost,m.value=e.name,p.value=e.description,_.value=e.cost,L.value=e.lot,g.value=e.lot,s.toggleModal()},h=(e,t)=>{u.notify({type:e,message:t,position:"top"})},V=async()=>{k.value=[],S.value=[],f.value=!0;try{const{costs:e}=await Ie(q.value),{lots:t}=await j(q.value);let D=1,B=1;e.forEach(b=>{b.status=b.status?"Inactivo":"Activo";let T=b.lot;t.forEach(O=>{O._id==T&&(T=O.name)}),b.lot=T,b.status=="Activo"?(b.id=D++,k.value.push(b)):(b.id=B++,S.value.push(b))}),f.value=!1}catch{f.value=!1,h("negative","Ocurrió un error")}};async function ve(){const{lots:e}=await j(q.value);e.forEach(t=>{t.name==g.value&&(g.value=t._id)}),w.value=!0;try{await ze({name:m.value,description:p.value,lot:g.value,cost:_.value},q.value),w.value=!1,h("positive","Costo de transformación registrado correctamente"),s.toggleModal(),k.value=[],V()}catch{w.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}}async function fe(){const{lots:e}=await j(q.value);e.forEach(t=>{t.name==g.value&&(g.value=t._id)}),w.value=!0;try{await De({id:Q.value,name:m.value,description:p.value,lot:g.value,cost:_.value},q.value),w.value=!1,h("positive","Costo de transformación actualizado correctamente"),s.toggleModal(),k.value=[],V()}catch{w.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}m.value="",p.value="",g.value="",_.value=""}async function me(e){f.value=!0;try{await Ne(e,q.value),h("positive","Costo de transformación activado correctamente"),f.value=!1,k.value=[],S.value=[],V()}catch{f.value=!1,h("negative","Ocurrió un error")}}async function pe(e){f.value=!1;try{await Be(e,q.value),f.value=!1,h("positive","Costo de transformación desactivado correctamente"),k.value=[],S.value=[],V()}catch{f.value=!1,h("negative","Ocurrió un error")}}const q=Z(()=>se.idSelected);return Ce(q,()=>{V()}),ke(()=>{V()}),(e,t)=>{const D=d("q-separator"),B=d("q-tab"),b=d("q-tabs"),T=d("q-icon"),O=d("q-input"),F=d("q-btn"),K=d("q-btn-group"),P=d("q-table"),X=d("q-tab-panel"),_e=d("q-tab-panels"),ge=d("q-card"),be=d("q-spinner-ios");return A(),ee(Ve,null,[i("div",Me,[i("div",Re,[i("i",{class:"icon icon-backRoute q-pt-lg",onClick:t[0]||(t[0]=a=>e.$router.back())}),Ue]),o(D,{class:"separator"}),i("div",Le,[o(Ee,{onOnClick:ce,label:"Registar costo de transformación"}),i("div",Fe,[o(ge,null,{default:c(()=>[o(b,{modelValue:r(C),"onUpdate:modelValue":t[1]||(t[1]=a=>x(C)?C.value=a:C=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[o(B,{name:"active",label:"Activos"}),o(B,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),o(D),o(_e,{modelValue:r(C),"onUpdate:modelValue":t[4]||(t[4]=a=>x(C)?C.value=a:C=a),animated:""},{default:c(()=>[o(X,{name:"active"},{default:c(()=>[o(P,{flat:"",bordered:"",title:"Costos de transformación","row-key":"name",rows:k.value,columns:J.value,filter:r(y),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[o(O,{borderless:"",dense:"",debounce:"300",modelValue:r(y),"onUpdate:modelValue":t[2]||(t[2]=a=>x(y)?y.value=a:y=a),placeholder:"Search"},{append:c(()=>[o(T,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(a=>[i("td",$e,[o(K,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[o(F,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:Y=>de(a.row)},null,8,["onClick"]),o(F,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:Y=>pe(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),o(X,{name:"inactive"},{default:c(()=>[o(P,{flat:"",bordered:"",title:"Costos de transformación","row-key":"name",rows:S.value,columns:J.value,filter:r(y),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[o(O,{borderless:"",dense:"",debounce:"300",modelValue:r(y),"onUpdate:modelValue":t[3]||(t[3]=a=>x(y)?y.value=a:y=a),placeholder:"Search"},{append:c(()=>[o(T,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(a=>[i("td",je,[o(K,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[o(F,{"text-color":"blue-10",class:"col q-pa-none",onClick:Y=>me(a.row._id)},{default:c(()=>[We]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),r(s).modalIsOpen?(A(),$(xe,{key:0,class:"modal"},{default:c(()=>[i("div",Ge,[i("h6",Qe,Te(v.value),1),i("div",He,[i("div",Je,[o(W,{label:"Nombre",required:!0,type:"text",ruless:z,value:r(M),modelValue:r(m),"onUpdate:modelValue":t[5]||(t[5]=a=>x(m)?m.value=a:m=a),onOnWrite:le},null,8,["value","modelValue"]),o(Se,{class:"q-pb-lg",type:"lots",label:"Lote","v-model":r(g),required:!0,ruless:z,value:r(L),onOnSelect:ie},null,8,["v-model","value"]),o(W,{class:"q-mb-md",label:"Descripción",required:!0,type:"text",ruless:z,value:r(R),modelValue:r(p),"onUpdate:modelValue":t[6]||(t[6]=a=>x(p)?p.value=a:p=a),onOnWrite:ne},null,8,["value","modelValue"]),o(W,{class:"q-pb-xs",label:"Costo",required:!0,type:"text",ruless:z,value:r(U),modelValue:r(_),"onUpdate:modelValue":t[7]||(t[7]=a=>x(_)?_.value=a:_=a),onOnWrite:re},null,8,["value","modelValue"]),Ke,i("div",Pe,[N.value?(A(),$(ae,{key:0,disable:r(H),onOnClick:ve},null,8,["disable"])):(A(),$(ae,{key:1,disable:r(H),onOnClick:fe},null,8,["disable"]))]),w.value?(A(),ee("div",Xe,[o(be,{color:"primary",size:"2.5em"})])):te("",!0)])])])]),_:1})):te("",!0)],64)}}},tt=ye(Ye,[["__scopeId","data-v-ac5b34a0"]]);export{tt as default};
