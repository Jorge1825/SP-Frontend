import{g as ge,i as be,p as ye,u as _e,a as qe}from"./index-f67388af.js";import{m as we,M as he,B as Ve,a as Z}from"./ModalForm-cb6eb8ec.js";import{_ as Se,f as o,h as Le,l as ze,m as xe,r as d,o as O,c as Ie,a as u,d as l,w as n,i as s,g as R,j as ke,F as Oe,q as c,t as Ce,s as h,p as Ee,e as Ae,v as $}from"./index-a0c708ca.js";const j=x=>(Ee("data-v-97a03f83"),x=x(),Ae(),x),De={class:"q-py-md table-container"},Me=j(()=>u("h6",{class:"title q-my-lg"},"LOTES",-1)),Ue={class:"container-content"},Ne={class:"container-table q-mt-md q-pa-md",rounded:""},Te={class:"accions-td"},Be={class:"accions-td"},We=j(()=>u("i",{class:"icon icon-check"},null,-1)),Re={class:"q-my-md text-center"},je={class:"row q-px-xl"},Fe={class:"col-12"},Ge=j(()=>u("span",{class:"text-required q-pb-sm"},[$("Todos los campos con "),u("span",{class:"text-red"},"*"),$(" son obligatorios")],-1)),Qe={class:"row justify-center"},He={__name:"Lots",setup(x){const S=we(),C=o(""),I=o(!1),E=o(!0),w=o([]),L=o([]),F=o(),G=Le(()=>r.value==""),V=[e=>!!e||"Este campo es requerido"];let v=o(""),r=o(""),p=o(""),f=o(""),m=o(""),g=o(""),b=o(""),y=o(""),A=o(""),D=o(""),M=o(""),U=o(""),N=o(""),T=o(""),B=o(""),q=o("active");const _=ze(),Q=o([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"areasize",label:"Tamaño",field:"areasize",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"lotestate",label:"Estado del lote",field:"lotestate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"soildstate",label:"Estado del suelo",field:"soildstate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"classlot",label:"Clase",field:"classlot",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"sowingdensity",label:"Densidad de siembra",field:"sowingdensity",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),ee=e=>{r.value=e},te=e=>{p.value=e},ae=e=>{f.value=e},le=e=>{m.value=e},oe=e=>{g.value=e},se=e=>{b.value=e},ne=e=>{y.value=e},ie=()=>{C.value="REGISTRAR LOTE",A.value="",D.value="",M.value="",U.value="",N.value="",T.value="",B.value="",E.value=!0,S.toggleModal(),r.value="",p.value="",f.value="",m.value="",g.value="",b.value="",y.value=""},ue=e=>{C.value="EDITAR LOTE",E.value=!1,F.value=e._id,A.value=e.name,D.value=e.areasize,M.value=e.lotestate,U.value=e.soildstate,N.value=e.classlot,T.value=e.sowingdensity,B.value=e.description,r.value=e.name,p.value=e.areasize,f.value=e.lotestate,m.value=e.soildstate,g.value=e.classlot,b.value=e.sowingdensity,y.value=e.description,S.toggleModal()};async function re(e){try{const a=await be(e);_.notify({type:"positive",message:"Lote desactivado correctamente",position:"top"}),w.value=[],L.value=[],z()}catch{_.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function de(){S.toggleModal();try{const e=await ye({name:r.value,areasize:p.value,lotestate:f.value,soildstate:m.value,classlot:g.value,sowingdensity:b.value,description:y.value});_.notify({type:"positive",message:"Lote registrado correctamente",position:"top"}),w.value=[],z()}catch{_.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const z=async()=>{w.value=[],L.value=[],I.value=!0;try{const{lots:e}=await ge();let a=1,k=1;e.forEach(i=>{i.status=i.status?"Inactivo":"Activo",i.status=="Activo"?(i.id=a++,w.value.push(i)):(i.id=k++,L.value.push(i)),i.description=i.description.trim()==""?"No registra":i.description}),I.value=!1}catch{_.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function ce(){try{const e=await _e({id:F.value,name:r.value,areasize:p.value,lotestate:f.value,soildstate:m.value,classlot:g.value,sowingdensity:b.value,description:y.value});_.notify({type:"positive",position:"top",message:"Lote actualizado correctamente"}),S.toggleModal(),w.value=[],z()}catch{_.notify({type:"negative",position:"top",message:"Ocurrió un error"})}r.value="",p.value="",f.value="",m.value="",g.value="",b.value="",y.value=""}async function ve(e){try{const a=await qe(e);_.notify({type:"positive",message:"Lote activado correctamente",position:"top"}),w.value=[],L.value=[],z()}catch{_.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return xe(()=>{z()}),(e,a)=>{const k=d("q-separator"),i=d("q-tab"),pe=d("q-tabs"),H=d("q-icon"),J=d("q-input"),W=d("q-btn"),K=d("q-btn-group"),P=d("q-table"),X=d("q-tab-panel"),fe=d("q-tab-panels"),me=d("q-card");return O(),Ie(Oe,null,[u("div",De,[Me,l(k,{class:"separator"}),u("div",Ue,[l(Ve,{onOnClick:ie,label:"Crear nuevo lote"}),u("div",Ne,[l(me,null,{default:n(()=>[l(pe,{modelValue:s(q),"onUpdate:modelValue":a[0]||(a[0]=t=>c(q)?q.value=t:q=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[l(i,{name:"active",label:"Activos"}),l(i,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(k),l(fe,{modelValue:s(q),"onUpdate:modelValue":a[3]||(a[3]=t=>c(q)?q.value=t:q=t),animated:""},{default:n(()=>[l(X,{name:"active"},{default:n(()=>[l(P,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:w.value,columns:Q.value,filter:s(v),loading:I.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[l(J,{borderless:"",dense:"",debounce:"300",modelValue:s(v),"onUpdate:modelValue":a[1]||(a[1]=t=>c(v)?v.value=t:v=t),placeholder:"Search"},{append:n(()=>[l(H,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(t=>[u("td",Te,[l(K,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[l(W,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:Y=>ue(t.row)},null,8,["onClick"]),l(W,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:Y=>re(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(X,{name:"inactive"},{default:n(()=>[l(P,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:L.value,columns:Q.value,filter:s(v),loading:I.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[l(J,{borderless:"",dense:"",debounce:"300",modelValue:s(v),"onUpdate:modelValue":a[2]||(a[2]=t=>c(v)?v.value=t:v=t),placeholder:"Search"},{append:n(()=>[l(H,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(t=>[u("td",Be,[l(K,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[l(W,{"text-color":"blue-10",class:"col q-pa-none",onClick:Y=>ve(t.row._id)},{default:n(()=>[We]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),s(S).modalIsOpen?(O(),R(he,{key:0},{default:n(()=>[u("h6",Re,Ce(C.value),1),u("div",je,[u("div",Fe,[l(h,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:V,value:s(A),modelValue:s(r),"onUpdate:modelValue":a[4]||(a[4]=t=>c(r)?r.value=t:r=t),onOnWrite:ee},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Tamaño",type:"number",required:!0,ruless:V,value:s(D),modelValue:s(p),"onUpdate:modelValue":a[5]||(a[5]=t=>c(p)?p.value=t:p=t),onOnWrite:te},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Estado del lote",type:"text",required:!0,ruless:V,value:s(M),modelValue:s(f),"onUpdate:modelValue":a[6]||(a[6]=t=>c(f)?f.value=t:f=t),onOnWrite:ae},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Estado del suelo",type:"text",required:!0,ruless:V,value:s(U),modelValue:s(m),"onUpdate:modelValue":a[7]||(a[7]=t=>c(m)?m.value=t:m=t),onOnWrite:le},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Clase",type:"text",required:!0,ruless:V,value:s(N),modelValue:s(g),"onUpdate:modelValue":a[8]||(a[8]=t=>c(g)?g.value=t:g=t),onOnWrite:oe},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Densidad de siembra",type:"number",required:!0,ruless:V,value:s(T),modelValue:s(b),"onUpdate:modelValue":a[9]||(a[9]=t=>c(b)?b.value=t:b=t),onOnWrite:se},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Descripción",type:"text",required:!1,value:s(B),modelValue:s(y),"onUpdate:modelValue":a[10]||(a[10]=t=>c(y)?y.value=t:y=t),onOnWrite:ne},null,8,["value","modelValue"]),Ge,u("div",Qe,[E.value?(O(),R(Z,{key:0,disable:s(G),onOnClick:de},null,8,["disable"])):(O(),R(Z,{key:1,disable:s(G),onOnClick:ce},null,8,["disable"]))])])])]),_:1})):ke("",!0)],64)}}},Xe=Se(He,[["__scopeId","data-v-97a03f83"]]);export{Xe as default};
