import{x as k,_ as le,f as l,h as re,l as ie,m as ce,r as m,o as A,c as ue,a as c,d as t,w as r,i,g as M,j as de,F as me,q as h,t as pe,s as N,p as ve,e as fe,v as $}from"./index-a0c708ca.js";import{g as x,m as _e,M as ge,B as ye,a as H}from"./ModalForm-cb6eb8ec.js";const be=async()=>{try{const n=x(),{data:o}=await k.get("/maintenance/farm",{headers:{token:n}});return o}catch(n){console.error(n)}},he=async n=>{try{const o=x(),{data:u}=await k.post("/maintenance/farm/register",{name:n.name,address:n.address,owner:n.owner},{headers:{token:o}});return u}catch(o){console.error(o)}},we=async n=>{try{const o=x(),{data:u}=await k.put(`/maintenance/farm/update/${n.id}`,{name:n.name,address:n.address,owner:n.owner},{headers:{token:o}});return u}catch(o){console.error(o)}},qe=async n=>{try{const o=x(),{data:u}=await k.put(`/maintenance/farm/inactive/${n}`,{},{headers:{token:o}});return u}catch(o){console.error(o)}},ke=async n=>{try{const o=x(),{data:u}=await k.put(`/maintenance/farm/active/${n}`,{},{headers:{token:o}});return u}catch(o){console.error(o)}};const U=n=>(ve("data-v-a792ee1e"),n=n(),fe(),n),xe={class:"q-py-md table-container"},Fe=U(()=>c("h6",{class:"title q-my-lg"},"Finca",-1)),Ve={class:"container-content"},Ae={class:"container-table q-mt-md q-pa-md",rounded:""},Ie={class:"accions-td"},Se={class:"accions-td"},ze=U(()=>c("i",{class:"icon icon-check"},null,-1)),Ce={class:"q-my-md text-center"},Oe={class:"row q-px-xl"},Ee={class:"col-12"},Me=U(()=>c("span",{class:"text-required q-pb-sm"},[$("Todos los campos con "),c("span",{class:"text-red"},"*"),$(" son obligatorios")],-1)),Ne={class:"row justify-center"},Ue={__name:"Farm",setup(n){const o=_e(),u=l(""),F=l(!1),I=l(!0),b=l([]),w=l([]),B=l(),R=re(()=>d.value==""),S=[a=>!!a||"Este campo es requerido"];let p=l(""),d=l(""),v=l(""),f=l(""),z=l(""),C=l(""),O=l(""),y=l("active");const g=ie(),D=l([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"address",label:"Ubicación",field:"address",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"owner",label:"Propietario",field:"owner",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),J=a=>{d.value=a},K=a=>{v.value=a},L=a=>{f.value=a},X=()=>{u.value="REGISTRAR FINCA",z.value="",C.value="",O.value="",I.value=!0,o.toggleModal(),d.value="",v.value="",f.value=""},Y=a=>{u.value="EDITAR FINCA",I.value=!1,B.value=a._id,z.value=a.name,C.value=a.address,O.value=a.owner,d.value=a.name,v.value=a.address,f.value=a.owner,o.toggleModal()};async function Z(a){try{const s=await qe(a);g.notify({type:"positive",message:"Finca desactivada correctamente",position:"top"}),b.value=[],w.value=[],q()}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function ee(){o.toggleModal();try{const a=await he({name:d.value,address:v.value,owner:f.value});g.notify({type:"positive",message:"Finca registrada correctamente",position:"top"}),b.value=[],q()}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const q=async()=>{b.value=[],w.value=[],F.value=!0;try{const{farms:a}=await be();let s=1,V=1;a.forEach(_=>{_.status=_.status?"Inactivo":"Activo",_.status=="Activo"?(_.id=s++,b.value.push(_)):(_.id=V++,w.value.push(_))}),F.value=!1}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function ae(){try{const a=await we({id:B.value,name:d.value,address:v.value,owner:f.value});g.notify({type:"positive",position:"top",message:"Finca actualizada correctamente"}),o.toggleModal(),b.value=[],q()}catch{g.notify({type:"negative",position:"top",message:"Ocurrió un error"})}d.value="",v.value="",f.value=""}async function te(a){try{const s=await ke(a);g.notify({type:"positive",message:"Finca activada correctamente",position:"top"}),b.value=[],w.value=[],q()}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return ce(()=>{q()}),(a,s)=>{const V=m("q-separator"),_=m("q-tab"),oe=m("q-tabs"),T=m("q-icon"),j=m("q-input"),E=m("q-btn"),W=m("q-btn-group"),P=m("q-table"),G=m("q-tab-panel"),ne=m("q-tab-panels"),se=m("q-card");return A(),ue(me,null,[c("div",xe,[Fe,t(V,{class:"separator"}),c("div",Ve,[t(ye,{onOnClick:X,label:"Crear nueva finca"}),c("div",Ae,[t(se,null,{default:r(()=>[t(oe,{modelValue:i(y),"onUpdate:modelValue":s[0]||(s[0]=e=>h(y)?y.value=e:y=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[t(_,{name:"active",label:"Activos"}),t(_,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),t(V),t(ne,{modelValue:i(y),"onUpdate:modelValue":s[3]||(s[3]=e=>h(y)?y.value=e:y=e),animated:""},{default:r(()=>[t(G,{name:"active"},{default:r(()=>[t(P,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:b.value,columns:D.value,filter:i(p),loading:F.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[t(j,{borderless:"",dense:"",debounce:"300",modelValue:i(p),"onUpdate:modelValue":s[1]||(s[1]=e=>h(p)?p.value=e:p=e),placeholder:"Search"},{append:r(()=>[t(T,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(e=>[c("td",Ie,[t(W,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[t(E,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:Q=>Y(e.row)},null,8,["onClick"]),t(E,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:Q=>Z(e.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),t(G,{name:"inactive"},{default:r(()=>[t(P,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:w.value,columns:D.value,filter:i(p),loading:F.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[t(j,{borderless:"",dense:"",debounce:"300",modelValue:i(p),"onUpdate:modelValue":s[2]||(s[2]=e=>h(p)?p.value=e:p=e),placeholder:"Search"},{append:r(()=>[t(T,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(e=>[c("td",Se,[t(W,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[t(E,{"text-color":"blue-10",class:"col q-pa-none",onClick:Q=>te(e.row._id)},{default:r(()=>[ze]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),i(o).modalIsOpen?(A(),M(ge,{key:0},{default:r(()=>[c("h6",Ce,pe(u.value),1),c("div",Oe,[c("div",Ee,[t(N,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:S,value:i(z),modelValue:i(d),"onUpdate:modelValue":s[4]||(s[4]=e=>h(d)?d.value=e:d=e),onOnWrite:J},null,8,["value","modelValue"]),t(N,{class:"q-pb-xs",label:"Ubicación",type:"text",required:!0,ruless:S,value:i(C),modelValue:i(v),"onUpdate:modelValue":s[5]||(s[5]=e=>h(v)?v.value=e:v=e),onOnWrite:K},null,8,["value","modelValue"]),t(N,{class:"q-pb-xs",label:"Propietario",required:!0,type:"text",ruless:S,value:i(O),modelValue:i(f),"onUpdate:modelValue":s[6]||(s[6]=e=>h(f)?f.value=e:f=e),onOnWrite:L},null,8,["value","modelValue"]),Me,c("div",Ne,[I.value?(A(),M(H,{key:0,disable:i(R),onOnClick:ee},null,8,["disable"])):(A(),M(H,{key:1,disable:i(R),onOnClick:ae},null,8,["disable"]))])])])]),_:1})):de("",!0)],64)}}},De=le(Ue,[["__scopeId","data-v-a792ee1e"]]);export{De as default};
