import{l as k,s as M,_ as oe,m as se,f as r,h as le,q as ie,v as re,r as v,o as V,c as ce,a as d,d as e,w as l,i as c,g as E,M as de,j as ue,F as pe,x as q,t as me,y as G,B as Q,p as ve,e as fe,z as H}from"./index-9b0f9ebe.js";import{g as x,B as _e}from"./ButtonAdd-1e3a5e63.js";const ye=async()=>{try{const o=x(),y=k().idSelected,{data:i}=await M.get("/maintenance/unittypes",{headers:{token:o,farm:y}});return i}catch(o){console.error(o)}},ge=async o=>{try{const t=x(),i=k().idSelected,{data:u}=await M.post("/maintenance/unittypes/register",{name:o.name,unittype:o.unittype},{headers:{token:t,farm:i}});return u}catch(t){console.error(t)}},be=async o=>{try{const t=x(),i=k().idSelected,{data:u}=await M.put(`/maintenance/unittypes/update/${o.id}`,{name:o.name,unittype:o.unittype},{headers:{token:t,farm:i}});return u}catch(t){console.error(t)}},he=async o=>{try{const t=x(),i=k().idSelected,{data:u}=await M.put(`/maintenance/unittypes/inactive/${o}`,{},{headers:{token:t,farm:i}});return u}catch(t){console.error(t)}},qe=async o=>{try{const t=x(),i=k().idSelected,{data:u}=await M.put(`/maintenance/unittypes/active/${o}`,{},{headers:{token:t,farm:i}});return u}catch(t){console.error(t)}};const C=o=>(ve("data-v-aba876b1"),o=o(),fe(),o),we={class:"q-py-md table-container"},Ue=C(()=>d("h6",{class:"title q-my-lg"},"UNIDADES DE MEDIDA",-1)),ke={class:"container-content"},Me={class:"container-table q-mt-md q-pa-md",rounded:""},xe={class:"accions-td"},Se={class:"accions-td"},Ve=C(()=>d("i",{class:"icon icon-check"},null,-1)),De={class:"q-my-md text-center"},Ie={class:"row q-px-xl"},Ae={class:"col-12"},Ee=C(()=>d("span",{class:"text-required q-pb-sm"},[H("Todos los campos con "),d("span",{class:"text-red"},"*"),H(" son obligatorios")],-1)),Ce={class:"row justify-center"},ze={__name:"UnitsMeasurement",setup(o){const t=se(),y=r(""),i=r(!1),u=r(!0),h=r([]),w=r([]),z=r(),N=le(()=>p.value==""||m.value==""),O=[n=>!!n||"Este campo es requerido"];let f=r(""),p=r(""),m=r(""),D=r(""),I=r(""),b=r("active");const g=ie(),T=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"unittype",label:"Tipo de unidad",field:"unittype",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),J=n=>{p.value=n},K=n=>{m.value=n},L=()=>{y.value="REGISTRAR UNIDAD DE MEDIDA",I.value="",D.value="",u.value=!0,t.toggleModal(),p.value="",m.value=""},P=n=>{y.value="EDITAR UNIDAD DE MEDIDA",u.value=!1,z.value=n._id,I.value=n.unittype,D.value=n.name,p.value=n.name,m.value=n.unittype,t.toggleModal()};async function X(n){try{const s=await he(n);g.notify({type:"positive",message:"Unidad de medida desactivada correctamente",position:"top"}),h.value=[],w.value=[],U()}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function Y(){t.toggleModal();try{const n=await ge({name:p.value,unittype:m.value});g.notify({type:"positive",message:"Unidad de medida registrada correctamente",position:"top"}),h.value=[],U()}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const U=async()=>{h.value=[],w.value=[],i.value=!0;try{const{unitType:n}=await ye();let s=1,S=1;n.forEach(_=>{_.status=_.status?"Inactivo":"Activo",_.status=="Activo"?(_.id=s++,h.value.push(_)):(_.id=S++,w.value.push(_))}),i.value=!1}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function Z(){try{const n=await be({id:z.value,name:p.value,unittype:m.value});g.notify({type:"positive",position:"top",message:"Unidad de medida actualizada correctamente"}),t.toggleModal(),h.value=[],U()}catch{g.notify({type:"negative",position:"top",message:"Ocurrió un error"})}p.value="",m.value=""}async function ee(n){try{const s=await qe(n);g.notify({type:"positive",message:"Unidad de medida activada correctamente",position:"top"}),h.value=[],w.value=[],U()}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return re(()=>{U()}),(n,s)=>{const S=v("q-separator"),_=v("q-tab"),te=v("q-tabs"),B=v("q-icon"),F=v("q-input"),A=v("q-btn"),R=v("q-btn-group"),j=v("q-table"),W=v("q-tab-panel"),ae=v("q-tab-panels"),ne=v("q-card");return V(),ce(pe,null,[d("div",we,[Ue,e(S,{class:"separator"}),d("div",ke,[e(_e,{onOnClick:L,label:"Crear unidad de medida"}),d("div",Me,[e(ne,null,{default:l(()=>[e(te,{modelValue:c(b),"onUpdate:modelValue":s[0]||(s[0]=a=>q(b)?b.value=a:b=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[e(_,{name:"active",label:"Activos"}),e(_,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(S),e(ae,{modelValue:c(b),"onUpdate:modelValue":s[3]||(s[3]=a=>q(b)?b.value=a:b=a),animated:""},{default:l(()=>[e(W,{name:"active"},{default:l(()=>[e(j,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:h.value,columns:T.value,filter:c(f),loading:i.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(F,{borderless:"",dense:"",debounce:"300",modelValue:c(f),"onUpdate:modelValue":s[1]||(s[1]=a=>q(f)?f.value=a:f=a),placeholder:"Search"},{append:l(()=>[e(B,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(a=>[d("td",xe,[e(R,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(A,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:$=>P(a.row)},null,8,["onClick"]),e(A,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:$=>X(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(W,{name:"inactive"},{default:l(()=>[e(j,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:w.value,columns:T.value,filter:c(f),loading:i.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(F,{borderless:"",dense:"",debounce:"300",modelValue:c(f),"onUpdate:modelValue":s[2]||(s[2]=a=>q(f)?f.value=a:f=a),placeholder:"Search"},{append:l(()=>[e(B,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(a=>[d("td",Se,[e(R,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(A,{"text-color":"blue-10",class:"col q-pa-none",onClick:$=>ee(a.row._id)},{default:l(()=>[Ve]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(t).modalIsOpen?(V(),E(de,{key:0},{default:l(()=>[d("h6",De,me(y.value),1),d("div",Ie,[d("div",Ae,[e(G,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:O,value:c(D),modelValue:c(p),"onUpdate:modelValue":s[4]||(s[4]=a=>q(p)?p.value=a:p=a),onOnWrite:J},null,8,["value","modelValue"]),e(G,{label:"Tipo de Unidad",required:!0,type:"text",ruless:O,value:c(I),modelValue:c(m),"onUpdate:modelValue":s[5]||(s[5]=a=>q(m)?m.value=a:m=a),onOnWrite:K},null,8,["value","modelValue"]),Ee,d("div",Ce,[u.value?(V(),E(Q,{key:0,disable:c(N),onOnClick:Y},null,8,["disable"])):(V(),E(Q,{key:1,disable:c(N),onOnClick:Z},null,8,["disable"]))])])])]),_:1})):ue("",!0)],64)}}},Te=oe(ze,[["__scopeId","data-v-aba876b1"]]);export{Te as default};
