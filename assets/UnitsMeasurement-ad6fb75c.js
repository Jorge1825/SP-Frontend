import{x as w,_ as ne,f as i,h as oe,l as se,m as le,r as m,o as x,c as ie,a as c,d as t,w as l,i as r,g as E,j as re,F as ce,q as b,t as ue,s as $,p as de,e as pe,v as G}from"./index-a0c708ca.js";import{g as U,m as me,M as ve,B as _e,a as Q}from"./ModalForm-cb6eb8ec.js";const ye=async()=>{try{const o=U(),{data:e}=await w.get("/maintenance/unittypes",{headers:{token:o}});return e}catch(o){console.error(o)}},fe=async o=>{try{const e=U(),{data:u}=await w.post("/maintenance/unittypes/register",{name:o.name,unittype:o.unittype},{headers:{token:e}});return u}catch(e){console.error(e)}},ge=async o=>{try{const e=U(),{data:u}=await w.put(`/maintenance/unittypes/update/${o.id}`,{name:o.name,unittype:o.unittype},{headers:{token:e}});return u}catch(e){console.error(e)}},be=async o=>{try{const e=U(),{data:u}=await w.put(`/maintenance/unittypes/inactive/${o}`,{},{headers:{token:e}});return u}catch(e){console.error(e)}},he=async o=>{try{const e=U(),{data:u}=await w.put(`/maintenance/unittypes/active/${o}`,{},{headers:{token:e}});return u}catch(e){console.error(e)}};const S=o=>(de("data-v-311a6118"),o=o(),pe(),o),qe={class:"q-py-md table-container"},we=S(()=>c("h6",{class:"title q-my-lg"},"UNIDADES DE MEDIDA",-1)),Ue={class:"container-content"},ke={class:"container-table q-mt-md q-pa-md",rounded:""},Me={class:"accions-td"},xe={class:"accions-td"},Ve=S(()=>c("i",{class:"icon icon-check"},null,-1)),De={class:"q-my-md text-center"},Ie={class:"row q-px-xl"},Ae={class:"col-12"},Ee=S(()=>c("span",{class:"text-required q-pb-sm"},[G("Todos los campos con "),c("span",{class:"text-red"},"*"),G(" son obligatorios")],-1)),Se={class:"row justify-center"},Ce={__name:"UnitsMeasurement",setup(o){const e=me(),u=i(""),k=i(!1),V=i(!0),g=i([]),h=i([]),C=i(),z=oe(()=>d.value==""||p.value==""),N=[n=>!!n||"Este campo es requerido"];let v=i(""),d=i(""),p=i(""),D=i(""),I=i(""),f=i("active");const y=se(),O=i([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"unittype",label:"Tipo de unidad",field:"unittype",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),H=n=>{d.value=n},J=n=>{p.value=n},K=()=>{u.value="REGISTRAR UNIDAD DE MEDIDA",I.value="",D.value="",V.value=!0,e.toggleModal(),d.value="",p.value=""},L=n=>{u.value="EDITAR UNIDAD DE MEDIDA",V.value=!1,C.value=n._id,I.value=n.unittype,D.value=n.name,d.value=n.name,p.value=n.unittype,e.toggleModal()};async function P(n){try{const s=await be(n);y.notify({type:"positive",message:"Unidad de medida desactivada correctamente",position:"top"}),g.value=[],h.value=[],q()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function X(){e.toggleModal();try{const n=await fe({name:d.value,unittype:p.value});y.notify({type:"positive",message:"Unidad de medida registrada correctamente",position:"top"}),g.value=[],q()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const q=async()=>{g.value=[],h.value=[],k.value=!0;try{const{unitType:n}=await ye();let s=1,M=1;n.forEach(_=>{_.status=_.status?"Inactivo":"Activo",_.status=="Activo"?(_.id=s++,g.value.push(_)):(_.id=M++,h.value.push(_))}),k.value=!1}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function Y(){try{const n=await ge({id:C.value,name:d.value,unittype:p.value});y.notify({type:"positive",position:"top",message:"Unidad de medida actualizada correctamente"}),e.toggleModal(),g.value=[],q()}catch{y.notify({type:"negative",position:"top",message:"Ocurrió un error"})}d.value="",p.value=""}async function Z(n){try{const s=await he(n);y.notify({type:"positive",message:"Unidad de medida activada correctamente",position:"top"}),g.value=[],h.value=[],q()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return le(()=>{q()}),(n,s)=>{const M=m("q-separator"),_=m("q-tab"),ee=m("q-tabs"),T=m("q-icon"),B=m("q-input"),A=m("q-btn"),R=m("q-btn-group"),j=m("q-table"),F=m("q-tab-panel"),te=m("q-tab-panels"),ae=m("q-card");return x(),ie(ce,null,[c("div",qe,[we,t(M,{class:"separator"}),c("div",Ue,[t(_e,{onOnClick:K,label:"Crear unidad de medida"}),c("div",ke,[t(ae,null,{default:l(()=>[t(ee,{modelValue:r(f),"onUpdate:modelValue":s[0]||(s[0]=a=>b(f)?f.value=a:f=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[t(_,{name:"active",label:"Activos"}),t(_,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),t(M),t(te,{modelValue:r(f),"onUpdate:modelValue":s[3]||(s[3]=a=>b(f)?f.value=a:f=a),animated:""},{default:l(()=>[t(F,{name:"active"},{default:l(()=>[t(j,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:g.value,columns:O.value,filter:r(v),loading:k.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(B,{borderless:"",dense:"",debounce:"300",modelValue:r(v),"onUpdate:modelValue":s[1]||(s[1]=a=>b(v)?v.value=a:v=a),placeholder:"Search"},{append:l(()=>[t(T,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(a=>[c("td",Me,[t(R,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t(A,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:W=>L(a.row)},null,8,["onClick"]),t(A,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:W=>P(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),t(F,{name:"inactive"},{default:l(()=>[t(j,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:h.value,columns:O.value,filter:r(v),loading:k.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(B,{borderless:"",dense:"",debounce:"300",modelValue:r(v),"onUpdate:modelValue":s[2]||(s[2]=a=>b(v)?v.value=a:v=a),placeholder:"Search"},{append:l(()=>[t(T,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(a=>[c("td",xe,[t(R,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t(A,{"text-color":"blue-10",class:"col q-pa-none",onClick:W=>Z(a.row._id)},{default:l(()=>[Ve]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),r(e).modalIsOpen?(x(),E(ve,{key:0},{default:l(()=>[c("h6",De,ue(u.value),1),c("div",Ie,[c("div",Ae,[t($,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:N,value:r(D),modelValue:r(d),"onUpdate:modelValue":s[4]||(s[4]=a=>b(d)?d.value=a:d=a),onOnWrite:H},null,8,["value","modelValue"]),t($,{label:"Tipo de Unidad",required:!0,type:"text",ruless:N,value:r(I),modelValue:r(p),"onUpdate:modelValue":s[5]||(s[5]=a=>b(p)?p.value=a:p=a),onOnWrite:J},null,8,["value","modelValue"]),Ee,c("div",Se,[V.value?(x(),E(Q,{key:0,disable:r(z),onOnClick:X},null,8,["disable"])):(x(),E(Q,{key:1,disable:r(z),onOnClick:Y},null,8,["disable"]))])])])]),_:1})):re("",!0)],64)}}},Oe=ne(Ce,[["__scopeId","data-v-311a6118"]]);export{Oe as default};
