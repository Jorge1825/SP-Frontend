import{g as be,i as ge,p as _e,u as ye,a as qe}from"./index-f67388af.js";import{m as we,M as he,B as Ve,a as Z}from"./ModalForm-cb6eb8ec.js";import{_ as Se,f as o,h as xe,l as Le,m as ze,r,o as C,c as Ie,a as u,d as l,w as n,i as s,g as R,j as ke,F as Ce,q as d,t as Oe,s as h,p as Ae,e as De,v as $}from"./index-a0c708ca.js";const F=z=>(Ae("data-v-ff76c40c"),z=z(),De(),z),Ee={class:"q-py-md table-container"},Me=F(()=>u("h6",{class:"title q-my-lg"},"LOTES",-1)),Ue={class:"container-content"},Ne={class:"container-table q-mt-md q-pa-md",rounded:""},Te={class:"accions-td"},Be={class:"accions-td"},We=F(()=>u("i",{class:"icon icon-check"},null,-1)),Re={class:"q-my-md text-center"},Fe={class:"row q-px-xl"},je={class:"col-12"},Ge=F(()=>u("span",{class:"text-required q-pb-sm"},[$("Todos los campos con "),u("span",{class:"text-red"},"*"),$(" son obligatorios")],-1)),Qe={class:"row justify-center"},He={__name:"Cellars",setup(z){const S=we(),O=o(""),I=o(!1),A=o(!0),w=o([]),x=o([]),j=o(),G=xe(()=>p.value==""),V=[e=>!!e||"Este campo es requerido"];let c=o(""),p=o(""),v=o(""),m=o(""),f=o(""),b=o(""),g=o(""),_=o(""),D=o(""),E=o(""),M=o(""),U=o(""),N=o(""),T=o(""),B=o(""),q=o("active");const y=Le(),Q=o([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"},{name:"farm",label:"Finca",field:"farm",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"},{name:"typecontract",label:"Typo contrato",field:"typecontract",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"},{name:"price",label:"Valor",field:"price",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),ee=e=>{p.value=e},te=e=>{v.value=e},ae=e=>{m.value=e},le=e=>{f.value=e},oe=e=>{b.value=e},se=e=>{g.value=e},ne=e=>{_.value=e},ie=()=>{O.value="REGISTRAR LOTE",D.value="",E.value="",M.value="",U.value="",N.value="",T.value="",B.value="",A.value=!0,S.toggleModal(),p.value="",v.value="",m.value="",f.value="",b.value="",g.value="",_.value=""},ue=e=>{O.value="EDITAR LOTE",A.value=!1,j.value=e._id,D.value=e.name,E=e.areasize,M=e.lotestate,U=e.soildstate,N=e.classlot,T=e.sowingdensity,B=e.description,nameStages.value=e.name,v.value=e.areasize,m.value=e.lotestate,f.value=e.soildstate,b.value=e.classlot,g.value=e.sowingdensity,_.value=e.description,S.toggleModal()};async function re(e){try{const a=await ge(e);y.notify({type:"positive",message:"Lote desactivado correctamente",position:"top"}),w.value=[],x.value=[],L()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function de(){S.toggleModal();try{const e=await _e({name:p.value,areasize:v.value,lotestate:m.value,soildstate:f.value,classlot:b.value,sowingdensity:g.value,description:_.value});y.notify({type:"positive",message:"Lote registrado correctamente",position:"top"}),w.value=[],L()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const L=async()=>{w.value=[],x.value=[],I.value=!0;try{const{lots:e}=await be();let a=1,k=1;e.forEach(i=>{i.status=i.status?"Inactivo":"Activo",i.status=="Activo"?(i.id=a++,w.value.push(i)):(i.id=k++,x.value.push(i)),i.description=i.description.trim()==""?"No registra":i.description}),I.value=!1}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function ce(){try{const e=await ye({id:j.value,name:p.value,areasize:v.value,lotestate:m.value,soildstate:f.value,classlot:b.value,sowingdensity:g.value,description:_.value});y.notify({type:"positive",position:"top",message:"Lote actualizado correctamente"}),S.toggleModal(),w.value=[],L()}catch{y.notify({type:"negative",position:"top",message:"Ocurrió un error"})}p.value="",v.value="",m.value="",f.value="",b.value="",g.value="",_.value=""}async function pe(e){try{const a=await qe(e);y.notify({type:"positive",message:"Lote activado correctamente",position:"top"}),w.value=[],x.value=[],L()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return ze(()=>{L()}),(e,a)=>{const k=r("q-separator"),i=r("q-tab"),ve=r("q-tabs"),H=r("q-icon"),J=r("q-input"),W=r("q-btn"),K=r("q-btn-group"),P=r("q-table"),X=r("q-tab-panel"),me=r("q-tab-panels"),fe=r("q-card");return C(),Ie(Ce,null,[u("div",Ee,[Me,l(k,{class:"separator"}),u("div",Ue,[l(Ve,{onOnClick:ie,label:"Crear nuevo lote"}),u("div",Ne,[l(fe,null,{default:n(()=>[l(ve,{modelValue:s(q),"onUpdate:modelValue":a[0]||(a[0]=t=>d(q)?q.value=t:q=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[l(i,{name:"active",label:"Activos"}),l(i,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(k),l(me,{modelValue:s(q),"onUpdate:modelValue":a[3]||(a[3]=t=>d(q)?q.value=t:q=t),animated:""},{default:n(()=>[l(X,{name:"active"},{default:n(()=>[l(P,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:w.value,columns:Q.value,filter:s(c),loading:I.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[l(J,{borderless:"",dense:"",debounce:"300",modelValue:s(c),"onUpdate:modelValue":a[1]||(a[1]=t=>d(c)?c.value=t:c=t),placeholder:"Search"},{append:n(()=>[l(H,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(t=>[u("td",Te,[l(K,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[l(W,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:Y=>ue(t.row)},null,8,["onClick"]),l(W,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:Y=>re(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(X,{name:"inactive"},{default:n(()=>[l(P,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:x.value,columns:Q.value,filter:s(c),loading:I.value,"rows-per-page-options":[5,10,20]},{"top-right":n(()=>[l(J,{borderless:"",dense:"",debounce:"300",modelValue:s(c),"onUpdate:modelValue":a[2]||(a[2]=t=>d(c)?c.value=t:c=t),placeholder:"Search"},{append:n(()=>[l(H,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":n(t=>[u("td",Be,[l(K,{class:"full-width full-height",outline:"",square:""},{default:n(()=>[l(W,{"text-color":"blue-10",class:"col q-pa-none",onClick:Y=>pe(t.row._id)},{default:n(()=>[We]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),s(S).modalIsOpen?(C(),R(he,{key:0},{default:n(()=>[u("h6",Re,Oe(O.value),1),u("div",Fe,[u("div",je,[l(h,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:V,value:s(D),modelValue:s(p),"onUpdate:modelValue":a[4]||(a[4]=t=>d(p)?p.value=t:p=t),onOnWrite:ee},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Tamaño",type:"text",required:!0,ruless:V,value:s(E),modelValue:s(v),"onUpdate:modelValue":a[5]||(a[5]=t=>d(v)?v.value=t:v=t),onOnWrite:te},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Estado del lote",type:"text",required:!0,ruless:V,value:s(M),modelValue:s(m),"onUpdate:modelValue":a[6]||(a[6]=t=>d(m)?m.value=t:m=t),onOnWrite:ae},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Estado del suelo",type:"text",required:!0,ruless:V,value:s(U),modelValue:s(f),"onUpdate:modelValue":a[7]||(a[7]=t=>d(f)?f.value=t:f=t),onOnWrite:le},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Clase",type:"text",required:!0,ruless:V,value:s(N),modelValue:s(b),"onUpdate:modelValue":a[8]||(a[8]=t=>d(b)?b.value=t:b=t),onOnWrite:oe},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Densidad de siembra",type:"text",required:!0,ruless:V,value:s(T),modelValue:s(g),"onUpdate:modelValue":a[9]||(a[9]=t=>d(g)?g.value=t:g=t),onOnWrite:se},null,8,["value","modelValue"]),l(h,{class:"q-pb-xs",label:"Descripción",type:"text",required:!1,value:s(B),modelValue:s(_),"onUpdate:modelValue":a[10]||(a[10]=t=>d(_)?_.value=t:_=t),onOnWrite:ne},null,8,["value","modelValue"]),Ge,u("div",Qe,[A.value?(C(),R(Z,{key:0,disable:s(G),onOnClick:de},null,8,["disable"])):(C(),R(Z,{key:1,disable:s(G),onOnClick:ce},null,8,["disable"]))])])])]),_:1})):ke("",!0)],64)}}},Xe=Se(He,[["__scopeId","data-v-ff76c40c"]]);export{Xe as default};
