import{l as x,s as T,_ as ne,m as se,f as c,h as le,q as re,v as ie,r as v,o as L,c as ce,a as u,d as e,w as l,i as d,g as E,M as de,j as ue,F as pe,x as w,t as me,y as j,B as W,p as ve,e as fe,z as $}from"./index-9b0f9ebe.js";import{g as S,B as _e}from"./ButtonAdd-1e3a5e63.js";const be=async()=>{try{const n=S(),b=x().idSelected,{data:r}=await T.get("/maintenance/works",{headers:{token:n,farm:b}});return r}catch(n){console.error(n)}},ge=async n=>{try{const t=S(),r=x().idSelected,{data:p}=await T.post("/maintenance/works/register",{name:n.name,description:n.description},{headers:{token:t,farm:r}});return p}catch(t){console.error(t)}},ye=async n=>{try{const t=S(),r=x().idSelected,{data:p}=await T.put(`/maintenance/works/update/${n.id}`,{name:n.name,description:n.description},{headers:{token:t,farm:r}});return p}catch(t){console.error(t)}},he=async n=>{try{const t=S(),r=x().idSelected,{data:p}=await T.put(`/maintenance/works/inactive/${n}`,{},{headers:{token:t,farm:r}});return p}catch(t){console.error(t)}},we=async n=>{try{const t=S(),r=x().idSelected,{data:p}=await T.put(`/maintenance/works/active/${n}`,{},{headers:{token:t,farm:r}});return p}catch(t){console.error(t)}};const C=n=>(ve("data-v-234d1b7e"),n=n(),fe(),n),qe={class:"q-py-md table-container"},ke=C(()=>u("h6",{class:"title q-my-lg"},"TIPOS DE LABOR",-1)),xe={class:"container-content"},Te={class:"container-table q-mt-md q-pa-md",rounded:""},Se={class:"accions-td"},Ve={class:"accions-td"},Le=C(()=>u("i",{class:"icon icon-check"},null,-1)),Ie={class:"q-my-md text-center"},Oe={class:"row q-px-xl"},Ae={class:"col-12"},Ee=C(()=>u("span",{class:"text-required q-pb-sm"},[$("Todos los campos con "),u("span",{class:"text-red"},"*"),$(" son obligatorios")],-1)),Ce={class:"row justify-center"},ze={__name:"TypeLabors",setup(n){const t=se(),b=c(""),r=c(!1),p=c(!0),h=c([]),q=c([]),z=c(),B=le(()=>m.value==""),G=[a=>!!a||"Este campo es requerido"];let f=c(""),m=c(""),_=c(""),I=c(""),O=c(""),y=c("active");const g=re(),D=c([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Q=a=>{m.value=a},H=a=>{_.value=a},J=()=>{b.value="REGISTRAR TIPO DE LABOR",O.value="",I.value="",p.value=!0,t.toggleModal(),m.value="",_.value=""},K=a=>{b.value="EDITAR TIPO DE LABOR",p.value=!1,z.value=a._id,O.value=a.description,I.value=a.name,m.value=a.name,_.value=a.description,t.toggleModal()};async function X(a){try{const s=await he(a);g.notify({type:"positive",message:"Tipo de labor desactivado correctamente",position:"top"}),h.value=[],q.value=[],k()}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function Y(){t.toggleModal();try{const a=await ge({name:m.value,description:_.value});g.notify({type:"positive",message:"Tipo de labor registrado correctamente",position:"top"}),h.value=[],k()}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const k=async()=>{h.value=[],q.value=[],r.value=!0;try{const{works:a}=await be();let s=1,V=1;a.forEach(i=>{i.status=i.status?"Inactivo":"Activo",i.status=="Activo"?(i.id=s++,h.value.push(i)):(i.id=V++,q.value.push(i)),i.description=i.description.trim()==""?"No registra":i.description}),r.value=!1}catch{g.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function Z(){try{const a=await ye({id:z.value,name:m.value,description:_.value});g.notify({type:"positive",position:"top",message:"Tipo de labor actualizado correctamente"}),t.toggleModal(),h.value=[],k()}catch{g.notify({type:"negative",position:"top",message:"Ocurrió un error"})}m.value="",_.value=""}async function ee(a){try{const s=await we(a);g.notify({type:"positive",message:"Tipo de labor activado correctamente",position:"top"}),h.value=[],q.value=[],k()}catch{g.notify({type:"negative",message:"Ocurrió un error"})}}return ie(()=>{k()}),(a,s)=>{const V=v("q-separator"),i=v("q-tab"),te=v("q-tabs"),M=v("q-icon"),N=v("q-input"),A=v("q-btn"),R=v("q-btn-group"),F=v("q-table"),U=v("q-tab-panel"),oe=v("q-tab-panels"),ae=v("q-card");return L(),ce(pe,null,[u("div",qe,[ke,e(V,{class:"separator"}),u("div",xe,[e(_e,{onOnClick:J,label:"Crear tipo de labor"}),u("div",Te,[e(ae,null,{default:l(()=>[e(te,{modelValue:d(y),"onUpdate:modelValue":s[0]||(s[0]=o=>w(y)?y.value=o:y=o),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[e(i,{name:"active",label:"Activos"}),e(i,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(V),e(oe,{modelValue:d(y),"onUpdate:modelValue":s[3]||(s[3]=o=>w(y)?y.value=o:y=o),animated:""},{default:l(()=>[e(U,{name:"active"},{default:l(()=>[e(F,{flat:"",bordered:"",title:"Labores","row-key":"name",rows:h.value,columns:D.value,filter:d(f),loading:r.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(N,{borderless:"",dense:"",debounce:"300",modelValue:d(f),"onUpdate:modelValue":s[1]||(s[1]=o=>w(f)?f.value=o:f=o),placeholder:"Search"},{append:l(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[u("td",Se,[e(R,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(A,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>K(o.row)},null,8,["onClick"]),e(A,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>X(o.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(U,{name:"inactive"},{default:l(()=>[e(F,{flat:"",bordered:"",title:"Pagos","row-key":"name",rows:q.value,columns:D.value,filter:d(f),loading:r.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(N,{borderless:"",dense:"",debounce:"300",modelValue:d(f),"onUpdate:modelValue":s[2]||(s[2]=o=>w(f)?f.value=o:f=o),placeholder:"Search"},{append:l(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[u("td",Ve,[e(R,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(A,{"text-color":"blue-10",class:"col q-pa-none",onClick:P=>ee(o.row._id)},{default:l(()=>[Le]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),d(t).modalIsOpen?(L(),E(de,{key:0},{default:l(()=>[u("h6",Ie,me(b.value),1),u("div",Oe,[u("div",Ae,[e(j,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:G,value:d(I),modelValue:d(m),"onUpdate:modelValue":s[4]||(s[4]=o=>w(m)?m.value=o:m=o),onOnWrite:Q},null,8,["value","modelValue"]),e(j,{label:"Descripción",type:"text",required:!1,value:d(O),modelValue:d(_),"onUpdate:modelValue":s[5]||(s[5]=o=>w(_)?_.value=o:_=o),onOnWrite:H},null,8,["value","modelValue"]),Ee,u("div",Ce,[p.value?(L(),E(W,{key:0,disable:d(B),onOnClick:Y},null,8,["disable"])):(L(),E(W,{key:1,disable:d(B),onOnClick:Z},null,8,["disable"]))])])])]),_:1})):ue("",!0)],64)}}},Me=ne(ze,[["__scopeId","data-v-234d1b7e"]]);export{Me as default};
