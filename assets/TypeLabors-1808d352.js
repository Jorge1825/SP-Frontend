import{x as q,_ as ae,f as i,h as ne,l as se,m as le,r as m,o as V,c as re,a as d,d as t,w as l,i as c,g as S,j as ie,F as ce,q as g,t as de,s as j,p as ue,e as pe,v as F}from"./index-a0c708ca.js";import{g as k,m as ve,M as me,B as _e,a as W}from"./ModalForm-cb6eb8ec.js";const fe=async()=>{try{const n=k(),{data:e}=await q.get("/maintenance/works",{headers:{token:n}});return e}catch(n){console.error(n)}},be=async n=>{try{const e=k(),{data:p}=await q.post("/maintenance/works/register",{name:n.name,description:n.description},{headers:{token:e}});return p}catch(e){console.error(e)}},ye=async n=>{try{const e=k(),{data:p}=await q.put(`/maintenance/works/update/${n.id}`,{name:n.name,description:n.description},{headers:{token:e}});return p}catch(e){console.error(e)}},ge=async n=>{try{const e=k(),{data:p}=await q.put(`/maintenance/works/inactive/${n}`,{},{headers:{token:e}});return p}catch(e){console.error(e)}},he=async n=>{try{const e=k(),{data:p}=await q.put(`/maintenance/works/active/${n}`,{},{headers:{token:e}});return p}catch(e){console.error(e)}};const E=n=>(ue("data-v-2e63deab"),n=n(),pe(),n),we={class:"q-py-md table-container"},qe=E(()=>d("h6",{class:"title q-my-lg"},"TIPOS DE LABOR",-1)),ke={class:"container-content"},xe={class:"container-table q-mt-md q-pa-md",rounded:""},Te={class:"accions-td"},Ve={class:"accions-td"},Le=E(()=>d("i",{class:"icon icon-check"},null,-1)),Ie={class:"q-my-md text-center"},Oe={class:"row q-px-xl"},Ae={class:"col-12"},Se=E(()=>d("span",{class:"text-required q-pb-sm"},[F("Todos los campos con "),d("span",{class:"text-red"},"*"),F(" son obligatorios")],-1)),Ee={class:"row justify-center"},Ce={__name:"TypeLabors",setup(n){const e=ve(),p=i(""),x=i(!1),L=i(!0),y=i([]),h=i([]),C=i(),D=ne(()=>u.value==""),$=[a=>!!a||"Este campo es requerido"];let _=i(""),u=i(""),v=i(""),I=i(""),O=i(""),b=i("active");const f=se(),z=i([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),G=a=>{u.value=a},Q=a=>{v.value=a},H=()=>{p.value="REGISTRAR TIPO DE LABOR",O.value="",I.value="",L.value=!0,e.toggleModal(),u.value="",v.value=""},J=a=>{p.value="EDITAR TIPO DE LABOR",L.value=!1,C.value=a._id,O.value=a.description,I.value=a.name,u.value=a.name,v.value=a.description,e.toggleModal()};async function K(a){try{const s=await ge(a);f.notify({type:"positive",message:"Tipo de labor desactivado correctamente",position:"top"}),y.value=[],h.value=[],w()}catch{f.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function X(){e.toggleModal();try{console.log(u.value,v.value);const a=await be({name:u.value,description:v.value});f.notify({type:"positive",message:"Tipo de labor registrado correctamente",position:"top"}),y.value=[],w()}catch{f.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const w=async()=>{y.value=[],h.value=[],x.value=!0;try{const{works:a}=await fe();let s=1,T=1;a.forEach(r=>{r.status=r.status?"Inactivo":"Activo",r.status=="Activo"?(r.id=s++,y.value.push(r)):(r.id=T++,h.value.push(r)),r.description=r.description.trim()==""?"No registra":r.description}),x.value=!1}catch{f.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function Y(){try{const a=await ye({id:C.value,name:u.value,description:v.value});f.notify({type:"positive",position:"top",message:"Tipo de labor actualizado correctamente"}),e.toggleModal(),y.value=[],w()}catch{f.notify({type:"negative",position:"top",message:"Ocurrió un error"})}u.value="",v.value=""}async function Z(a){try{const s=await he(a);f.notify({type:"positive",message:"Tipo de labor activado correctamente",position:"top"}),y.value=[],h.value=[],w()}catch{f.notify({type:"negative",message:"Ocurrió un error"})}}return le(()=>{w()}),(a,s)=>{const T=m("q-separator"),r=m("q-tab"),ee=m("q-tabs"),B=m("q-icon"),M=m("q-input"),A=m("q-btn"),N=m("q-btn-group"),R=m("q-table"),U=m("q-tab-panel"),te=m("q-tab-panels"),oe=m("q-card");return V(),re(ce,null,[d("div",we,[qe,t(T,{class:"separator"}),d("div",ke,[t(_e,{onOnClick:H,label:"Crear tipo de labor"}),d("div",xe,[t(oe,null,{default:l(()=>[t(ee,{modelValue:c(b),"onUpdate:modelValue":s[0]||(s[0]=o=>g(b)?b.value=o:b=o),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[t(r,{name:"active",label:"Activos"}),t(r,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),t(T),t(te,{modelValue:c(b),"onUpdate:modelValue":s[3]||(s[3]=o=>g(b)?b.value=o:b=o),animated:""},{default:l(()=>[t(U,{name:"active"},{default:l(()=>[t(R,{flat:"",bordered:"",title:"Labores","row-key":"name",rows:y.value,columns:z.value,filter:c(_),loading:x.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(M,{borderless:"",dense:"",debounce:"300",modelValue:c(_),"onUpdate:modelValue":s[1]||(s[1]=o=>g(_)?_.value=o:_=o),placeholder:"Search"},{append:l(()=>[t(B,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[d("td",Te,[t(N,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t(A,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>J(o.row)},null,8,["onClick"]),t(A,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>K(o.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),t(U,{name:"inactive"},{default:l(()=>[t(R,{flat:"",bordered:"",title:"Pagos","row-key":"name",rows:h.value,columns:z.value,filter:c(_),loading:x.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(M,{borderless:"",dense:"",debounce:"300",modelValue:c(_),"onUpdate:modelValue":s[2]||(s[2]=o=>g(_)?_.value=o:_=o),placeholder:"Search"},{append:l(()=>[t(B,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[d("td",Ve,[t(N,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t(A,{"text-color":"blue-10",class:"col q-pa-none",onClick:P=>Z(o.row._id)},{default:l(()=>[Le]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(e).modalIsOpen?(V(),S(me,{key:0},{default:l(()=>[d("h6",Ie,de(p.value),1),d("div",Oe,[d("div",Ae,[t(j,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:$,value:c(I),modelValue:c(u),"onUpdate:modelValue":s[4]||(s[4]=o=>g(u)?u.value=o:u=o),onOnWrite:G},null,8,["value","modelValue"]),t(j,{label:"Descripción",type:"text",required:!1,value:c(O),modelValue:c(v),"onUpdate:modelValue":s[5]||(s[5]=o=>g(v)?v.value=o:v=o),onOnWrite:Q},null,8,["value","modelValue"]),Se,d("div",Ee,[L.value?(V(),S(W,{key:0,disable:c(D),onOnClick:X},null,8,["disable"])):(V(),S(W,{key:1,disable:c(D),onOnClick:Y},null,8,["disable"]))])])])]),_:1})):ie("",!0)],64)}}},Be=ae(Ce,[["__scopeId","data-v-2e63deab"]]);export{Be as default};
