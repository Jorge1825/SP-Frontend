import{l as x,s as S,_ as re,m as ie,f as r,h as ce,q as de,v as ue,r as m,o as O,c as pe,a as u,d as a,w as i,i as c,g as N,M as ve,j as me,F as fe,x as E,t as ge,y as B,B as $,p as _e,e as be,z as H}from"./index-9b0f9ebe.js";import{g as V,B as ye}from"./ButtonAdd-1e3a5e63.js";const he=async()=>{try{const n=V(),b=x().idSelected,{data:d}=await S.get("/maintenance/eps",{headers:{token:n,farm:b}});return d}catch(n){console.error(n)}},qe=async n=>{try{const o=V(),d=x().idSelected,{data:p}=await S.post("/maintenance/eps/register",{name:n.name,description:n.description,observation:n.observation},{headers:{token:o,farm:d}});return p}catch(o){console.error(o)}},Ee=async n=>{try{const o=V(),d=x().idSelected,{data:p}=await S.put(`/maintenance/eps/update/${n.id}`,{name:n.name,description:n.description,observation:n.observation},{headers:{token:o,farm:d}});return p}catch(o){console.error(o)}},we=async n=>{try{const o=V(),d=x().idSelected,{data:p}=await S.put(`/maintenance/eps/inactive/${n}`,{},{headers:{token:o,farm:d}});return p}catch(o){console.error(o)}},ke=async n=>{try{const o=V(),d=x().idSelected,{data:p}=await S.put(`/maintenance/eps/active/${n}`,{},{headers:{token:o,farm:d}});return p}catch(o){console.error(o)}};const D=n=>(_e("data-v-fa719c8d"),n=n(),be(),n),xe={class:"q-py-sm table-container"},Se=D(()=>u("h6",{class:"title q-my-lg"},"EPS",-1)),Ve={class:"container-content"},Ie={class:"container-table q-mt-md q-pa-md",rounded:""},Oe={class:"accions-td"},ze={class:"accions-td"},Ae=D(()=>u("i",{class:"icon icon-check"},null,-1)),Ce={class:"q-my-md text-center"},Me={class:"row q-px-xl"},Ne={class:"col-12"},Be=D(()=>u("span",{class:"text-required q-pb-sm"},[H("Todos los campos con "),u("span",{class:"text-red"},"*"),H(" son obligatorios")],-1)),De={class:"row justify-center"},Fe={__name:"Eps",setup(n){const o=ie(),b=r(""),d=r(!1),p=r(!0),q=r([]),w=r([]),F=r(),U=ce(()=>v.value==""),J=[t=>!!t||"Este campo es requerido"];let f=r(""),v=r(""),g=r(""),_=r(""),z=r(""),A=r(""),C=r(""),h=r("active");const y=de(),P=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"observation",label:"Observación",field:"observation",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),K=t=>{v.value=t},L=t=>{g.value=t},X=t=>{_.value=t},Y=()=>{b.value="REGISTRAR EPS",z.value="",A.value="",C.value="",p.value=!0,o.toggleModal(),v.value="",g.value="",_.value=""},Z=t=>{b.value="EDITAR EPS",p.value=!1,F.value=t._id,z.value=t.name,A.value=t.description,C.value=t.observation,v.value=t.name,g.value=t.description,_.value=t.observation,o.toggleModal()};async function ee(t){try{const s=await we(t);y.notify({type:"positive",message:"Eps desactivada correctamente",position:"top"}),q.value=[],w.value=[],k()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function te(){o.toggleModal();try{const t=await qe({name:v.value,description:g.value,observation:_.value});y.notify({type:"positive",message:"Eps registrada correctamente",position:"top"}),q.value=[],k()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const k=async()=>{q.value=[],w.value=[],d.value=!0;try{const{eps:t}=await he();let s=1,I=1;t.forEach(l=>{l.status=l.status?"Inactivo":"Activo",l.status=="Activo"?(l.id=s++,q.value.push(l)):(l.id=I++,w.value.push(l)),l.description=l.description.trim()==""?"No registra":l.description,l.observation=l.observation.trim()==""?"No registra":l.observation}),d.value=!1}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function ae(){try{const t=await Ee({id:F.value,name:v.value,description:g.value,observation:_.value});y.notify({type:"positive",position:"top",message:"Eps actualizada correctamente"}),o.toggleModal(),q.value=[],k()}catch{y.notify({type:"negative",position:"top",message:"Ocurrió un error"})}v.value="",g.value="",_.value=""}async function oe(t){try{const s=await ke(t);y.notify({type:"positive",message:"Eps activada correctamente",position:"top"}),q.value=[],w.value=[],k()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return ue(()=>{k()}),(t,s)=>{const I=m("q-separator"),l=m("q-tab"),ne=m("q-tabs"),R=m("q-icon"),T=m("q-input"),M=m("q-btn"),j=m("q-btn-group"),W=m("q-table"),G=m("q-tab-panel"),se=m("q-tab-panels"),le=m("q-card");return O(),pe(fe,null,[u("div",xe,[Se,a(I,{class:"separator"}),u("div",Ve,[a(ye,{onOnClick:Y,label:"Crear nueva EPS"}),u("div",Ie,[a(le,null,{default:i(()=>[a(ne,{modelValue:c(h),"onUpdate:modelValue":s[0]||(s[0]=e=>E(h)?h.value=e:h=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[a(l,{name:"active",label:"Activos"}),a(l,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),a(I),a(se,{modelValue:c(h),"onUpdate:modelValue":s[3]||(s[3]=e=>E(h)?h.value=e:h=e),animated:""},{default:i(()=>[a(G,{name:"active"},{default:i(()=>[a(W,{flat:"",bordered:"",title:"EPS","row-key":"name",rows:q.value,columns:P.value,filter:c(f),loading:d.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[a(T,{borderless:"",dense:"",debounce:"300",modelValue:c(f),"onUpdate:modelValue":s[1]||(s[1]=e=>E(f)?f.value=e:f=e),placeholder:"Search"},{append:i(()=>[a(R,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(e=>[u("td",Oe,[a(j,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[a(M,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:Q=>Z(e.row)},null,8,["onClick"]),a(M,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:Q=>ee(e.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),a(G,{name:"inactive"},{default:i(()=>[a(W,{flat:"",bordered:"",title:"EPS","row-key":"name",rows:w.value,columns:P.value,filter:c(f),loading:d.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[a(T,{borderless:"",dense:"",debounce:"300",modelValue:c(f),"onUpdate:modelValue":s[2]||(s[2]=e=>E(f)?f.value=e:f=e),placeholder:"Search"},{append:i(()=>[a(R,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(e=>[u("td",ze,[a(j,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[a(M,{"text-color":"blue-10",class:"col q-pa-none",onClick:Q=>oe(e.row._id)},{default:i(()=>[Ae]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(o).modalIsOpen?(O(),N(ve,{key:0},{default:i(()=>[u("h6",Ce,ge(b.value),1),u("div",Me,[u("div",Ne,[a(B,{label:"Nombre",required:!0,type:"text",ruless:J,value:c(z),modelValue:c(v),"onUpdate:modelValue":s[4]||(s[4]=e=>E(v)?v.value=e:v=e),onOnWrite:K},null,8,["value","modelValue"]),a(B,{class:"q-mb-md",label:"Descripción",type:"text",required:!1,value:c(A),modelValue:c(g),"onUpdate:modelValue":s[5]||(s[5]=e=>E(g)?g.value=e:g=e),onOnWrite:L},null,8,["value","modelValue"]),a(B,{class:"q-pb-xs",label:"Observación",type:"text",required:!1,value:c(C),modelValue:c(_),"onUpdate:modelValue":s[6]||(s[6]=e=>E(_)?_.value=e:_=e),onOnWrite:X},null,8,["value","modelValue"]),Be,u("div",De,[p.value?(O(),N($,{key:0,disable:c(U),onOnClick:te},null,8,["disable"])):(O(),N($,{key:1,disable:c(U),onOnClick:ae},null,8,["disable"]))])])])]),_:1})):me("",!0)],64)}}},Re=re(Fe,[["__scopeId","data-v-fa719c8d"]]);export{Re as default};
