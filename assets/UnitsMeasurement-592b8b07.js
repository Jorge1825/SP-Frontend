import{s as V,_ as ve,l as pe,m as me,g as r,q as fe,f as Q,v as _e,x as ye,r as d,o as x,c as H,a as i,d as e,w as l,h as c,i as z,M as ge,j as J,F as be,y as U,t as he,z as K,B as P,p as qe,e as we,A as X}from"./index-d466a28b.js";import{g as A,B as ke}from"./ButtonAdd-005d7d30.js";const Ue=async s=>{try{const u=A(),{data:t}=await V.get("/maintenance/unittypes",{headers:{token:u,farm:s}});return t}catch(u){return u}},Me=async(s,u)=>{try{const t=A(),{data:v}=await V.post("/maintenance/unittypes/register",{name:s.name,unittype:s.unittype},{headers:{token:t,farm:u}});return v}catch(t){return t}},xe=async(s,u)=>{try{const t=A(),{data:v}=await V.put(`/maintenance/unittypes/update/${s.id}`,{name:s.name,unittype:s.unittype},{headers:{token:t,farm:u}});return v}catch(t){return t}},Ve=async(s,u)=>{try{const t=A(),{data:v}=await V.put(`/maintenance/unittypes/inactive/${s}`,{},{headers:{token:t,farm:u}});return v}catch(t){return t}},Ae=async(s,u)=>{try{const t=A(),{data:v}=await V.put(`/maintenance/unittypes/active/${s}`,{},{headers:{token:t,farm:u}});return v}catch(t){return t}};const N=s=>(qe("data-v-68ac0e79"),s=s(),we(),s),De={class:"q-py-md table-container"},Ie={class:"row"},Ee=N(()=>i("h6",{class:"title q-my-lg"},"UNIDADES DE MEDIDA",-1)),Se={class:"container-content"},Ce={class:"container-table q-mt-md q-pa-md",rounded:""},ze={class:"accions-td"},Ne={class:"accions-td"},Oe=N(()=>i("i",{class:"icon icon-check"},null,-1)),Te={class:"q-my-md text-center"},Be={class:"row q-px-xl"},Re={class:"col-12"},Fe=N(()=>i("span",{class:"text-required q-pb-sm"},[X("Todos los campos con "),i("span",{class:"text-red"},"*"),X(" son obligatorios")],-1)),$e={class:"row justify-center"},je={key:0,class:"spinner"},We={__name:"UnitsMeasurement",setup(s){const u=pe(),t=me(),v=r(""),p=r(!1),I=r(!0),q=r([]),M=r([]),O=r(),Y=fe(),b=r(!1),T=Q(()=>m.value==""||f.value==""?!0:b.value==!0),B=[a=>!!a||"Este campo es requerido"];let _=r(""),h=r("active"),m=r(""),f=r(""),E=r(""),S=r("");const R=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"unittype",label:"Tipo de unidad",field:"unittype",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Z=a=>{m.value=a},ee=a=>{f.value=a},te=()=>{v.value="REGISTRAR UNIDAD DE MEDIDA",ae(),I.value=!0,t.toggleModal()},ae=()=>{S.value="",E.value="",m.value="",f.value=""},ne=a=>{v.value="EDITAR UNIDAD DE MEDIDA",I.value=!1,O.value=a._id,S.value=a.unittype,E.value=a.name,m.value=a.name,f.value=a.unittype,t.toggleModal()},g=(a,o)=>{u.notify({type:a,message:o,position:"top"})},w=async()=>{q.value=[],M.value=[],p.value=!0;try{const{unitType:a}=await Ue(k.value);let o=1,D=1;a.forEach(y=>{y.status=y.status?"Inactivo":"Activo",y.status=="Activo"?(y.id=o++,q.value.push(y)):(y.id=D++,M.value.push(y))}),p.value=!1}catch{p.value=!1,g("negative","Ocurrió un error")}};async function oe(){b.value=!0;try{const a=await Me({name:m.value,unittype:f.value},k.value);b.value=!1,g("positive","Unidad de medidad registrada correctamente"),t.toggleModal(),q.value=[],w()}catch{b.value=!1,g("negative","Ocurrió un error, por favor verifique los datos")}}async function se(){b.value=!0;try{const a=await xe({id:O.value,name:m.value,unittype:f.value},k.value);b.value=!1,g("positive","Unidad de medida actualizada correctamente"),t.toggleModal(),q.value=[],w()}catch{b.value=!1,g("negative","Ocurrió un error, por favor verifique los datos")}m.value="",f.value=""}async function le(a){p.value=!0;try{const o=await Ae(a,k.value);g("positive","Unidad de medida activada correctamente"),p.value=!1,q.value=[],M.value=[],w()}catch{p.value=!1,g("negative","Ocurrió un error")}}async function ie(a){p.value=!1;try{const o=await Ve(a,k.value);p.value=!1,g("positive","Unidad de medida desactivada correctamente"),q.value=[],M.value=[],w()}catch{p.value=!1,g("negative","Ocurrió un error")}}const k=Q(()=>Y.idSelected);return _e(k,()=>{w()}),ye(()=>{w()}),(a,o)=>{const D=d("q-separator"),y=d("q-tab"),re=d("q-tabs"),F=d("q-icon"),$=d("q-input"),C=d("q-btn"),j=d("q-btn-group"),W=d("q-table"),G=d("q-tab-panel"),ue=d("q-tab-panels"),ce=d("q-card"),de=d("q-spinner-ios");return x(),H(be,null,[i("div",De,[i("div",Ie,[i("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=n=>a.$router.back())}),Ee]),e(D,{class:"separator"}),i("div",Se,[e(ke,{onOnClick:te,label:"Crear unidad de medida"}),i("div",Ce,[e(ce,null,{default:l(()=>[e(re,{modelValue:c(h),"onUpdate:modelValue":o[1]||(o[1]=n=>U(h)?h.value=n:h=n),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[e(y,{name:"active",label:"Activos"}),e(y,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(D),e(ue,{modelValue:c(h),"onUpdate:modelValue":o[4]||(o[4]=n=>U(h)?h.value=n:h=n),animated:""},{default:l(()=>[e(G,{name:"active"},{default:l(()=>[e(W,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:q.value,columns:R.value,filter:c(_),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e($,{borderless:"",dense:"",debounce:"300",modelValue:c(_),"onUpdate:modelValue":o[2]||(o[2]=n=>U(_)?_.value=n:_=n),placeholder:"Search"},{append:l(()=>[e(F,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(n=>[i("td",ze,[e(j,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(C,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:L=>ne(n.row)},null,8,["onClick"]),e(C,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:L=>ie(n.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(G,{name:"inactive"},{default:l(()=>[e(W,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:M.value,columns:R.value,filter:c(_),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e($,{borderless:"",dense:"",debounce:"300",modelValue:c(_),"onUpdate:modelValue":o[3]||(o[3]=n=>U(_)?_.value=n:_=n),placeholder:"Search"},{append:l(()=>[e(F,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(n=>[i("td",Ne,[e(j,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(C,{"text-color":"blue-10",class:"col q-pa-none",onClick:L=>le(n.row._id)},{default:l(()=>[Oe]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(t).modalIsOpen?(x(),z(ge,{key:0},{default:l(()=>[i("h6",Te,he(v.value),1),i("div",Be,[i("div",Re,[e(K,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:B,value:c(E),modelValue:c(m),"onUpdate:modelValue":o[5]||(o[5]=n=>U(m)?m.value=n:m=n),onOnWrite:Z},null,8,["value","modelValue"]),e(K,{label:"Tipo de Unidad",required:!0,type:"text",ruless:B,value:c(S),modelValue:c(f),"onUpdate:modelValue":o[6]||(o[6]=n=>U(f)?f.value=n:f=n),onOnWrite:ee},null,8,["value","modelValue"]),Fe,i("div",$e,[I.value?(x(),z(P,{key:0,disable:c(T),onOnClick:oe},null,8,["disable"])):(x(),z(P,{key:1,disable:c(T),onOnClick:se},null,8,["disable"]))]),b.value?(x(),H("div",je,[e(de,{color:"primary",size:"2.5em"})])):J("",!0)])])]),_:1})):J("",!0)],64)}}},Qe=ve(We,[["__scopeId","data-v-68ac0e79"]]);export{Qe as default};
