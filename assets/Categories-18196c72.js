import{_ as ce,q as ue,g as n,v as de,f as j,m as ve,x as pe,y as _e,r as c,o as w,c as Q,a as l,d as e,w as s,h as i,i as z,M as ge,j as W,F as me,H as fe,z as h,t as be,A as H,B as L,p as ye,e as he,C as P,N as qe,O as Ce,P as we,Q as ke}from"./index-8f765b36.js";import{B as Ve}from"./ButtonAdd-2181087a.js";const N=k=>(ye("data-v-8b969833"),k=k(),he(),k),Ie={class:"q-py-md table-container"},xe={class:"row"},Ae=N(()=>l("h6",{class:"title q-my-lg"},"CATEGORIAS",-1)),Se={class:"container-content"},Oe={class:"container-table q-mt-md q-pa-md",rounded:""},ze={class:"accions-td"},Ne={class:"accions-td"},Re=N(()=>l("i",{class:"icon icon-check"},null,-1)),Be={class:"modal-categories"},De={class:"q-my-md text-center"},Ee={class:"row q-px-xl"},Me={class:"col-12"},Te=N(()=>l("span",{class:"text-required q-pb-sm"},[P("Todos los campos con "),l("span",{class:"text-red"},"*"),P(" son obligatorios")],-1)),Ue={class:"row justify-center"},Fe={key:0,class:"spinner"},Ge={__name:"Categories",setup(k){const q=ue(),I=n(""),u=n(!1),x=n(!0),f=n([]),C=n([]),R=n(),g=n(!1),$=de(),B=j(()=>!d.value||!v.value?!0:g.value==!0),J=[a=>!!a||"Este campo es requerido"];let p=n(""),d=n(""),v=n(""),A=n(""),S=n(""),m=n("active");const K=ve(),D=n([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),X=a=>{d.value=a},Y=a=>{v.value=a},Z=()=>{I.value="REGISTRAR CATEGORIAS",A.value="",S.value="",x.value=!0,q.toggleModal(),d.value="",v.value=""},ee=a=>{I.value="EDITAR CATEGORIAS",x.value=!1,R.value=a._id,A.value=a.name,S.value=a.description,d.value=a.name,v.value=a.description,q.toggleModal()},_=(a,o)=>{K.notify({type:a,message:o,position:"top"})},b=async()=>{f.value=[],C.value=[],u.value=!0;try{const{category:a}=await fe(y.value);let o=1,V=1;a.forEach(r=>{r.status=r.status?"Inactivo":"Activo",r.status=="Activo"?(r.id=o++,f.value.push(r)):(r.id=V++,C.value.push(r)),r.description=r.description.trim()==""?"No registra":r.description}),u.value=!1}catch{u.value=!1,_("negative","Ocurrió un error")}};async function ae(){g.value=!0;try{const a=await qe({name:d.value,description:v.value},y.value);g.value=!1,_("positive","Categorias registrada correctamente"),q.toggleModal(),f.value=[],b()}catch{g.value=!1,_("negative","Ocurrió un error")}}async function te(){g.value=!0;try{const a=await Ce({id:R.value,name:d.value,description:v.value},y.value);g.value=!1,_("positive","Categoria actualizada correctamente"),q.toggleModal(),f.value=[],b()}catch{g.value=!1,_("negative","Ocurrió un error")}d.value="",v.value=""}async function oe(a){u.value=!0;try{const o=await we(a,y.value);_("positive","Categoria activada correctamente"),u.value=!1,f.value=[],C.value=[],b()}catch{u.value=!1,_("negative","Ocurrió un error")}}async function le(a){u.value=!0;try{const o=await ke(a,y.value);_("positive","Categoria desactivada correctamente"),u.value=!1,f.value=[],C.value=[],b()}catch{u.value=!1,_("negative","Ocurrió un error")}}const y=j(()=>$.idSelected);return pe(y,()=>{b()}),_e(()=>{b()}),(a,o)=>{const V=c("q-separator"),r=c("q-tab"),se=c("q-tabs"),E=c("q-icon"),M=c("q-input"),O=c("q-btn"),T=c("q-btn-group"),U=c("q-table"),F=c("q-tab-panel"),ne=c("q-tab-panels"),re=c("q-card"),ie=c("q-spinner-ios");return w(),Q(me,null,[l("div",Ie,[l("div",xe,[l("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=t=>a.$router.back())}),Ae]),e(V,{class:"separator"}),l("div",Se,[e(Ve,{onOnClick:Z,label:"Crear nueva categoria"}),l("div",Oe,[e(re,null,{default:s(()=>[e(se,{modelValue:i(m),"onUpdate:modelValue":o[1]||(o[1]=t=>h(m)?m.value=t:m=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:s(()=>[e(r,{name:"active",label:"Activos"}),e(r,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(V),e(ne,{modelValue:i(m),"onUpdate:modelValue":o[4]||(o[4]=t=>h(m)?m.value=t:m=t),animated:""},{default:s(()=>[e(F,{name:"active"},{default:s(()=>[e(U,{flat:"",bordered:"",title:"Categorias","row-key":"name",rows:f.value,columns:D.value,filter:i(p),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":s(()=>[e(M,{borderless:"",dense:"",debounce:"300",modelValue:i(p),"onUpdate:modelValue":o[2]||(o[2]=t=>h(p)?p.value=t:p=t),placeholder:"Search"},{append:s(()=>[e(E,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":s(t=>[l("td",ze,[e(T,{class:"full-width full-height",outline:"",square:""},{default:s(()=>[e(O,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:G=>ee(t.row)},null,8,["onClick"]),e(O,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:G=>le(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(F,{name:"inactive"},{default:s(()=>[e(U,{flat:"",bordered:"",title:"Categorias","row-key":"name",rows:C.value,columns:D.value,filter:i(p),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":s(()=>[e(M,{borderless:"",dense:"",debounce:"300",modelValue:i(p),"onUpdate:modelValue":o[3]||(o[3]=t=>h(p)?p.value=t:p=t),placeholder:"Search"},{append:s(()=>[e(E,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":s(t=>[l("td",Ne,[e(T,{class:"full-width full-height",outline:"",square:""},{default:s(()=>[e(O,{"text-color":"blue-10",class:"col q-pa-none",onClick:G=>oe(t.row._id)},{default:s(()=>[Re]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),i(q).modalIsOpen?(w(),z(ge,{key:0,class:"modal"},{default:s(()=>[l("div",Be,[l("h6",De,be(I.value),1),l("div",Ee,[l("div",Me,[e(H,{label:"Nombre",required:!0,type:"text",ruless:J,value:i(A),modelValue:i(d),"onUpdate:modelValue":o[5]||(o[5]=t=>h(d)?d.value=t:d=t),onOnWrite:X},null,8,["value","modelValue"]),e(H,{class:"q-mb-md",label:"Descripción",type:"text",required:!1,value:i(S),modelValue:i(v),"onUpdate:modelValue":o[6]||(o[6]=t=>h(v)?v.value=t:v=t),onOnWrite:Y},null,8,["value","modelValue"]),Te,l("div",Ue,[x.value?(w(),z(L,{key:0,disable:i(B),onOnClick:ae},null,8,["disable"])):(w(),z(L,{key:1,disable:i(B),onOnClick:te},null,8,["disable"]))]),g.value?(w(),Q("div",Fe,[e(ie,{color:"primary",size:"2.5em"})])):W("",!0)])])])]),_:1})):W("",!0)],64)}}},We=ce(Ge,[["__scopeId","data-v-8b969833"]]);export{We as default};
