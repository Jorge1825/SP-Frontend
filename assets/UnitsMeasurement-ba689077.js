import{l as V,s as A,_ as ve,m as pe,q as me,g as r,v as _e,f as Q,x as fe,y as ye,r as d,o as x,c as H,a as l,d as e,w as i,h as u,i as N,M as be,j as J,F as ge,z as U,t as he,A as K,B as P,p as qe,e as we,C as X}from"./index-8f765b36.js";import{B as ke}from"./ButtonAdd-2181087a.js";const Ue=async s=>{try{const c=V(),{data:t}=await A.get("/maintenance/unittypes",{headers:{token:c,farm:s}});return t}catch(c){return c}},Me=async(s,c)=>{try{const t=V(),{data:v}=await A.post("/maintenance/unittypes/register",{name:s.name,unittype:s.unittype},{headers:{token:t,farm:c}});return v}catch(t){return t}},xe=async(s,c)=>{try{const t=V(),{data:v}=await A.put(`/maintenance/unittypes/update/${s.id}`,{name:s.name,unittype:s.unittype},{headers:{token:t,farm:c}});return v}catch(t){return t}},Ve=async(s,c)=>{try{const t=V(),{data:v}=await A.put(`/maintenance/unittypes/inactive/${s}`,{},{headers:{token:t,farm:c}});return v}catch(t){return t}},Ae=async(s,c)=>{try{const t=V(),{data:v}=await A.put(`/maintenance/unittypes/active/${s}`,{},{headers:{token:t,farm:c}});return v}catch(t){return t}};const z=s=>(qe("data-v-1e3aeb32"),s=s(),we(),s),De={class:"q-py-md table-container"},Ie={class:"row"},Ee=z(()=>l("h6",{class:"title q-my-lg"},"UNIDADES DE MEDIDA",-1)),Se={class:"container-content"},Ce={class:"container-table q-mt-md q-pa-md",rounded:""},Ne={class:"accions-td"},ze={class:"accions-td"},Oe=z(()=>l("i",{class:"icon icon-check"},null,-1)),Te={class:"modal-units"},Be={class:"q-my-md text-center"},Re={class:"row q-px-xl"},Fe={class:"col-12"},$e=z(()=>l("span",{class:"text-required q-pb-sm"},[X("Todos los campos con "),l("span",{class:"text-red"},"*"),X(" son obligatorios")],-1)),je={class:"row justify-center"},We={key:0,class:"spinner"},Ge={__name:"UnitsMeasurement",setup(s){const c=pe(),t=me(),v=r(""),p=r(!1),I=r(!0),q=r([]),M=r([]),O=r(),Y=_e(),g=r(!1),T=Q(()=>m.value==""||_.value==""?!0:g.value==!0),B=[a=>!!a||"Este campo es requerido"];let f=r(""),h=r("active"),m=r(""),_=r(""),E=r(""),S=r("");const R=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"unittype",label:"Tipo de unidad",field:"unittype",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Z=a=>{m.value=a},ee=a=>{_.value=a},te=()=>{v.value="REGISTRAR UNIDAD DE MEDIDA",ae(),I.value=!0,t.toggleModal()},ae=()=>{S.value="",E.value="",m.value="",_.value=""},ne=a=>{v.value="EDITAR UNIDAD DE MEDIDA",I.value=!1,O.value=a._id,S.value=a.unittype,E.value=a.name,m.value=a.name,_.value=a.unittype,t.toggleModal()},b=(a,o)=>{c.notify({type:a,message:o,position:"top"})},w=async()=>{q.value=[],M.value=[],p.value=!0;try{const{unitType:a}=await Ue(k.value);let o=1,D=1;a.forEach(y=>{y.status=y.status?"Inactivo":"Activo",y.status=="Activo"?(y.id=o++,q.value.push(y)):(y.id=D++,M.value.push(y))}),p.value=!1}catch{p.value=!1,b("negative","Ocurrió un error")}};async function oe(){g.value=!0;try{const a=await Me({name:m.value,unittype:_.value},k.value);g.value=!1,b("positive","Unidad de medidad registrada correctamente"),t.toggleModal(),q.value=[],w()}catch{g.value=!1,b("negative","Ocurrió un error, por favor verifique los datos")}}async function se(){g.value=!0;try{const a=await xe({id:O.value,name:m.value,unittype:_.value},k.value);g.value=!1,b("positive","Unidad de medida actualizada correctamente"),t.toggleModal(),q.value=[],w()}catch{g.value=!1,b("negative","Ocurrió un error, por favor verifique los datos")}m.value="",_.value=""}async function le(a){p.value=!0;try{const o=await Ae(a,k.value);b("positive","Unidad de medida activada correctamente"),p.value=!1,q.value=[],M.value=[],w()}catch{p.value=!1,b("negative","Ocurrió un error")}}async function ie(a){p.value=!1;try{const o=await Ve(a,k.value);p.value=!1,b("positive","Unidad de medida desactivada correctamente"),q.value=[],M.value=[],w()}catch{p.value=!1,b("negative","Ocurrió un error")}}const k=Q(()=>Y.idSelected);return fe(k,()=>{w()}),ye(()=>{w()}),(a,o)=>{const D=d("q-separator"),y=d("q-tab"),re=d("q-tabs"),F=d("q-icon"),$=d("q-input"),C=d("q-btn"),j=d("q-btn-group"),W=d("q-table"),G=d("q-tab-panel"),ce=d("q-tab-panels"),ue=d("q-card"),de=d("q-spinner-ios");return x(),H(ge,null,[l("div",De,[l("div",Ie,[l("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=n=>a.$router.back())}),Ee]),e(D,{class:"separator"}),l("div",Se,[e(ke,{onOnClick:te,label:"Crear unidad de medida"}),l("div",Ce,[e(ue,null,{default:i(()=>[e(re,{modelValue:u(h),"onUpdate:modelValue":o[1]||(o[1]=n=>U(h)?h.value=n:h=n),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[e(y,{name:"active",label:"Activos"}),e(y,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(D),e(ce,{modelValue:u(h),"onUpdate:modelValue":o[4]||(o[4]=n=>U(h)?h.value=n:h=n),animated:""},{default:i(()=>[e(G,{name:"active"},{default:i(()=>[e(W,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:q.value,columns:R.value,filter:u(f),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[e($,{borderless:"",dense:"",debounce:"300",modelValue:u(f),"onUpdate:modelValue":o[2]||(o[2]=n=>U(f)?f.value=n:f=n),placeholder:"Search"},{append:i(()=>[e(F,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(n=>[l("td",Ne,[e(j,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[e(C,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:L=>ne(n.row)},null,8,["onClick"]),e(C,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:L=>ie(n.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(G,{name:"inactive"},{default:i(()=>[e(W,{flat:"",bordered:"",title:"Unidades de medida","row-key":"name",rows:M.value,columns:R.value,filter:u(f),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[e($,{borderless:"",dense:"",debounce:"300",modelValue:u(f),"onUpdate:modelValue":o[3]||(o[3]=n=>U(f)?f.value=n:f=n),placeholder:"Search"},{append:i(()=>[e(F,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(n=>[l("td",ze,[e(j,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[e(C,{"text-color":"blue-10",class:"col q-pa-none",onClick:L=>le(n.row._id)},{default:i(()=>[Oe]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),u(t).modalIsOpen?(x(),N(be,{key:0,class:"modal"},{default:i(()=>[l("div",Te,[l("h6",Be,he(v.value),1),l("div",Re,[l("div",Fe,[e(K,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:B,value:u(E),modelValue:u(m),"onUpdate:modelValue":o[5]||(o[5]=n=>U(m)?m.value=n:m=n),onOnWrite:Z},null,8,["value","modelValue"]),e(K,{label:"Tipo de Unidad",required:!0,type:"text",ruless:B,value:u(S),modelValue:u(_),"onUpdate:modelValue":o[6]||(o[6]=n=>U(_)?_.value=n:_=n),onOnWrite:ee},null,8,["value","modelValue"]),$e,l("div",je,[I.value?(x(),N(P,{key:0,disable:u(T),onOnClick:oe},null,8,["disable"])):(x(),N(P,{key:1,disable:u(T),onOnClick:se},null,8,["disable"]))]),g.value?(x(),H("div",We,[e(de,{color:"primary",size:"2.5em"})])):J("",!0)])])])]),_:1})):J("",!0)],64)}}},He=ve(Ge,[["__scopeId","data-v-1e3aeb32"]]);export{He as default};
