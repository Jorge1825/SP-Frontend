import{l as k,s as x,_ as ne,m as se,f as c,h as le,q as re,v as ie,r as g,o as I,c as ce,a as u,d as e,w as l,i as d,g as z,M as de,j as ue,F as pe,x as q,t as ve,y as W,B as $,p as ge,e as me,z as Q}from"./index-9b0f9ebe.js";import{g as S,B as fe}from"./ButtonAdd-1e3a5e63.js";const _e=async()=>{try{const n=S(),_=k().idSelected,{data:r}=await x.get("/inventory/category",{headers:{token:n,farm:_}});return r}catch(n){console.error(n)}},ye=async n=>{try{const t=S(),r=k().idSelected,{data:p}=await x.post("/inventory/category/register",{name:n.name,description:n.description},{headers:{token:t,farm:r}});return p}catch(t){console.error(t)}},be=async n=>{try{const t=S(),r=k().idSelected,{data:p}=await x.put(`/inventory/category/update/${n.id}`,{name:n.name,description:n.description},{headers:{token:t,farm:r}});return p}catch(t){console.error(t)}},he=async n=>{try{const t=S(),r=k().idSelected,{data:p}=await x.put(`/inventory/category/inactive/${n}`,{},{headers:{token:t,farm:r}});return p}catch(t){console.error(t)}},qe=async n=>{try{const t=S(),r=k().idSelected,{data:p}=await x.put(`/inventory/category/active/${n}`,{},{headers:{token:t,farm:r}});return p}catch(t){console.error(t)}};const B=n=>(ge("data-v-c3349d9c"),n=n(),me(),n),Ce={class:"q-py-sm table-container"},we=B(()=>u("h6",{class:"title q-my-lg"},"Categorias",-1)),ke={class:"container-content"},xe={class:"container-table q-mt-md q-pa-md",rounded:""},Se={class:"accions-td"},Ve={class:"accions-td"},Ie=B(()=>u("i",{class:"icon icon-check"},null,-1)),Ae={class:"q-my-md text-center"},Ee={class:"row q-px-xl"},Oe={class:"col-12"},ze=B(()=>u("span",{class:"text-required q-pb-sm"},[Q("Todos los campos con "),u("span",{class:"text-red"},"*"),Q(" son obligatorios")],-1)),Be={class:"row justify-center"},De={__name:"Categories",setup(n){const t=se(),_=c(""),r=c(!1),p=c(!0),h=c([]),C=c([]),D=c(),N=le(()=>v.value==""),H=[a=>!!a||"Este campo es requerido"];let m=c(""),v=c(""),f=c(""),A=c(""),E=c(""),b=c("active");const y=re(),F=c([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),J=a=>{v.value=a},K=a=>{f.value=a},L=()=>{_.value="REGISTRAR CATEGORIAS",A.value="",E.value="",p.value=!0,t.toggleModal(),v.value="",f.value=""},P=a=>{_.value="EDITAR CATEGORIAS",p.value=!1,D.value=a._id,A.value=a.name,E.value=a.description,v.value=a.name,f.value=a.description,t.toggleModal()};async function X(a){try{const s=await he(a);y.notify({type:"positive",message:"Categoria desactivada correctamente",position:"top"}),h.value=[],C.value=[],w()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function Y(){t.toggleModal();try{const a=await ye({name:v.value,description:f.value});y.notify({type:"positive",message:"Categorias registrada correctamente",position:"top"}),h.value=[],w()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const w=async()=>{h.value=[],C.value=[],r.value=!0;try{const{category:a}=await _e();let s=1,V=1;a.forEach(i=>{i.status=i.status?"Inactivo":"Activo",i.status=="Activo"?(i.id=s++,h.value.push(i)):(i.id=V++,C.value.push(i)),i.description=i.description.trim()==""?"No registra":i.description}),r.value=!1}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function Z(){try{const a=await be({id:D.value,name:v.value,description:f.value});y.notify({type:"positive",position:"top",message:"Categoria actualizada correctamente"}),t.toggleModal(),h.value=[],w()}catch{y.notify({type:"negative",position:"top",message:"Ocurrió un error"})}v.value="",f.value=""}async function ee(a){try{const s=await qe(a);y.notify({type:"positive",message:"Categoria activada correctamente",position:"top"}),h.value=[],C.value=[],w()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return ie(()=>{w()}),(a,s)=>{const V=g("q-separator"),i=g("q-tab"),te=g("q-tabs"),M=g("q-icon"),R=g("q-input"),O=g("q-btn"),T=g("q-btn-group"),U=g("q-table"),j=g("q-tab-panel"),oe=g("q-tab-panels"),ae=g("q-card");return I(),ce(pe,null,[u("div",Ce,[we,e(V,{class:"separator"}),u("div",ke,[e(fe,{onOnClick:L,label:"Crear nueva categoria"}),u("div",xe,[e(ae,null,{default:l(()=>[e(te,{modelValue:d(b),"onUpdate:modelValue":s[0]||(s[0]=o=>q(b)?b.value=o:b=o),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[e(i,{name:"active",label:"Activos"}),e(i,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(V),e(oe,{modelValue:d(b),"onUpdate:modelValue":s[3]||(s[3]=o=>q(b)?b.value=o:b=o),animated:""},{default:l(()=>[e(j,{name:"active"},{default:l(()=>[e(U,{flat:"",bordered:"",title:"Categorias","row-key":"name",rows:h.value,columns:F.value,filter:d(m),loading:r.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(R,{borderless:"",dense:"",debounce:"300",modelValue:d(m),"onUpdate:modelValue":s[1]||(s[1]=o=>q(m)?m.value=o:m=o),placeholder:"Search"},{append:l(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[u("td",Se,[e(T,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(O,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:G=>P(o.row)},null,8,["onClick"]),e(O,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:G=>X(o.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(j,{name:"inactive"},{default:l(()=>[e(U,{flat:"",bordered:"",title:"Categorias","row-key":"name",rows:C.value,columns:F.value,filter:d(m),loading:r.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(R,{borderless:"",dense:"",debounce:"300",modelValue:d(m),"onUpdate:modelValue":s[2]||(s[2]=o=>q(m)?m.value=o:m=o),placeholder:"Search"},{append:l(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[u("td",Ve,[e(T,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(O,{"text-color":"blue-10",class:"col q-pa-none",onClick:G=>ee(o.row._id)},{default:l(()=>[Ie]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),d(t).modalIsOpen?(I(),z(de,{key:0},{default:l(()=>[u("h6",Ae,ve(_.value),1),u("div",Ee,[u("div",Oe,[e(W,{label:"Nombre",required:!0,type:"text",ruless:H,value:d(A),modelValue:d(v),"onUpdate:modelValue":s[4]||(s[4]=o=>q(v)?v.value=o:v=o),onOnWrite:J},null,8,["value","modelValue"]),e(W,{class:"q-mb-md",label:"Descripción",type:"text",required:!1,value:d(E),modelValue:d(f),"onUpdate:modelValue":s[5]||(s[5]=o=>q(f)?f.value=o:f=o),onOnWrite:K},null,8,["value","modelValue"]),ze,u("div",Be,[p.value?(I(),z($,{key:0,disable:d(N),onOnClick:Y},null,8,["disable"])):(I(),z($,{key:1,disable:d(N),onOnClick:Z},null,8,["disable"]))])])])]),_:1})):ue("",!0)],64)}}},Me=ne(De,[["__scopeId","data-v-c3349d9c"]]);export{Me as default};
