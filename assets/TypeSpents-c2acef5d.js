import{s as A,_ as pe,l as ve,m as fe,g as i,q as me,f as W,v as _e,x as ge,r as p,o as V,c as L,a as r,d as e,w as l,h as d,i as D,M as ye,j as Q,F as be,y as k,t as he,z as H,B as J,p as qe,e as we,A as K}from"./index-a2b1bd69.js";import{g as T,B as Se}from"./ButtonAdd-ed09f57b.js";const ke=async s=>{T();try{const c=T(),{data:t}=await A.get("/maintenance/spents",{headers:{token:c,farm:s}});return t}catch(c){return c}},Te=async(s,c)=>{try{const t=T(),{data:v}=await A.post("/maintenance/spents/register",{name:s.name,description:s.description},{headers:{token:t,farm:c}});return v}catch(t){return t}},xe=async(s,c)=>{try{const t=T(),{data:v}=await A.put(`/maintenance/spents/update/${s.id}`,{name:s.name,description:s.description},{headers:{token:t,farm:c}});return v}catch(t){return t}},Ve=async(s,c)=>{try{const t=T(),{data:v}=await A.put(`/maintenance/spents/inactive/${s}`,{},{headers:{token:t,farm:c}});return v}catch(t){return t}},Ae=async(s,c)=>{try{const t=T(),{data:v}=await A.put(`/maintenance/spents/active/${s}`,{},{headers:{token:t,farm:c}});return v}catch(t){return t}};const M=s=>(qe("data-v-99f2c7b8"),s=s(),we(),s),Ie={class:"q-py-md table-container"},Oe={class:"row"},Ce=M(()=>r("h6",{class:"title q-my-lg"},"TIPOS DE GASTO",-1)),Ee={class:"container-content"},ze={class:"container-table q-mt-md q-pa-md",rounded:""},De={class:"accions-td"},Me={class:"accions-td"},Ne=M(()=>r("i",{class:"icon icon-check"},null,-1)),Be={class:"q-my-md text-center"},Re={class:"row q-px-xl"},Ge={class:"col-12"},Ue=M(()=>r("span",{class:"text-required q-pb-sm"},[K("Todos los campos con "),r("span",{class:"text-red"},"*"),K(" son obligatorios")],-1)),Fe={class:"row justify-center"},Pe={key:0,class:"spinner"},$e={__name:"TypeSpents",setup(s){const c=ve(),t=fe(),v=i(""),f=i(!1),O=i(!0),q=i([]),x=i([]),N=i(),X=me(),b=i(!1),B=W(()=>m.value==""?!0:b.value==!0),Y=[a=>!!a||"Este campo es requerido"];let _=i(""),h=i("active"),m=i(""),g=i(""),C=i(""),E=i("");const R=i([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Z=a=>{m.value=a},ee=a=>{g.value=a},te=()=>{v.value="REGISTRAR TIPO DE GASTO",ae(),O.value=!0,t.toggleModal()},ae=()=>{E.value="",C.value="",m.value="",g.value=""},oe=a=>{v.value="EDITAR TIPO DE GASTO",O.value=!1,N.value=a._id,E.value=a.description,C.value=a.name,m.value=a.name,g.value=a.description,t.toggleModal()},y=(a,n)=>{c.notify({type:a,message:n,position:"top"})},w=async()=>{q.value=[],x.value=[],f.value=!0;try{const{spents:a}=await ke(S.value);let n=1,I=1;a.forEach(u=>{u.status=u.status?"Inactivo":"Activo",u.status=="Activo"?(u.id=n++,q.value.push(u)):(u.id=I++,x.value.push(u)),u.description=u.description.trim()==""?"No registra":u.description}),f.value=!1}catch{f.value=!1,y("negative","Ocurrió un error")}};async function ne(){b.value=!0;try{const a=await Te({name:m.value,description:g.value},S.value);b.value=!1,y("positive","Tipo de gasto registrado correctamente"),t.toggleModal(),q.value=[],w()}catch{b.value=!1,y("negative","Ocurrió un error, por favor verifique los datos")}}async function se(){b.value=!0;try{const a=await xe({id:N.value,name:m.value,description:g.value},S.value);b.value=!1,y("positive","Tipo de gasto actualizado correctamente"),t.toggleModal(),q.value=[],w()}catch{b.value=!1,y("negative","Ocurrió un error, por favor verifique los datos")}m.value="",g.value=""}async function le(a){f.value=!0;try{const n=await Ae(a,S.value);y("positive","Tipo de gasto activado correctamente"),f.value=!1,q.value=[],x.value=[],w()}catch{f.value=!1,y("negative","Ocurrió un error")}}async function re(a){f.value=!1;try{const n=await Ve(a,S.value);f.value=!1,y("positive","Tipo de gasto desactivado correctamente"),q.value=[],x.value=[],w()}catch{f.value=!1,y("negative","Ocurrió un error")}}const S=W(()=>X.idSelected);return _e(S,()=>{w()}),ge(()=>{w()}),(a,n)=>{const I=p("q-separator"),u=p("q-tab"),ie=p("q-tabs"),G=p("q-icon"),U=p("q-input"),z=p("q-btn"),F=p("q-btn-group"),P=p("q-table"),$=p("q-tab-panel"),ce=p("q-tab-panels"),ue=p("q-card"),de=p("q-spinner-ios");return V(),L(be,null,[r("div",Ie,[r("div",Oe,[r("i",{class:"icon icon-backRoute q-pt-lg",onClick:n[0]||(n[0]=o=>a.$router.back())}),Ce]),e(I,{class:"separator"}),r("div",Ee,[e(Se,{onOnClick:te,label:"Crear tipo de gasto"}),r("div",ze,[e(ue,null,{default:l(()=>[e(ie,{modelValue:d(h),"onUpdate:modelValue":n[1]||(n[1]=o=>k(h)?h.value=o:h=o),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[e(u,{name:"active",label:"Activos"}),e(u,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(I),e(ce,{modelValue:d(h),"onUpdate:modelValue":n[4]||(n[4]=o=>k(h)?h.value=o:h=o),animated:""},{default:l(()=>[e($,{name:"active"},{default:l(()=>[e(P,{flat:"",bordered:"",title:"Gastos","row-key":"name",rows:q.value,columns:R.value,filter:d(_),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(U,{borderless:"",dense:"",debounce:"300",modelValue:d(_),"onUpdate:modelValue":n[2]||(n[2]=o=>k(_)?_.value=o:_=o),placeholder:"Search"},{append:l(()=>[e(G,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[r("td",De,[e(F,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(z,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:j=>oe(o.row)},null,8,["onClick"]),e(z,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:j=>re(o.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e($,{name:"inactive"},{default:l(()=>[e(P,{flat:"",bordered:"",title:"Gastos","row-key":"name",rows:x.value,columns:R.value,filter:d(_),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[e(U,{borderless:"",dense:"",debounce:"300",modelValue:d(_),"onUpdate:modelValue":n[3]||(n[3]=o=>k(_)?_.value=o:_=o),placeholder:"Search"},{append:l(()=>[e(G,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[r("td",Me,[e(F,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[e(z,{"text-color":"blue-10",class:"col q-pa-none",onClick:j=>le(o.row._id)},{default:l(()=>[Ne]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),d(t).modalIsOpen?(V(),D(ye,{key:0},{default:l(()=>[r("h6",Be,he(v.value),1),r("div",Re,[r("div",Ge,[e(H,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:Y,value:d(C),modelValue:d(m),"onUpdate:modelValue":n[5]||(n[5]=o=>k(m)?m.value=o:m=o),onOnWrite:Z},null,8,["value","modelValue"]),e(H,{label:"Descripción",type:"text",required:!1,value:d(E),modelValue:d(g),"onUpdate:modelValue":n[6]||(n[6]=o=>k(g)?g.value=o:g=o),onOnWrite:ee},null,8,["value","modelValue"]),Ue,r("div",Fe,[O.value?(V(),D(J,{key:0,disable:d(B),onOnClick:ne},null,8,["disable"])):(V(),D(J,{key:1,disable:d(B),onOnClick:se},null,8,["disable"]))]),b.value?(V(),L("div",Pe,[e(de,{color:"primary",size:"2.5em"})])):Q("",!0)])])]),_:1})):Q("",!0)],64)}}},Le=pe($e,[["__scopeId","data-v-99f2c7b8"]]);export{Le as default};
