import{l as A,s as I,_ as ve,q as me,g as r,f as pe,m as fe,y as _e,r as u,o as x,c as J,a as c,d as e,w as s,h as i,i as U,M as be,j as K,F as ge,z as q,A as V,t as ye,B as R,C as X,p as he,e as we}from"./index-32fd2e15.js";import{B as qe}from"./ButtonAdd-37f41b44.js";const ke=async()=>{try{const l=A(),{data:n}=await I.get("/maintenance/farm",{headers:{token:l}});return n}catch(l){return l}},Fe=async l=>{try{const n=A(),{data:d}=await I.post("/maintenance/farm/register",{name:l.name,address:l.address,owner:l.owner},{headers:{token:n}});return d}catch(n){return n}},xe=async l=>{try{const n=A(),{data:d}=await I.put(`/maintenance/farm/update/${l.id}`,{name:l.name,address:l.address,owner:l.owner},{headers:{token:n}});return d}catch(n){return n}},Ve=async l=>{try{const n=A(),{data:d}=await I.put(`/maintenance/farm/inactive/${l}`,{},{headers:{token:n}});return d}catch(n){return n}},Ae=async l=>{try{const n=A(),{data:d}=await I.put(`/maintenance/farm/active/${l}`,{},{headers:{token:n}});return d}catch(n){return n}};const D=l=>(he("data-v-555bc476"),l=l(),we(),l),Ie={class:"q-py-md table-container"},Ce={class:"row"},Se=D(()=>c("h6",{class:"title q-my-lg"},"FINCA",-1)),Oe={class:"container-content"},ze={class:"container-table q-mt-md q-pa-md",rounded:""},Ne={class:"accions-td"},Ee={class:"accions-td"},Me=D(()=>c("i",{class:"icon icon-check"},null,-1)),Be={class:"modal-farm"},Ue={class:"q-my-md text-center"},Re={class:"row q-px-xl"},De={class:"col-12"},Te=D(()=>c("span",{class:"text-required q-pb-sm"},[V("Todos los campos con "),c("span",{class:"text-red"},"*"),V(" son obligatorios")],-1)),je={class:"row justify-center"},We={key:0,class:"spinner"},$e={__name:"Farm",setup(l){const n=me(),d=r(""),v=r(!1),S=r(!0),y=r(!1),w=r([]),k=r([]),T=r(),j=pe(()=>m.value==""||p.value==""||f.value==""?!0:y.value==!0),O=[a=>!!a||"Este campo es requerido"];let _=r(""),m=r(""),p=r(""),f=r(""),z=r(""),N=r(""),E=r(""),h=r("active");const Y=fe(),W=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"address",label:"Ubicación",field:"address",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"owner",label:"Propietario",field:"owner",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"center",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Z=a=>{m.value=a},ee=a=>{p.value=a},ae=a=>{f.value=a},te=()=>{d.value="REGISTRAR FINCA",z.value="",N.value="",E.value="",S.value=!0,n.toggleModal(),m.value="",p.value="",f.value=""},oe=a=>{d.value="EDITAR FINCA",S.value=!1,T.value=a._id,z.value=a.name,N.value=a.address,E.value=a.owner,m.value=a.name,p.value=a.address,f.value=a.owner,n.toggleModal()},g=(a,o)=>{Y.notify({type:a,message:o,position:"top"})};async function F(){w.value=[],k.value=[],v.value=!0;try{const{farms:a}=await ke();let o=1,C=1;a.forEach(b=>{b.status=b.status?"Inactivo":"Activo",b.status=="Activo"?(b.id=o++,w.value.push(b)):(b.id=C++,k.value.push(b))}),v.value=!1}catch{v.value=!1,g("negative","Ocurrió un error")}}async function ne(){y.value=!0;try{const a=await Fe({name:m.value,address:p.value,owner:f.value});y.value=!1,n.toggleModal(),g("positive","Finca registrada correctamente"),w.value=[],F()}catch{y.value=!1,g("negative","Ocurrió un error")}}async function le(){y.value=!0;try{const a=await xe({id:T.value,name:m.value,address:p.value,owner:f.value});y.value=!1,g("positive","Finca actualizada correctamente"),n.toggleModal(),w.value=[],F()}catch{y.value=!1,g("negative","Ocurrió un error")}m.value="",p.value="",f.value=""}async function se(a){v.value=!0;try{const o=await Ae(a);v.value=!1,g("positive","Finca activada correctamente"),w.value=[],k.value=[],F()}catch{v.value=!1,g("negative","Ocurrió un error")}}async function re(a){v.value=!0;try{const o=await Ve(a);v.value=!1,g("positive","Finca desactivada correctamente"),w.value=[],k.value=[],F()}catch{v.value=!1,g("negative","Ocurrió un error")}}return _e(()=>{F()}),(a,o)=>{const C=u("q-separator"),b=u("q-tab"),ce=u("q-tabs"),$=u("q-icon"),P=u("q-input"),M=u("q-tooltip"),B=u("q-btn"),G=u("q-btn-group"),L=u("q-table"),Q=u("q-tab-panel"),ie=u("q-tab-panels"),ue=u("q-card"),de=u("q-spinner-ios");return x(),J(ge,null,[c("div",Ie,[c("div",Ce,[c("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=t=>a.$router.back())}),Se]),e(C,{class:"separator"}),c("div",Oe,[e(qe,{onOnClick:te,label:"Crear nueva finca"}),c("div",ze,[e(ue,null,{default:s(()=>[e(ce,{modelValue:i(h),"onUpdate:modelValue":o[1]||(o[1]=t=>q(h)?h.value=t:h=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:s(()=>[e(b,{name:"active",label:"Activos"}),e(b,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(C),e(ie,{modelValue:i(h),"onUpdate:modelValue":o[4]||(o[4]=t=>q(h)?h.value=t:h=t),animated:""},{default:s(()=>[e(Q,{name:"active"},{default:s(()=>[e(L,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:w.value,columns:W.value,filter:i(_),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":s(()=>[e(P,{borderless:"",dense:"",debounce:"300",modelValue:i(_),"onUpdate:modelValue":o[2]||(o[2]=t=>q(_)?_.value=t:_=t),placeholder:"Search"},{append:s(()=>[e($,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":s(t=>[c("td",Ne,[e(G,{class:"full-width full-height",outline:"",square:""},{default:s(()=>[e(B,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:H=>oe(t.row)},{default:s(()=>[e(M,{class:"bg-indigo",offset:[10,10]},{default:s(()=>[V(" Editar ")]),_:1})]),_:2},1032,["onClick"]),e(B,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:H=>re(t.row._id)},{default:s(()=>[e(M,{class:"bg-indigo",offset:[10,10]},{default:s(()=>[V(" Desactivar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(Q,{name:"inactive"},{default:s(()=>[e(L,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:k.value,columns:W.value,filter:i(_),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":s(()=>[e(P,{borderless:"",dense:"",debounce:"300",modelValue:i(_),"onUpdate:modelValue":o[3]||(o[3]=t=>q(_)?_.value=t:_=t),placeholder:"Search"},{append:s(()=>[e($,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":s(t=>[c("td",Ee,[e(G,{class:"full-width full-height",outline:"",square:""},{default:s(()=>[e(B,{"text-color":"blue-10",class:"col q-pa-none",onClick:H=>se(t.row._id)},{default:s(()=>[Me,e(M,{class:"bg-indigo",offset:[10,10]},{default:s(()=>[V(" Activar ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),i(n).modalIsOpen?(x(),U(be,{key:0,class:"modal"},{default:s(()=>[c("div",Be,[c("h6",Ue,ye(d.value),1),c("div",Re,[c("div",De,[e(R,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:O,value:i(z),modelValue:i(m),"onUpdate:modelValue":o[5]||(o[5]=t=>q(m)?m.value=t:m=t),onOnWrite:Z},null,8,["value","modelValue"]),e(R,{class:"q-pb-xs",label:"Ubicación",type:"text",required:!0,ruless:O,value:i(N),modelValue:i(p),"onUpdate:modelValue":o[6]||(o[6]=t=>q(p)?p.value=t:p=t),onOnWrite:ee},null,8,["value","modelValue"]),e(R,{class:"q-pb-xs",label:"Propietario",required:!0,type:"text",ruless:O,value:i(E),modelValue:i(f),"onUpdate:modelValue":o[7]||(o[7]=t=>q(f)?f.value=t:f=t),onOnWrite:ae},null,8,["value","modelValue"]),Te,c("div",je,[S.value?(x(),U(X,{key:0,disable:i(j),onOnClick:ne},null,8,["disable"])):(x(),U(X,{key:1,disable:i(j),onOnClick:le},null,8,["disable"]))]),y.value?(x(),J("div",We,[e(de,{color:"primary",size:"2.5em"})])):K("",!0)])])])]),_:1})):K("",!0)],64)}}},Le=ve($e,[["__scopeId","data-v-555bc476"]]);export{Le as default};
