import{l as S,s as B,_ as ge,q as be,g as r,v as ye,f as P,m as he,x as we,y as qe,r as p,o as I,c as X,a as u,d as l,w as d,h as i,i as R,M as Ce,j as Y,F as ke,z as q,t as Ve,A as z,B as Z,p as xe,e as Ie,C as ee}from"./index-6c614867.js";import{B as Se}from"./ButtonAdd-91711192.js";const Be=async o=>{try{const c=S(),{data:n}=await B.get("/inventory/cellar",{headers:{token:c,farm:o}});return n}catch(c){return c}},Ae=async(o,c)=>{try{const n=S(),{data:s}=await B.post("/inventory/cellar/register",{name:o.name,tpcontract:o.tpcontract,description:o.description,worth:o.worth},{headers:{token:n,farm:c}});return s}catch(n){return n}},Oe=async(o,c)=>{try{const n=S(),{data:s}=await B.put(`/inventory/cellar/update/${o.id}`,{name:o.name,description:o.description,tpcontract:o.tpcontract,worth:o.worth},{headers:{token:n,farm:c}});return s}catch(n){return n}},ze=async(o,c)=>{try{const n=S(),{data:s}=await B.put(`/inventory/cellar/inactive/${o}`,{},{headers:{token:n,farm:c}});return s}catch(n){return n}},De=async(o,c)=>{try{const n=S(),{data:s}=await B.put(`/inventory/cellar/activate/${o}`,{},{headers:{token:n,farm:c}});return s}catch(n){return n}};const F=o=>(xe("data-v-37c22c6d"),o=o(),Ie(),o),Ee={class:"q-py-md table-container"},Ne={class:"row"},Te=F(()=>u("h6",{class:"title q-my-lg"},"BODEGAS",-1)),Ue={class:"container-content"},Me={class:"container-table q-mt-md q-pa-md",rounded:""},Re={class:"accions-td"},Fe={class:"accions-td"},Ge=F(()=>u("i",{class:"icon icon-check"},null,-1)),We={class:"modal-cellars"},je={class:"q-my-md text-center"},$e={class:"row q-px-xl"},Le={class:"col-12"},Qe=F(()=>u("span",{class:"text-required q-pb-sm"},[ee("Todos los campos con "),u("span",{class:"text-red"},"*"),ee(" son obligatorios")],-1)),He={class:"row justify-center"},Je={key:0,class:"spinner"},Ke={__name:"Cellars",setup(o){const c=be(),n=r(""),s=r(!1),D=r(!0),C=r([]),V=r([]),G=r(),te=ye(),h=r(!1),W=P(()=>!f.value||!_.value||!b.value?!0:h.value==!0),A=[e=>!!e||"Este campo es requerido"];let m=r(""),f=r(""),_=r(""),g=r(""),b=r(""),E=r(""),N=r(""),T=r(""),U=r(""),w=r("active");const ae=he(),j=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"tpcontract",label:"Tipo Contrato",field:"tpcontract",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"value",label:"Valor",field:"worth",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),le=e=>{f.value=e},oe=e=>{_.value=e},ne=e=>{g.value=e},se=e=>{b.value=e},re=()=>{n.value="REGISTRAR BODEGAS",E.value="",N.value="",T.value="",U.value="",D.value=!0,c.toggleModal(),f.value="",_.value="",g.value="",b.value=""},ce=e=>{n.value="EDITAR BODEGAS",D.value=!1,G.value=e._id,E.value=e.name,N.value=e.tpcontract,T.value=e.description,U.value=e.worth,f.value=e.name,_.value=e.tpcontract,g.value=e.description,b.value=e.worth,c.toggleModal()},y=(e,a)=>{ae.notify({type:e,message:a,position:"top"})},x=async()=>{C.value=[],V.value=[],s.value=!0;try{const{cellar:e}=await Be(k.value);let a=1,O=1;e.forEach(v=>{v.status=v.status?"Inactivo":"Activo",v.status=="Activo"?(v.id=a++,C.value.push(v)):(v.id=O++,V.value.push(v)),v.description=v.description.trim()==""?"No registra":v.description}),s.value=!1}catch{y("negative","Ocurrió un error")}};async function ie(){h.value=!0;try{const e=await Ae({name:f.value,tpcontract:_.value,description:g.value,worth:b.value},k.value);h.value=!1,s.value=!1,y("positive","Bodega registrada correctamente"),c.toggleModal(),C.value=[],x()}catch{h.value=!1,y("negative","Ocurrió un error")}}async function ue(){h.value=!0;try{const e=await Oe({id:G.value,name:f.value,tpcontract:_.value,description:g.value,worth:b.value},k.value);h.value=!1,y("positive","Bodega actualizada correctamente"),c.toggleModal(),C.value=[],x()}catch{h.value=!1,y("negative","Ocurrió un error")}f.value="",g.value=""}async function de(e){s.value=!0;try{const a=await De(e,k.value);y("positive","Bodega activada correctamente"),s.value=!1,C.value=[],V.value=[],x()}catch{s.value=!1,y("negative","Ocurrió un error")}}async function ve(e){s.value=!0;try{const a=await ze(e,k.value);y("positive","Bodega desactivada correctamente"),s.value=!1,C.value=[],V.value=[],x()}catch{s.value=!1,y("negative","Ocurrió un error")}}const k=P(()=>te.idSelected);return we(k,()=>{getDataUsers()}),qe(()=>{x()}),(e,a)=>{const O=p("q-separator"),v=p("q-tab"),pe=p("q-tabs"),$=p("q-icon"),L=p("q-input"),M=p("q-btn"),Q=p("q-btn-group"),H=p("q-table"),J=p("q-tab-panel"),fe=p("q-tab-panels"),me=p("q-card"),_e=p("q-spinner-ios");return I(),X(ke,null,[u("div",Ee,[u("div",Ne,[u("i",{class:"icon icon-backRoute q-pt-lg",onClick:a[0]||(a[0]=t=>e.$router.back())}),Te]),l(O,{class:"separator"}),u("div",Ue,[l(Se,{onOnClick:re,label:"Crear nueva bodega"}),u("div",Me,[l(me,null,{default:d(()=>[l(pe,{modelValue:i(w),"onUpdate:modelValue":a[1]||(a[1]=t=>q(w)?w.value=t:w=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:d(()=>[l(v,{name:"active",label:"Activos"}),l(v,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(O),l(fe,{modelValue:i(w),"onUpdate:modelValue":a[4]||(a[4]=t=>q(w)?w.value=t:w=t),animated:""},{default:d(()=>[l(J,{name:"active"},{default:d(()=>[l(H,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:C.value,columns:j.value,filter:i(m),loading:s.value,"rows-per-page-options":[5,10,20]},{"top-right":d(()=>[l(L,{borderless:"",dense:"",debounce:"300",modelValue:i(m),"onUpdate:modelValue":a[2]||(a[2]=t=>q(m)?m.value=t:m=t),placeholder:"Search"},{append:d(()=>[l($,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":d(t=>[u("td",Re,[l(Q,{class:"full-width full-height",outline:"",square:""},{default:d(()=>[l(M,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:K=>ce(t.row)},null,8,["onClick"]),l(M,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:K=>ve(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(J,{name:"inactive"},{default:d(()=>[l(H,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:V.value,columns:j.value,filter:i(m),loading:s.value,"rows-per-page-options":[5,10,20]},{"top-right":d(()=>[l(L,{borderless:"",dense:"",debounce:"300",modelValue:i(m),"onUpdate:modelValue":a[3]||(a[3]=t=>q(m)?m.value=t:m=t),placeholder:"Search"},{append:d(()=>[l($,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":d(t=>[u("td",Fe,[l(Q,{class:"full-width full-height",outline:"",square:""},{default:d(()=>[l(M,{"text-color":"blue-10",class:"col q-pa-none",onClick:K=>de(t.row._id)},{default:d(()=>[Ge]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),i(c).modalIsOpen?(I(),R(Ce,{key:0,class:"modal"},{default:d(()=>[u("div",We,[u("h6",je,Ve(n.value),1),u("div",$e,[u("div",Le,[l(z,{label:"Nombre",required:!0,type:"text",ruless:A,value:i(E),modelValue:i(f),"onUpdate:modelValue":a[5]||(a[5]=t=>q(f)?f.value=t:f=t),onOnWrite:le},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Tipo Contrato",required:!0,type:"text",ruless:A,value:i(N),modelValue:i(_),"onUpdate:modelValue":a[6]||(a[6]=t=>q(_)?_.value=t:_=t),onOnWrite:oe},null,8,["value","modelValue"]),l(z,{label:"Descripción",type:"text",required:!0,ruless:A,value:i(T),modelValue:i(g),"onUpdate:modelValue":a[7]||(a[7]=t=>q(g)?g.value=t:g=t),onOnWrite:ne},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Valor",required:!0,type:"number",ruless:A,value:i(U),modelValue:i(b),"onUpdate:modelValue":a[8]||(a[8]=t=>q(b)?b.value=t:b=t),onOnWrite:se},null,8,["value","modelValue"]),Qe,u("div",He,[D.value?(I(),R(Z,{key:0,disable:i(W),onOnClick:ie},null,8,["disable"])):(I(),R(Z,{key:1,disable:i(W),onOnClick:ue},null,8,["disable"]))]),h.value?(I(),X("div",Je,[l(_e,{color:"primary",size:"2.5em"})])):Y("",!0)])])])]),_:1})):Y("",!0)],64)}}},Ye=ge(Ke,[["__scopeId","data-v-37c22c6d"]]);export{Ye as default};
