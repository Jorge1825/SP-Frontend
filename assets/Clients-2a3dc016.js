import{l as N,s as A,_ as he,m as ye,q as qe,g as r,v as Ce,f as Y,x as we,y as ke,r as v,o as I,c as Z,a as c,d as o,w as i,h as u,i as L,M as xe,j as ee,F as Ve,z as k,t as Ee,A as z,B as te,p as Se,e as Ie,C as ae,R as oe}from"./index-3a09a4c6.js";import{B as Ne}from"./ButtonAdd-4b004f79.js";const Ae=async n=>{try{const d=N(),{data:l}=await A.get("/maintenance/client",{headers:{token:d,farm:n}});return l}catch(d){return d}},Oe=async(n,d)=>{try{const l=N(),{data:p}=await A.post("/maintenance/client/register",{name:n.name,phone:n.phone,document:n.document,address:n.address},{headers:{token:l,farm:d}});return p}catch(l){return l}},ze=async(n,d)=>{try{const l=N(),{data:p}=await A.put(`/maintenance/client/update/${n.id}`,{name:n.name,phone:n.phone,document:n.document,address:n.address},{headers:{token:l,farm:d}});return p}catch(l){return l}},De=async(n,d)=>{try{const l=N(),{data:p}=await A.put(`/maintenance/client/inactive/${n}`,{},{headers:{token:l,farm:d}});return p}catch(l){return l}},Me=async(n,d)=>{try{const l=N(),{data:p}=await A.put(`/maintenance/client/active/${n}`,{},{headers:{token:l,farm:d}});return p}catch(l){return l}};const W=n=>(Se("data-v-b7c77c8b"),n=n(),Ie(),n),Te={class:"q-py-sm table-container"},Ue={class:"row"},Be=W(()=>c("h6",{class:"title q-my-lg"},"Clientes",-1)),Re={class:"container-content"},Fe={class:"container-table q-mt-md q-pa-md",rounded:""},Le={class:"accions-td"},We={class:"accions-td"},je=W(()=>c("i",{class:"icon icon-check"},null,-1)),Ge={class:"modal-eps"},Pe={class:"q-my-md text-center"},He={class:"row q-px-xl"},$e={class:"col-12"},Qe=W(()=>c("span",{class:"text-required q-pb-sm"},[ae("Todos los campos con "),c("span",{class:"text-red"},"*"),ae(" son obligatorios")],-1)),Je={class:"row justify-center"},Ke={key:0,class:"spinner"},Xe={__name:"Clients",setup(n){const d=ye(),l=qe(),p=r(""),m=r(!1),D=r(!0),x=r([]),S=r([]),j=r(),le=Ce(),C=r(!1),G=Y(()=>f.value==""||_.value==""||g.value==""||b.value==""?!0:C.value==!0),O=[e=>!!e||"Este campo es requerido"];let y=r(""),w=r("active"),f=r(""),_=r(""),g=r(""),b=r(""),M=r(""),T=r(""),U=r(""),B=r("");const P=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"document",label:"N° Documento",field:"document",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"phone",label:"Teléfono",field:"phone",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"address",label:"Dirección",field:"address",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),ne=e=>{f.value=e},se=e=>{_.value=e},re=e=>{g.value=e},ue=e=>{b.value=e},ce=()=>{p.value="REGISTRAR CLIENTE",ie(),D.value=!0,l.toggleModal()},ie=()=>{M.value="",T.value="",U.value="",B.value="",f.value="",_.value="",g.value="",b.value=""},de=e=>{p.value="EDITAR CLIENTE",D.value=!1,j.value=e._id,M.value=e.name,T.value=e.phone,U.value=e.document,B.value=e.address,f.value=e.name,_.value=e.phone,g.value=e.document,b.value=e.address,l.toggleModal()},h=(e,t)=>{d.notify({type:e,message:t,position:"top"})},V=async()=>{x.value=[],S.value=[],m.value=!0;try{const{client:e}=await Ae(E.value);let t=1,q=1;e.forEach(s=>{s.status=s.status?"Inactivo":"Activo",s.status=="Activo"?(s.id=t++,x.value.push(s)):(s.id=q++,S.value.push(s))}),m.value=!1}catch{m.value=!1,h("negative","Ocurrió un error")}};async function ve(){var e,t,q;C.value=!0;try{const s=await Oe({name:f.value,phone:_.value,document:g.value,address:b.value},E.value);C.value=!1,((q=(t=(e=s==null?void 0:s.response)==null?void 0:e.data)==null?void 0:t.errors[0])==null?void 0:q.msg)==oe.LENGHTDOCUMENT?h("negative","El documento es muy corto"):(h("positive","Cliente registrado correctamente"),l.toggleModal(),x.value=[],V())}catch{C.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}}async function pe(){var e,t,q;C.value=!0;try{const s=await ze({id:j.value,name:f.value,phone:_.value,document:g.value,address:b.value},E.value);C.value=!1,((q=(t=(e=s==null?void 0:s.response)==null?void 0:e.data)==null?void 0:t.errors[0])==null?void 0:q.msg)==oe.LENGHTDOCUMENT?h("negative","El documento es muy corto"):(h("positive","Cliente actualizado correctamente"),l.toggleModal(),x.value=[],V())}catch{C.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}f.value="",_.value="",g.value="",b.value=""}async function me(e){m.value=!0;try{await Me(e,E.value),h("positive","Cliente activado correctamente"),m.value=!1,x.value=[],S.value=[],V()}catch{m.value=!1,h("negative","Ocurrió un error")}}async function fe(e){m.value=!1;try{await De(e,E.value),m.value=!1,h("positive","Cliente desactivado correctamente"),x.value=[],S.value=[],V()}catch{m.value=!1,h("negative","Ocurrió un error")}}const E=Y(()=>le.idSelected);return we(E,()=>{V()}),ke(()=>{V()}),(e,t)=>{const q=v("q-separator"),s=v("q-tab"),R=v("q-tabs"),H=v("q-icon"),$=v("q-input"),F=v("q-btn"),Q=v("q-btn-group"),J=v("q-table"),K=v("q-tab-panel"),_e=v("q-tab-panels"),ge=v("q-card"),be=v("q-spinner-ios");return I(),Z(Ve,null,[c("div",Te,[c("div",Ue,[c("i",{class:"icon icon-backRoute q-pt-lg",onClick:t[0]||(t[0]=a=>e.$router.back())}),Be]),o(q,{class:"separator"}),c("div",Re,[o(Ne,{onOnClick:ce,label:"Crear nuevo cliente"}),c("div",Fe,[o(ge,null,{default:i(()=>[o(R,{modelValue:u(w),"onUpdate:modelValue":t[1]||(t[1]=a=>k(w)?w.value=a:w=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[o(s,{name:"active",label:"Activos"}),o(s,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),o(q),o(_e,{modelValue:u(w),"onUpdate:modelValue":t[4]||(t[4]=a=>k(w)?w.value=a:w=a),animated:""},{default:i(()=>[o(K,{name:"active"},{default:i(()=>[o(J,{flat:"",bordered:"",title:"Clientes","row-key":"name",rows:x.value,columns:P.value,filter:u(y),loading:m.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[o($,{borderless:"",dense:"",debounce:"300",modelValue:u(y),"onUpdate:modelValue":t[2]||(t[2]=a=>k(y)?y.value=a:y=a),placeholder:"Search"},{append:i(()=>[o(H,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(a=>[c("td",Le,[o(Q,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[o(F,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:X=>de(a.row)},null,8,["onClick"]),o(F,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:X=>fe(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),o(K,{name:"inactive"},{default:i(()=>[o(J,{flat:"",bordered:"",title:"Clientes","row-key":"name",rows:S.value,columns:P.value,filter:u(y),loading:m.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[o($,{borderless:"",dense:"",debounce:"300",modelValue:u(y),"onUpdate:modelValue":t[3]||(t[3]=a=>k(y)?y.value=a:y=a),placeholder:"Search"},{append:i(()=>[o(H,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(a=>[c("td",We,[o(Q,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[o(F,{"text-color":"blue-10",class:"col q-pa-none",onClick:X=>me(a.row._id)},{default:i(()=>[je]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),u(l).modalIsOpen?(I(),L(xe,{key:0,class:"modal"},{default:i(()=>[c("div",Ge,[c("h6",Pe,Ee(p.value),1),c("div",He,[c("div",$e,[o(z,{label:"Nombre",required:!0,type:"text",ruless:O,value:u(M),modelValue:u(f),"onUpdate:modelValue":t[5]||(t[5]=a=>k(f)?f.value=a:f=a),onOnWrite:ne},null,8,["value","modelValue"]),o(z,{class:"q-mb-md",required:!0,label:"Teléfono",type:"text",ruless:O,value:u(T),modelValue:u(_),"onUpdate:modelValue":t[6]||(t[6]=a=>k(_)?_.value=a:_=a),onOnWrite:se},null,8,["value","modelValue"]),o(z,{class:"q-pb-xs",label:"N° Documento",required:!0,type:"text",ruless:O,value:u(U),modelValue:u(g),"onUpdate:modelValue":t[7]||(t[7]=a=>k(g)?g.value=a:g=a),onOnWrite:re},null,8,["value","modelValue"]),o(z,{class:"q-pb-xs",label:"Dirección",required:!0,type:"text",ruless:O,value:u(B),modelValue:u(b),"onUpdate:modelValue":t[8]||(t[8]=a=>k(b)?b.value=a:b=a),onOnWrite:ue},null,8,["value","modelValue"]),Qe,c("div",Je,[D.value?(I(),L(te,{key:0,disable:u(G),onOnClick:ve},null,8,["disable"])):(I(),L(te,{key:1,disable:u(G),onOnClick:pe},null,8,["disable"]))]),C.value?(I(),Z("div",Ke,[o(be,{color:"primary",size:"2.5em"})])):ee("",!0)])])])]),_:1})):ee("",!0)],64)}}},et=he(Xe,[["__scopeId","data-v-b7c77c8b"]]);export{et as default};
