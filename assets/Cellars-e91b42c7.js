import{s as S,_ as ge,m as be,g as r,q as ye,f as P,l as he,v as qe,x as we,r as p,o as I,c as X,a as d,d as l,w as u,h as i,i as R,M as Ce,j as Y,F as ke,y as w,t as Ve,z,B as Z,p as xe,e as Ie,A as ee}from"./index-a2b1bd69.js";import{g as A,B as Se}from"./ButtonAdd-ed09f57b.js";const Ae=async o=>{try{const c=A(),{data:n}=await S.get("/inventory/cellar",{headers:{token:c,farm:o}});return n}catch(c){return c}},Be=async(o,c)=>{try{const n=A(),{data:s}=await S.post("/inventory/cellar/register",{name:o.name,tpcontrato:o.tpcontrato,description:o.description,valor:o.valor},{headers:{token:n,farm:c}});return s}catch(n){return n}},ze=async(o,c)=>{try{const n=A(),{data:s}=await S.put(`/inventory/cellar/update/${o.id}`,{name:o.name,description:o.description,tpcontrato:o.typecontract,valor:o.value},{headers:{token:n,farm:c}});return s}catch(n){return n}},Oe=async(o,c)=>{try{const n=A(),{data:s}=await S.put(`/inventory/cellar/inactive/${o}`,{},{headers:{token:n,farm:c}});return s}catch(n){return n}},De=async(o,c)=>{try{const n=A(),{data:s}=await S.put(`/inventory/cellar/activate/${o}`,{},{headers:{token:n,farm:c}});return s}catch(n){return n}};const F=o=>(xe("data-v-08065f8c"),o=o(),Ie(),o),Ee={class:"q-py-md table-container"},Ne={class:"row"},Te=F(()=>d("h6",{class:"title q-my-lg"},"FINCA",-1)),Ue={class:"container-content"},Me={class:"container-table q-mt-md q-pa-md",rounded:""},Re={class:"accions-td"},Fe={class:"accions-td"},We=F(()=>d("i",{class:"icon icon-check"},null,-1)),je={class:"q-my-md text-center"},Ge={class:"row q-px-xl"},$e={class:"col-12"},Le=F(()=>d("span",{class:"text-required q-pb-sm"},[ee("Todos los campos con "),d("span",{class:"text-red"},"*"),ee(" son obligatorios")],-1)),Qe={class:"row justify-center"},He={key:0,class:"spinner"},Je={__name:"Cellars",setup(o){const c=be(),n=r(""),s=r(!1),O=r(!0),C=r([]),V=r([]),W=r(),ae=ye(),h=r(!1),j=P(()=>!f.value||!_.value||!b.value?!0:h.value==!0),D=[e=>!!e||"Este campo es requerido"];let m=r(""),f=r(""),_=r(""),g=r(""),b=r(""),E=r(""),N=r(""),T=r(""),U=r(""),q=r("active");const te=he(),G=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"typecontract",label:"Tipo Contrato",field:"tpcontrato",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"value",label:"Valor",field:"valor",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),le=e=>{f.value=e},oe=e=>{_.value=e},ne=e=>{g.value=e},se=e=>{b.value=e},re=()=>{n.value="REGISTRAR BODEGAS",E.value="",N.value="",T.value="",U.value="",O.value=!0,c.toggleModal(),f.value="",_.value="",g.value="",b.value=""},ce=e=>{n.value="EDITAR BODEGAS",O.value=!1,W.value=e._id,E.value=e.name,N.value=e.tpcontrato,T.value=e.description,U.value=e.valor,f.value=e.name,_.value=e.tpcontrato,g.value=e.description,b.value=e.valor,c.toggleModal()},y=(e,t)=>{te.notify({type:e,message:t,position:"top"})},x=async()=>{C.value=[],V.value=[],s.value=!0;try{const{cellar:e}=await Ae(k.value);let t=1,B=1;e.forEach(v=>{v.status=v.status?"Inactivo":"Activo",v.status=="Activo"?(v.id=t++,C.value.push(v)):(v.id=B++,V.value.push(v)),v.description=v.description.trim()==""?"No registra":v.description}),s.value=!1}catch{y("negative","Ocurrió un error")}};async function ie(){h.value=!0;try{const e=await Be({name:f.value,tpcontrato:_.value,description:g.value,valor:b.value},k.value);h.value=!1,s.value=!1,y("positive","Bodega registrada correctamente"),c.toggleModal(),C.value=[],x()}catch{h.value=!1,y("negative","Ocurrió un error")}}async function ue(){h.value=!0;try{const e=await ze({id:W.value,name:f.value,tpcontrato:_.value,description:g.value,valor:b.value},k.value);h.value=!1,y("positive","Bodega actualizada correctamente"),c.toggleModal(),C.value=[],x()}catch{h.value=!1,y("negative","Ocurrió un error")}f.value="",g.value=""}async function de(e){s.value=!0;try{const t=await De(e,k.value);y("positive","Bodega activada correctamente"),s.value=!1,C.value=[],V.value=[],x()}catch{s.value=!1,y("negative","Ocurrió un error")}}async function ve(e){s.value=!0;try{const t=await Oe(e,k.value);y("positive","Bodega desactivada correctamente"),s.value=!1,C.value=[],V.value=[],x()}catch{s.value=!1,y("negative","Ocurrió un error")}}const k=P(()=>ae.idSelected);return qe(k,()=>{getDataUsers()}),we(()=>{x()}),(e,t)=>{const B=p("q-separator"),v=p("q-tab"),pe=p("q-tabs"),$=p("q-icon"),L=p("q-input"),M=p("q-btn"),Q=p("q-btn-group"),H=p("q-table"),J=p("q-tab-panel"),fe=p("q-tab-panels"),me=p("q-card"),_e=p("q-spinner-ios");return I(),X(ke,null,[d("div",Ee,[d("div",Ne,[d("i",{class:"icon icon-backRoute q-pt-lg",onClick:t[0]||(t[0]=a=>e.$router.back())}),Te]),l(B,{class:"separator"}),d("div",Ue,[l(Se,{onOnClick:re,label:"Crear nueva bodega"}),d("div",Me,[l(me,null,{default:u(()=>[l(pe,{modelValue:i(q),"onUpdate:modelValue":t[1]||(t[1]=a=>w(q)?q.value=a:q=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[l(v,{name:"active",label:"Activos"}),l(v,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(B),l(fe,{modelValue:i(q),"onUpdate:modelValue":t[4]||(t[4]=a=>w(q)?q.value=a:q=a),animated:""},{default:u(()=>[l(J,{name:"active"},{default:u(()=>[l(H,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:C.value,columns:G.value,filter:i(m),loading:s.value,"rows-per-page-options":[5,10,20]},{"top-right":u(()=>[l(L,{borderless:"",dense:"",debounce:"300",modelValue:i(m),"onUpdate:modelValue":t[2]||(t[2]=a=>w(m)?m.value=a:m=a),placeholder:"Search"},{append:u(()=>[l($,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":u(a=>[d("td",Re,[l(Q,{class:"full-width full-height",outline:"",square:""},{default:u(()=>[l(M,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:K=>ce(a.row)},null,8,["onClick"]),l(M,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:K=>ve(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(J,{name:"inactive"},{default:u(()=>[l(H,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:V.value,columns:G.value,filter:i(m),loading:s.value,"rows-per-page-options":[5,10,20]},{"top-right":u(()=>[l(L,{borderless:"",dense:"",debounce:"300",modelValue:i(m),"onUpdate:modelValue":t[3]||(t[3]=a=>w(m)?m.value=a:m=a),placeholder:"Search"},{append:u(()=>[l($,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":u(a=>[d("td",Fe,[l(Q,{class:"full-width full-height",outline:"",square:""},{default:u(()=>[l(M,{"text-color":"blue-10",class:"col q-pa-none",onClick:K=>de(a.row._id)},{default:u(()=>[We]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),i(c).modalIsOpen?(I(),R(Ce,{key:0},{default:u(()=>[d("h6",je,Ve(n.value),1),d("div",Ge,[d("div",$e,[l(z,{label:"Nombre",required:!0,type:"text",ruless:D,value:i(E),modelValue:i(f),"onUpdate:modelValue":t[5]||(t[5]=a=>w(f)?f.value=a:f=a),onOnWrite:le},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Tipo Contrato",required:!0,type:"text",ruless:D,value:i(N),modelValue:i(_),"onUpdate:modelValue":t[6]||(t[6]=a=>w(_)?_.value=a:_=a),onOnWrite:oe},null,8,["value","modelValue"]),l(z,{class:"q-mb-md",label:"Descripción",type:"text",required:!1,value:i(T),modelValue:i(g),"onUpdate:modelValue":t[7]||(t[7]=a=>w(g)?g.value=a:g=a),onOnWrite:ne},null,8,["value","modelValue"]),l(z,{class:"q-pb-xs",label:"Valor",required:!0,type:"text",ruless:D,value:i(U),modelValue:i(b),"onUpdate:modelValue":t[8]||(t[8]=a=>w(b)?b.value=a:b=a),onOnWrite:se},null,8,["value","modelValue"]),Le,d("div",Qe,[O.value?(I(),R(Z,{key:0,disable:i(j),onOnClick:ie},null,8,["disable"])):(I(),R(Z,{key:1,disable:i(j),onOnClick:ue},null,8,["disable"]))]),h.value?(I(),X("div",He,[l(_e,{color:"primary",size:"2.5em"})])):Y("",!0)])])]),_:1})):Y("",!0)],64)}}},Xe=ge(Je,[["__scopeId","data-v-08065f8c"]]);export{Xe as default};
