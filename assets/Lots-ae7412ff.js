import{l as O,s as C,_ as _e,m as we,f as s,h as he,q as qe,v as Se,r as f,o as M,c as Ve,a as d,d as l,w as i,i as n,g as G,M as xe,j as ze,F as Le,x as g,t as ke,y as L,B as te,p as Ie,e as Ee,z as ae}from"./index-9b0f9ebe.js";import{g as A,B as Oe}from"./ButtonAdd-1e3a5e63.js";const Ce=async()=>{try{const a=A(),S=O().idSelected,{data:u}=await C.get("/maintenance/lots",{headers:{token:a,farm:S}});return u}catch(a){console.error(a)}},Ae=async a=>{try{const r=A(),u=O().idSelected,{data:v}=await C.post("/maintenance/lots/register",{name:a.name,areasize:a.areasize,lotestate:a.lotestate,soildstate:a.soildstate,classlote:a.classlote,sowingdensity:a.sowingdensity,description:a.description},{headers:{token:r,farm:u}});return v}catch(r){console.error(r)}},De=async a=>{try{const r=A(),u=O().idSelected,{data:v}=await C.put(`/maintenance/lots/update/${a.id}`,{name:a.name,areasize:a.areasize,lotestate:a.lotestate,soildstate:a.soildstate,classlote:a.classlote,sowingdensity:a.sowingdensity,description:a.description},{headers:{token:r,farm:u}});return v}catch(r){console.error(r)}},Me=async a=>{try{const r=A(),u=O().idSelected,{data:v}=await C.put(`/maintenance/lots/inactive/${a}`,{},{headers:{token:r,farm:u}});return v}catch(r){console.error(r)}},Ue=async a=>{try{const r=A(),u=O().idSelected,{data:v}=await C.put(`/maintenance/lots/active/${a}`,{},{headers:{token:r,farm:u}});return v}catch(r){console.error(r)}};const Q=a=>(Ie("data-v-d780e9ad"),a=a(),Ee(),a),Te={class:"q-py-md table-container"},Be=Q(()=>d("h6",{class:"title q-my-lg"},"LOTES",-1)),Ne={class:"container-content"},Fe={class:"container-table q-mt-md q-pa-md",rounded:""},We={class:"accions-td"},Re={class:"accions-td"},je=Q(()=>d("i",{class:"icon icon-check"},null,-1)),Ge={class:"q-my-md text-center"},Qe={class:"row q-px-xl"},He={class:"col-12"},Je=Q(()=>d("span",{class:"text-required q-pb-sm"},[ae("Todos los campos con "),d("span",{class:"text-red"},"*"),ae(" son obligatorios")],-1)),Ke={class:"row justify-center"},Pe={__name:"Lots",setup(a){const r=we(),S=s(""),u=s(!1),v=s(!0),z=s([]),I=s([]),H=s(),J=he(()=>p.value==""),k=[e=>!!e||"Este campo es requerido"];let m=s(""),p=s(""),y=s(""),b=s(""),_=s(""),w=s(""),h=s(""),q=s(""),U=s(""),T=s(""),B=s(""),N=s(""),F=s(""),W=s(""),R=s(""),x=s("active");const V=qe(),K=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"areasize",label:"Tamaño",field:"areasize",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"lotestate",label:"Estado del lote",field:"lotestate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"soildstate",label:"Estado del suelo",field:"soildstate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"classlot",label:"Clase",field:"classlot",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"sowingdensity",label:"Densidad de siembra",field:"sowingdensity",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),oe=e=>{p.value=e},le=e=>{y.value=e},se=e=>{b.value=e},ne=e=>{_.value=e},re=e=>{w.value=e},ie=e=>{h.value=e},ue=e=>{q.value=e},ce=()=>{S.value="REGISTRAR LOTE",U.value="",T.value="",B.value="",N.value="",F.value="",W.value="",R.value="",v.value=!0,r.toggleModal(),p.value="",y.value="",b.value="",_.value="",w.value="",h.value="",q.value=""},de=e=>{S.value="EDITAR LOTE",v.value=!1,H.value=e._id,U.value=e.name,T.value=e.areasize,B.value=e.lotestate,N.value=e.soildstate,F.value=e.classlot,W.value=e.sowingdensity,R.value=e.description,p.value=e.name,y.value=e.areasize,b.value=e.lotestate,_.value=e.soildstate,w.value=e.classlot,h.value=e.sowingdensity,q.value=e.description,r.toggleModal()};async function ve(e){try{const o=await Me(e);V.notify({type:"positive",message:"Lote desactivado correctamente",position:"top"}),z.value=[],I.value=[],E()}catch{V.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function pe(){r.toggleModal();try{const e=await Ae({name:p.value,areasize:y.value,lotestate:b.value,soildstate:_.value,classlot:w.value,sowingdensity:h.value,description:q.value});V.notify({type:"positive",message:"Lote registrado correctamente",position:"top"}),z.value=[],E()}catch{V.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const E=async()=>{z.value=[],I.value=[],u.value=!0;try{const{lots:e}=await Ce();let o=1,D=1;e.forEach(c=>{c.status=c.status?"Inactivo":"Activo",c.status=="Activo"?(c.id=o++,z.value.push(c)):(c.id=D++,I.value.push(c)),c.description=c.description.trim()==""?"No registra":c.description}),u.value=!1}catch{V.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function fe(){try{const e=await De({id:H.value,name:p.value,areasize:y.value,lotestate:b.value,soildstate:_.value,classlot:w.value,sowingdensity:h.value,description:q.value});V.notify({type:"positive",position:"top",message:"Lote actualizado correctamente"}),r.toggleModal(),z.value=[],E()}catch{V.notify({type:"negative",position:"top",message:"Ocurrió un error"})}p.value="",y.value="",b.value="",_.value="",w.value="",h.value="",q.value=""}async function ge(e){try{const o=await Ue(e);V.notify({type:"positive",message:"Lote activado correctamente",position:"top"}),z.value=[],I.value=[],E()}catch{V.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return Se(()=>{E()}),(e,o)=>{const D=f("q-separator"),c=f("q-tab"),me=f("q-tabs"),P=f("q-icon"),X=f("q-input"),j=f("q-btn"),Y=f("q-btn-group"),Z=f("q-table"),$=f("q-tab-panel"),ye=f("q-tab-panels"),be=f("q-card");return M(),Ve(Le,null,[d("div",Te,[Be,l(D,{class:"separator"}),d("div",Ne,[l(Oe,{onOnClick:ce,label:"Crear nuevo lote"}),d("div",Fe,[l(be,null,{default:i(()=>[l(me,{modelValue:n(x),"onUpdate:modelValue":o[0]||(o[0]=t=>g(x)?x.value=t:x=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[l(c,{name:"active",label:"Activos"}),l(c,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(D),l(ye,{modelValue:n(x),"onUpdate:modelValue":o[3]||(o[3]=t=>g(x)?x.value=t:x=t),animated:""},{default:i(()=>[l($,{name:"active"},{default:i(()=>[l(Z,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:z.value,columns:K.value,filter:n(m),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[l(X,{borderless:"",dense:"",debounce:"300",modelValue:n(m),"onUpdate:modelValue":o[1]||(o[1]=t=>g(m)?m.value=t:m=t),placeholder:"Search"},{append:i(()=>[l(P,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(t=>[d("td",We,[l(Y,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[l(j,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:ee=>de(t.row)},null,8,["onClick"]),l(j,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:ee=>ve(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l($,{name:"inactive"},{default:i(()=>[l(Z,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:I.value,columns:K.value,filter:n(m),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[l(X,{borderless:"",dense:"",debounce:"300",modelValue:n(m),"onUpdate:modelValue":o[2]||(o[2]=t=>g(m)?m.value=t:m=t),placeholder:"Search"},{append:i(()=>[l(P,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(t=>[d("td",Re,[l(Y,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[l(j,{"text-color":"blue-10",class:"col q-pa-none",onClick:ee=>ge(t.row._id)},{default:i(()=>[je]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),n(r).modalIsOpen?(M(),G(xe,{key:0},{default:i(()=>[d("h6",Ge,ke(S.value),1),d("div",Qe,[d("div",He,[l(L,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:k,value:n(U),modelValue:n(p),"onUpdate:modelValue":o[4]||(o[4]=t=>g(p)?p.value=t:p=t),onOnWrite:oe},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Tamaño",type:"number",required:!0,ruless:k,value:n(T),modelValue:n(y),"onUpdate:modelValue":o[5]||(o[5]=t=>g(y)?y.value=t:y=t),onOnWrite:le},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Estado del lote",type:"text",required:!0,ruless:k,value:n(B),modelValue:n(b),"onUpdate:modelValue":o[6]||(o[6]=t=>g(b)?b.value=t:b=t),onOnWrite:se},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Estado del suelo",type:"text",required:!0,ruless:k,value:n(N),modelValue:n(_),"onUpdate:modelValue":o[7]||(o[7]=t=>g(_)?_.value=t:_=t),onOnWrite:ne},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Clase",type:"text",required:!0,ruless:k,value:n(F),modelValue:n(w),"onUpdate:modelValue":o[8]||(o[8]=t=>g(w)?w.value=t:w=t),onOnWrite:re},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Densidad de siembra",type:"number",required:!0,ruless:k,value:n(W),modelValue:n(h),"onUpdate:modelValue":o[9]||(o[9]=t=>g(h)?h.value=t:h=t),onOnWrite:ie},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Descripción",type:"text",required:!1,value:n(R),modelValue:n(q),"onUpdate:modelValue":o[10]||(o[10]=t=>g(q)?q.value=t:q=t),onOnWrite:ue},null,8,["value","modelValue"]),Je,d("div",Ke,[v.value?(M(),G(te,{key:0,disable:n(J),onOnClick:pe},null,8,["disable"])):(M(),G(te,{key:1,disable:n(J),onOnClick:fe},null,8,["disable"]))])])])]),_:1})):ze("",!0)],64)}}},Ze=_e(Pe,[["__scopeId","data-v-d780e9ad"]]);export{Ze as default};
