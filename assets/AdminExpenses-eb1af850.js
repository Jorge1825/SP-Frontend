import{l as I,s as S,_ as fe,m as _e,q as be,g as l,v as ge,f as K,x as he,y as ye,r as d,o as V,c as P,a as r,d as a,w as i,h as c,i as M,M as xe,j as X,F as we,z as q,t as qe,A as B,B as Y,p as Ae,e as ke,C as Z}from"./index-8f765b36.js";import{B as Ee}from"./ButtonAdd-2181087a.js";const Ve=async n=>{try{const u=I(),{data:s}=await S.get("/costs/adminexpenses",{headers:{token:u,farm:n}});return s}catch(u){return u}},Ie=async(n,u)=>{try{const s=I(),{data:v}=await S.post("/costs/adminexpenses/register",{name:n.name,description:n.description,worth:n.worth},{headers:{token:s,farm:u}});return v}catch(s){return s}},Se=async(n,u)=>{try{const s=I(),{data:v}=await S.put(`/costs/adminexpenses/update/${n.id}`,{name:n.name,description:n.description,worth:n.worth},{headers:{token:s,farm:u}});return v}catch(s){return s}},Ce=async(n,u)=>{try{const s=I(),{data:v}=await S.put(`/costs/adminexpenses/inactivate/${n}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}},Oe=async(n,u)=>{try{const s=I(),{data:v}=await S.put(`/costs/adminexpenses/activate/${n}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}};const R=n=>(Ae("data-v-b01de726"),n=n(),ke(),n),ze={class:"q-py-sm table-container"},De={class:"row"},Ne=R(()=>r("h6",{class:"title q-my-lg"},"Gastos Administrativos",-1)),Te={class:"container-content"},Ge={class:"container-table q-mt-md q-pa-md",rounded:""},Me={class:"accions-td"},Be={class:"accions-td"},Re=R(()=>r("i",{class:"icon icon-check"},null,-1)),Ue={class:"modal-admin"},Fe={class:"q-my-md text-center"},We={class:"row q-px-xl"},je={class:"col-12"},$e=R(()=>r("span",{class:"text-required q-pb-sm"},[Z("Todos los campos con "),r("span",{class:"text-red"},"*"),Z(" son obligatorios")],-1)),Le={class:"row justify-center"},Qe={key:0,class:"spinner"},He={__name:"AdminExpenses",setup(n){const u=_e(),s=be(),v=l(""),p=l(!1),O=l(!0),w=l([]),E=l([]),U=l(),ee=ge(),y=l(!1),F=K(()=>m.value==""||_.value==""||f.value==""?!0:y.value==!0),z=[e=>!!e||"Este campo es requerido"];let b=l(""),x=l("active"),m=l(""),f=l(""),_=l(""),D=l(""),N=l(""),T=l("");const W=l([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"worth",label:"Valor",field:"worth",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),te=e=>{m.value=e},ae=e=>{f.value=e},oe=e=>{_.value=e},se=()=>{v.value="REGISTRAR GASTO ADMINISTRATIVO",ne(),O.value=!0,s.toggleModal()},ne=()=>{D.value="",N.value="",T.value="",m.value="",f.value="",_.value=""},le=e=>{v.value="EDITAR GASTO ADMINISTRATIVO",O.value=!1,U.value=e._id,D.value=e.name,N.value=e.description,T.value=e.worth,m.value=e.name,f.value=e.description,_.value=e.worth,s.toggleModal()},h=(e,o)=>{u.notify({type:e,message:o,position:"top"})},A=async()=>{w.value=[],E.value=[],p.value=!0;try{const{adminExpenses:e}=await Ve(k.value);let o=1,C=1;e.forEach(g=>{g.status=g.status?"Inactivo":"Activo",g.status=="Activo"?(g.id=o++,w.value.push(g)):(g.id=C++,E.value.push(g))}),p.value=!1}catch{p.value=!1,h("negative","Ocurrió un error")}};async function re(){y.value=!0;try{const e=await Ie({name:m.value,description:f.value,worth:_.value},k.value);y.value=!1,h("positive","Gasto administrativo registrado correctamente"),s.toggleModal(),w.value=[],A()}catch{y.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}}async function ie(){y.value=!0;try{const e=await Se({id:U.value,name:m.value,description:f.value,worth:_.value},k.value);y.value=!1,h("positive","Gasto administrativo actualizado correctamente"),s.toggleModal(),w.value=[],A()}catch{y.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}m.value="",f.value="",_.value=""}async function ce(e){p.value=!0;try{const o=await Oe(e,k.value);h("positive","Gasto administrativo activado correctamente"),p.value=!1,w.value=[],E.value=[],A()}catch{p.value=!1,h("negative","Ocurrió un error")}}async function ue(e){p.value=!1;try{const o=await Ce(e,k.value);p.value=!1,h("positive","Gasto administrativo desactivado correctamente"),w.value=[],E.value=[],A()}catch{p.value=!1,h("negative","Ocurrió un error")}}const k=K(()=>ee.idSelected);return he(k,()=>{A()}),ye(()=>{A()}),(e,o)=>{const C=d("q-separator"),g=d("q-tab"),de=d("q-tabs"),j=d("q-icon"),$=d("q-input"),G=d("q-btn"),L=d("q-btn-group"),Q=d("q-table"),H=d("q-tab-panel"),ve=d("q-tab-panels"),pe=d("q-card"),me=d("q-spinner-ios");return V(),P(we,null,[r("div",ze,[r("div",De,[r("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=t=>e.$router.back())}),Ne]),a(C,{class:"separator"}),r("div",Te,[a(Ee,{onOnClick:se,label:"Crear nuevo gasto administrativo"}),r("div",Ge,[a(pe,null,{default:i(()=>[a(de,{modelValue:c(x),"onUpdate:modelValue":o[1]||(o[1]=t=>q(x)?x.value=t:x=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[a(g,{name:"active",label:"Activos"}),a(g,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),a(C),a(ve,{modelValue:c(x),"onUpdate:modelValue":o[4]||(o[4]=t=>q(x)?x.value=t:x=t),animated:""},{default:i(()=>[a(H,{name:"active"},{default:i(()=>[a(Q,{flat:"",bordered:"",title:"Gastos Administrativos","row-key":"name",rows:w.value,columns:W.value,filter:c(b),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[a($,{borderless:"",dense:"",debounce:"300",modelValue:c(b),"onUpdate:modelValue":o[2]||(o[2]=t=>q(b)?b.value=t:b=t),placeholder:"Search"},{append:i(()=>[a(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(t=>[r("td",Me,[a(L,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[a(G,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:J=>le(t.row)},null,8,["onClick"]),a(G,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:J=>ue(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),a(H,{name:"inactive"},{default:i(()=>[a(Q,{flat:"",bordered:"",title:"Gastos Administrativos","row-key":"name",rows:E.value,columns:W.value,filter:c(b),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[a($,{borderless:"",dense:"",debounce:"300",modelValue:c(b),"onUpdate:modelValue":o[3]||(o[3]=t=>q(b)?b.value=t:b=t),placeholder:"Search"},{append:i(()=>[a(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(t=>[r("td",Be,[a(L,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[a(G,{"text-color":"blue-10",class:"col q-pa-none",onClick:J=>ce(t.row._id)},{default:i(()=>[Re]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(s).modalIsOpen?(V(),M(xe,{key:0,class:"modal"},{default:i(()=>[r("div",Ue,[r("h6",Fe,qe(v.value),1),r("div",We,[r("div",je,[a(B,{label:"Nombre",required:!0,type:"text",ruless:z,value:c(D),modelValue:c(m),"onUpdate:modelValue":o[5]||(o[5]=t=>q(m)?m.value=t:m=t),onOnWrite:te},null,8,["value","modelValue"]),a(B,{class:"q-mb-md",label:"Descripción",required:!0,type:"text",ruless:z,value:c(N),modelValue:c(f),"onUpdate:modelValue":o[6]||(o[6]=t=>q(f)?f.value=t:f=t),onOnWrite:ae},null,8,["value","modelValue"]),a(B,{class:"q-pb-xs",label:"Valor",required:!0,type:"text",ruless:z,value:c(T),modelValue:c(_),"onUpdate:modelValue":o[7]||(o[7]=t=>q(_)?_.value=t:_=t),onOnWrite:oe},null,8,["value","modelValue"]),$e,r("div",Le,[O.value?(V(),M(Y,{key:0,disable:c(F),onOnClick:re},null,8,["disable"])):(V(),M(Y,{key:1,disable:c(F),onOnClick:ie},null,8,["disable"]))]),y.value?(V(),P("div",Qe,[a(me,{color:"primary",size:"2.5em"})])):X("",!0)])])])]),_:1})):X("",!0)],64)}}},Pe=fe(He,[["__scopeId","data-v-b01de726"]]);export{Pe as default};
