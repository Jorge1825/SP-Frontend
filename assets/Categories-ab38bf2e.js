import{s as C,_ as ae,f as i,h as ne,l as se,m as le,r as v,o as V,c as re,a as d,d as t,w as l,i as c,g as O,j as ie,F as ce,q as b,t as de,v as G,p as ue,e as pe,x as W}from"./index-2558a67d.js";import{g as w,m as ve,M as ge,B as me,a as $}from"./ModalForm-db2ed3e8.js";const fe=async()=>{try{const n=w(),{data:e}=await C.get("/inventory/categories",{headers:{token:n}});return e}catch(n){console.error(n)}},_e=async n=>{try{const e=w(),{data:u}=await C.post("/inventory/categories/register",{name:n.name,description:n.description},{headers:{token:e}});return u}catch(e){console.error(e)}},ye=async n=>{try{const e=w(),{data:u}=await C.put(`/inventory/categories/update/${n.id}`,{name:n.name,description:n.description},{headers:{token:e}});return u}catch(e){console.error(e)}},be=async n=>{try{const e=w(),{data:u}=await C.put(`/inventory/categories/inactive/${n}`,{},{headers:{token:e}});return u}catch(e){console.error(e)}},he=async n=>{try{const e=w(),{data:u}=await C.put(`/inventory/categories/active/${n}`,{},{headers:{token:e}});return u}catch(e){console.error(e)}};const z=n=>(ue("data-v-c519fe2e"),n=n(),pe(),n),qe={class:"q-py-sm table-container"},Ce=z(()=>d("h6",{class:"title q-my-lg"},"Categorias",-1)),we={class:"container-content"},ke={class:"container-table q-mt-md q-pa-md",rounded:""},xe={class:"accions-td"},Ve={class:"accions-td"},Ie=z(()=>d("i",{class:"icon icon-check"},null,-1)),Ae={class:"q-my-md text-center"},Se={class:"row q-px-xl"},Ee={class:"col-12"},Oe=z(()=>d("span",{class:"text-required q-pb-sm"},[W("Todos los campos con "),d("span",{class:"text-red"},"*"),W(" son obligatorios")],-1)),ze={class:"row justify-center"},De={__name:"Categories",setup(n){const e=ve(),u=i(""),k=i(!1),I=i(!0),y=i([]),h=i([]),D=i(),N=ne(()=>p.value==""),Q=[a=>!!a||"Este campo es requerido"];let g=i(""),p=i(""),m=i(""),A=i(""),S=i(""),_=i("active");const f=se(),B=i([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),H=a=>{p.value=a},J=a=>{m.value=a},K=()=>{u.value="REGISTRAR CATEGORIAS",A.value="",S.value="",I.value=!0,e.toggleModal(),p.value="",m.value=""},L=a=>{u.value="EDITAR CATEGORIAS",I.value=!1,D.value=a._id,A.value=a.name,S.value=a.description,p.value=a.name,m.value=a.description,e.toggleModal()};async function P(a){try{const s=await be(a);f.notify({type:"positive",message:"Categoria desactivada correctamente",position:"top"}),y.value=[],h.value=[],q()}catch{f.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function X(){e.toggleModal();try{const a=await _e({name:p.value,description:m.value});f.notify({type:"positive",message:"Categorias registrada correctamente",position:"top"}),y.value=[],q()}catch{f.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const q=async()=>{y.value=[],h.value=[],k.value=!0;try{const{categories:a}=await fe();let s=1,x=1;a.forEach(r=>{r.status=r.status?"Inactivo":"Activo",r.status=="Activo"?(r.id=s++,y.value.push(r)):(r.id=x++,h.value.push(r)),r.description=r.description.trim()==""?"No registra":r.description}),k.value=!1}catch{f.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function Y(){try{const a=await ye({id:D.value,name:p.value,description:m.value});f.notify({type:"positive",position:"top",message:"Categoria actualizada correctamente"}),e.toggleModal(),y.value=[],q()}catch{f.notify({type:"negative",position:"top",message:"Ocurrió un error"})}p.value="",m.value=""}async function Z(a){try{const s=await he(a);f.notify({type:"positive",message:"Categoria activada correctamente",position:"top"}),y.value=[],h.value=[],q()}catch{f.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return le(()=>{q()}),(a,s)=>{const x=v("q-separator"),r=v("q-tab"),ee=v("q-tabs"),M=v("q-icon"),R=v("q-input"),E=v("q-btn"),T=v("q-btn-group"),U=v("q-table"),j=v("q-tab-panel"),te=v("q-tab-panels"),oe=v("q-card");return V(),re(ce,null,[d("div",qe,[Ce,t(x,{class:"separator"}),d("div",we,[t(me,{onOnClick:K,label:"Crear nueva categoria"}),d("div",ke,[t(oe,null,{default:l(()=>[t(ee,{modelValue:c(_),"onUpdate:modelValue":s[0]||(s[0]=o=>b(_)?_.value=o:_=o),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[t(r,{name:"active",label:"Activos"}),t(r,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),t(x),t(te,{modelValue:c(_),"onUpdate:modelValue":s[3]||(s[3]=o=>b(_)?_.value=o:_=o),animated:""},{default:l(()=>[t(j,{name:"active"},{default:l(()=>[t(U,{flat:"",bordered:"",title:"Categorias","row-key":"name",rows:y.value,columns:B.value,filter:c(g),loading:k.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(R,{borderless:"",dense:"",debounce:"300",modelValue:c(g),"onUpdate:modelValue":s[1]||(s[1]=o=>b(g)?g.value=o:g=o),placeholder:"Search"},{append:l(()=>[t(M,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[d("td",xe,[t(T,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t(E,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:F=>L(o.row)},null,8,["onClick"]),t(E,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:F=>P(o.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),t(j,{name:"inactive"},{default:l(()=>[t(U,{flat:"",bordered:"",title:"Categorias","row-key":"name",rows:h.value,columns:B.value,filter:c(g),loading:k.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(R,{borderless:"",dense:"",debounce:"300",modelValue:c(g),"onUpdate:modelValue":s[2]||(s[2]=o=>b(g)?g.value=o:g=o),placeholder:"Search"},{append:l(()=>[t(M,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(o=>[d("td",Ve,[t(T,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t(E,{"text-color":"blue-10",class:"col q-pa-none",onClick:F=>Z(o.row._id)},{default:l(()=>[Ie]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(e).modalIsOpen?(V(),O(ge,{key:0},{default:l(()=>[d("h6",Ae,de(u.value),1),d("div",Se,[d("div",Ee,[t(G,{label:"Nombre",required:!0,type:"text",ruless:Q,value:c(A),modelValue:c(p),"onUpdate:modelValue":s[4]||(s[4]=o=>b(p)?p.value=o:p=o),onOnWrite:H},null,8,["value","modelValue"]),t(G,{class:"q-mb-md",label:"Descripción",type:"text",required:!1,value:c(S),modelValue:c(m),"onUpdate:modelValue":s[5]||(s[5]=o=>b(m)?m.value=o:m=o),onOnWrite:J},null,8,["value","modelValue"]),Oe,d("div",ze,[I.value?(V(),O($,{key:0,disable:c(N),onOnClick:X},null,8,["disable"])):(V(),O($,{key:1,disable:c(N),onOnClick:Y},null,8,["disable"]))])])])]),_:1})):ie("",!0)],64)}}},Me=ae(De,[["__scopeId","data-v-c519fe2e"]]);export{Me as default};
