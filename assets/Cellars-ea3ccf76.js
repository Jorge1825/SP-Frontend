import{s as k,_ as pe,f as s,h as ve,l as fe,m as me,r as v,o as O,c as ge,a as u,d as a,w as i,i as r,g as F,j as ye,F as _e,q as h,t as be,v as x,p as he,e as qe,x as X}from"./index-2558a67d.js";import{g as I,m as we,M as Ce,B as Ve,a as Y}from"./ModalForm-db2ed3e8.js";const xe=async()=>{try{const o=I(),{data:n}=await k.get("/inventory/cellars",{headers:{token:o}});return n}catch(o){console.error(o)}},ke=async o=>{try{const n=I(),{data:d}=await k.post("/inventory/cellars/register",{name:o.name,farm:o.farm,typecontract:o.typecontract,description:o.description,value:o.value},{headers:{token:n}});return d}catch(n){console.error(n)}},Ie=async o=>{try{const n=I(),{data:d}=await k.put(`/inventory/cellars/update/${o.id}`,{name:o.name,farm:o.farm,typecontract:o.typecontract,description:o.description,value:o.value},{headers:{token:n}});return d}catch(n){console.error(n)}},Se=async o=>{try{const n=I(),{data:d}=await k.put(`/inventory/cellars/inactive/${o}`,{},{headers:{token:n}});return d}catch(n){console.error(n)}},ze=async o=>{try{const n=I(),{data:d}=await k.put(`/inventory/cellars/active/${o}`,{},{headers:{token:n}});return d}catch(n){console.error(n)}};const R=o=>(he("data-v-26a30142"),o=o(),qe(),o),Be={class:"q-py-sm table-container"},Oe=R(()=>u("h6",{class:"title q-my-lg"},"Bodegas",-1)),Ae={class:"container-content"},Ee={class:"container-table q-mt-md q-pa-md",rounded:""},De={class:"accions-td"},Ne={class:"accions-td"},Te=R(()=>u("i",{class:"icon icon-check"},null,-1)),Ue={class:"q-my-md text-center"},Me={class:"row q-px-xl"},Fe={class:"col-12"},Re=R(()=>u("span",{class:"text-required q-pb-sm"},[X("Todos los campos con "),u("span",{class:"text-red"},"*"),X(" son obligatorios")],-1)),We={class:"row justify-center"},je={__name:"Cellars",setup(o){const n=we(),d=s(""),S=s(!1),A=s(!0),w=s([]),C=s([]),W=s(),j=ve(()=>p.value==""),z=[e=>!!e||"Este campo es requerido"];let f=s(""),p=s(""),m=s(""),y=s(""),g=s(""),_=s(""),E=s(""),D=s(""),N=s(""),T=s(""),U=s(""),q=s("active");const b=fe(),G=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"farm",label:"Finca",field:"farm",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"typecontract",label:"Tipo Contrato",field:"typecontract",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"value",label:"Valor",field:"value",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Z=e=>{p.value=e},$=e=>{m.value=e},ee=e=>{y.value=e},te=e=>{g.value=e},ae=e=>{_.value=e},oe=()=>{d.value="REGISTRAR BODEGAS",E.value="",D.value="",N.value="",T.value="",U.value="",A.value=!0,n.toggleModal(),p.value="",m.value="",y.value="",g.value="",_.value=""},le=e=>{d.value="EDITAR BODEGAS",A.value=!1,W.value=e._id,E.value=e.name,D.value=e.farm,N.value=e.typecontract,T.value=e.description,U.value=e.value,p.value=e.name,m.value=e.farm,y.value=e.typecontract,g.value=e.description,_.value=e.value,n.toggleModal()};async function ne(e){try{const l=await Se(e);b.notify({type:"positive",message:"Bodega desactivada correctamente",position:"top"}),w.value=[],C.value=[],V()}catch{b.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function se(){n.toggleModal();try{const e=await ke({name:p.value,farm:m.value,typecontract:y.value,description:g.value,value:_.value});b.notify({type:"positive",message:"Bodega registrada correctamente",position:"top"}),w.value=[],V()}catch{b.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const V=async()=>{w.value=[],C.value=[],S.value=!0;try{const{cellars:e}=await xe();let l=1,B=1;e.forEach(c=>{c.status=c.status?"Inactivo":"Activo",c.status=="Activo"?(c.id=l++,w.value.push(c)):(c.id=B++,C.value.push(c)),c.description=c.description.trim()==""?"No registra":c.description}),S.value=!1}catch{b.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function re(){try{const e=await Ie({id:W.value,name:p.value,farm:m.value,typecontract:y.value,description:g.value,value:_.value});b.notify({type:"positive",position:"top",message:"Bodega actualizada correctamente"}),n.toggleModal(),w.value=[],V()}catch{b.notify({type:"negative",position:"top",message:"Ocurrió un error"})}p.value="",g.value="",m.value=""}async function ie(e){try{const l=await ze(e);b.notify({type:"positive",message:"Bodega activada correctamente",position:"top"}),w.value=[],C.value=[],V()}catch{b.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return me(()=>{V()}),(e,l)=>{const B=v("q-separator"),c=v("q-tab"),ce=v("q-tabs"),Q=v("q-icon"),H=v("q-input"),M=v("q-btn"),J=v("q-btn-group"),K=v("q-table"),L=v("q-tab-panel"),ue=v("q-tab-panels"),de=v("q-card");return O(),ge(_e,null,[u("div",Be,[Oe,a(B,{class:"separator"}),u("div",Ae,[a(Ve,{onOnClick:oe,label:"Crear nueva bodega"}),u("div",Ee,[a(de,null,{default:i(()=>[a(ce,{modelValue:r(q),"onUpdate:modelValue":l[0]||(l[0]=t=>h(q)?q.value=t:q=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[a(c,{name:"active",label:"Activos"}),a(c,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),a(B),a(ue,{modelValue:r(q),"onUpdate:modelValue":l[3]||(l[3]=t=>h(q)?q.value=t:q=t),animated:""},{default:i(()=>[a(L,{name:"active"},{default:i(()=>[a(K,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:w.value,columns:G.value,filter:r(f),loading:S.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[a(H,{borderless:"",dense:"",debounce:"300",modelValue:r(f),"onUpdate:modelValue":l[1]||(l[1]=t=>h(f)?f.value=t:f=t),placeholder:"Search"},{append:i(()=>[a(Q,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(t=>[u("td",De,[a(J,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[a(M,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>le(t.row)},null,8,["onClick"]),a(M,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>ne(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),a(L,{name:"inactive"},{default:i(()=>[a(K,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:C.value,columns:G.value,filter:r(f),loading:S.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[a(H,{borderless:"",dense:"",debounce:"300",modelValue:r(f),"onUpdate:modelValue":l[2]||(l[2]=t=>h(f)?f.value=t:f=t),placeholder:"Search"},{append:i(()=>[a(Q,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(t=>[u("td",Ne,[a(J,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[a(M,{"text-color":"blue-10",class:"col q-pa-none",onClick:P=>ie(t.row._id)},{default:i(()=>[Te]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),r(n).modalIsOpen?(O(),F(Ce,{key:0},{default:i(()=>[u("h6",Ue,be(d.value),1),u("div",Me,[u("div",Fe,[a(x,{label:"Nombre",required:!0,type:"text",ruless:z,value:r(E),modelValue:r(p),"onUpdate:modelValue":l[4]||(l[4]=t=>h(p)?p.value=t:p=t),onOnWrite:Z},null,8,["value","modelValue"]),a(x,{class:"q-pb-xs",label:"Finca",required:!0,type:"text",ruless:z,value:r(D),modelValue:r(m),"onUpdate:modelValue":l[5]||(l[5]=t=>h(m)?m.value=t:m=t),onOnWrite:$},null,8,["value","modelValue"]),a(x,{class:"q-pb-xs",label:"Tipo Contrato",required:!0,type:"text",ruless:z,value:r(N),modelValue:r(y),"onUpdate:modelValue":l[6]||(l[6]=t=>h(y)?y.value=t:y=t),onOnWrite:ee},null,8,["value","modelValue"]),a(x,{class:"q-mb-md",label:"Descripción",type:"text",required:!1,value:r(T),modelValue:r(g),"onUpdate:modelValue":l[7]||(l[7]=t=>h(g)?g.value=t:g=t),onOnWrite:te},null,8,["value","modelValue"]),a(x,{class:"q-pb-xs",label:"Valor",required:!0,type:"text",ruless:z,value:r(U),modelValue:r(_),"onUpdate:modelValue":l[8]||(l[8]=t=>h(_)?_.value=t:_=t),onOnWrite:ae},null,8,["value","modelValue"]),Re,u("div",We,[A.value?(O(),F(Y,{key:0,disable:r(j),onOnClick:se},null,8,["disable"])):(O(),F(Y,{key:1,disable:r(j),onOnClick:re},null,8,["disable"]))])])])]),_:1})):ye("",!0)],64)}}},He=pe(je,[["__scopeId","data-v-26a30142"]]);export{He as default};
