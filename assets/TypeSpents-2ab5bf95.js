import{l as k,s as T,_ as ne,m as se,f as c,h as le,q as re,v as ie,r as v,o as I,c as ce,a as u,d as e,w as r,i as d,g as C,M as de,j as ue,F as pe,x as S,t as me,y as j,B as W,p as ve,e as fe,z as $}from"./index-9b0f9ebe.js";import{g as x,B as _e}from"./ButtonAdd-1e3a5e63.js";const ge=async()=>{const s=x(),g=k().idSelected;try{const{data:l}=await T.get("/maintenance/spents",{headers:{token:s,farm:g}});return l}catch(l){console.error(l)}},ye=async s=>{try{const t=x(),l=k().idSelected,{data:p}=await T.post("/maintenance/spents/register",{name:s.name,description:s.description},{headers:{token:t,farm:l}});return p}catch(t){console.error(t)}},be=async s=>{try{const t=x(),l=k().idSelected,{data:p}=await T.put(`/maintenance/spents/update/${s.id}`,{name:s.name,description:s.description},{headers:{token:t,farm:l}});return p}catch(t){console.error(t)}},he=async s=>{try{const t=x(),l=k().idSelected,{data:p}=await T.put(`/maintenance/spents/inactive/${s}`,{},{headers:{token:t,farm:l}});return p}catch(t){console.error(t)}},Se=async s=>{try{const t=x(),l=k().idSelected,{data:p}=await T.put(`/maintenance/spents/active/${s}`,{},{headers:{token:t,farm:l}});return p}catch(t){console.error(t)}};const z=s=>(ve("data-v-b4634ebe"),s=s(),fe(),s),qe={class:"q-py-md table-container"},we=z(()=>u("h6",{class:"title q-my-lg"},"TIPOS DE GASTOS",-1)),ke={class:"container-content"},Te={class:"container-table q-mt-md q-pa-md",rounded:""},xe={class:"accions-td"},Ve={class:"accions-td"},Ie=z(()=>u("i",{class:"icon icon-check"},null,-1)),Oe={class:"q-my-md text-center"},Ae={class:"row q-px-xl"},Ee={class:"col-12"},Ce=z(()=>u("span",{class:"text-required q-pb-sm"},[$("Todos los campos con "),u("span",{class:"text-red"},"*"),$(" son obligatorios")],-1)),ze={class:"row justify-center"},De={__name:"TypeSpents",setup(s){const t=se(),g=c(""),l=c(!1),p=c(!0),h=c([]),q=c([]),D=c(),M=le(()=>m.value==""),Q=[o=>!!o||"Este campo es requerido"];let f=c(""),m=c(""),_=c(""),O=c(""),A=c(""),b=c("active");const y=re(),B=c([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),H=o=>{m.value=o},J=o=>{_.value=o},K=()=>{g.value="REGISTRAR TIPO DE GASTO",A.value="",O.value="",p.value=!0,t.toggleModal(),m.value="",_.value=""},L=o=>{g.value="EDITAR TIPO DE GASTO",p.value=!1,D.value=o._id,A.value=o.description,O.value=o.name,m.value=o.name,_.value=o.description,t.toggleModal()};async function X(o){try{const n=await he(o);y.notify({type:"positive",message:"Tipo de gasto desactivado correctamente",position:"top"}),h.value=[],q.value=[],w()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function Y(){t.toggleModal();try{const o=await ye({name:m.value,description:_.value});y.notify({type:"positive",message:"Tipo de gasto registrado correctamente",position:"top"}),h.value=[],w()}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const w=async()=>{h.value=[],q.value=[],l.value=!0;try{const{spents:o}=await ge();let n=1,V=1;o.forEach(i=>{i.status=i.status?"Inactivo":"Activo",i.status=="Activo"?(i.id=n++,h.value.push(i)):(i.id=V++,q.value.push(i)),i.description=i.description.trim()==""?"No registra":i.description}),l.value=!1}catch{y.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function Z(){try{const o=await be({id:D.value,name:m.value,description:_.value});y.notify({type:"positive",position:"top",message:"Tipo de gasto actualizado correctamente"}),t.toggleModal(),h.value=[],w()}catch{y.notify({type:"negative",position:"top",message:"Ocurrió un error"})}m.value="",_.value=""}async function ee(o){try{const n=await Se(o);y.notify({type:"positive",message:"Tipo de gasto activado correctamente",position:"top"}),h.value=[],q.value=[],w()}catch{y.notify({type:"negative",message:"Ocurrió un error"})}}return ie(()=>{w()}),(o,n)=>{const V=v("q-separator"),i=v("q-tab"),te=v("q-tabs"),N=v("q-icon"),F=v("q-input"),E=v("q-btn"),G=v("q-btn-group"),R=v("q-table"),U=v("q-tab-panel"),ae=v("q-tab-panels"),oe=v("q-card");return I(),ce(pe,null,[u("div",qe,[we,e(V,{class:"separator"}),u("div",ke,[e(_e,{onOnClick:K,label:"Crear tipo de gasto"}),u("div",Te,[e(oe,null,{default:r(()=>[e(te,{modelValue:d(b),"onUpdate:modelValue":n[0]||(n[0]=a=>S(b)?b.value=a:b=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[e(i,{name:"active",label:"Activos"}),e(i,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(V),e(ae,{modelValue:d(b),"onUpdate:modelValue":n[3]||(n[3]=a=>S(b)?b.value=a:b=a),animated:""},{default:r(()=>[e(U,{name:"active"},{default:r(()=>[e(R,{flat:"",bordered:"",title:"Gastos","row-key":"name",rows:h.value,columns:B.value,filter:d(f),loading:l.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[e(F,{borderless:"",dense:"",debounce:"300",modelValue:d(f),"onUpdate:modelValue":n[1]||(n[1]=a=>S(f)?f.value=a:f=a),placeholder:"Search"},{append:r(()=>[e(N,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(a=>[u("td",xe,[e(G,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[e(E,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>L(a.row)},null,8,["onClick"]),e(E,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>X(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e(U,{name:"inactive"},{default:r(()=>[e(R,{flat:"",bordered:"",title:"Gastos","row-key":"name",rows:q.value,columns:B.value,filter:d(f),loading:l.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[e(F,{borderless:"",dense:"",debounce:"300",modelValue:d(f),"onUpdate:modelValue":n[2]||(n[2]=a=>S(f)?f.value=a:f=a),placeholder:"Search"},{append:r(()=>[e(N,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(a=>[u("td",Ve,[e(G,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[e(E,{"text-color":"blue-10",class:"col q-pa-none",onClick:P=>ee(a.row._id)},{default:r(()=>[Ie]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),d(t).modalIsOpen?(I(),C(de,{key:0},{default:r(()=>[u("h6",Oe,me(g.value),1),u("div",Ae,[u("div",Ee,[e(j,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:Q,value:d(O),modelValue:d(m),"onUpdate:modelValue":n[4]||(n[4]=a=>S(m)?m.value=a:m=a),onOnWrite:H},null,8,["value","modelValue"]),e(j,{label:"Descripción",type:"text",required:!1,value:d(A),modelValue:d(_),"onUpdate:modelValue":n[5]||(n[5]=a=>S(_)?_.value=a:_=a),onOnWrite:J},null,8,["value","modelValue"]),Ce,u("div",ze,[p.value?(I(),C(W,{key:0,disable:d(M),onOnClick:Y},null,8,["disable"])):(I(),C(W,{key:1,disable:d(M),onOnClick:Z},null,8,["disable"]))])])])]),_:1})):ue("",!0)],64)}}},Ne=ne(De,[["__scopeId","data-v-b4634ebe"]]);export{Ne as default};
