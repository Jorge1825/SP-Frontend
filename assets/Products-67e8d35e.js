import{l as P,s as S,_ as ie,m as de,f as s,h as pe,q as ve,v as me,r as v,o as z,c as ge,a as i,d as a,w as c,i as r,g as N,M as fe,j as _e,F as ye,x as w,t as be,y as A,B as L,p as he,e as qe,z as X}from"./index-9b0f9ebe.js";import{g as C,B as we}from"./ButtonAdd-1e3a5e63.js";const ke=async()=>{try{const o=C(),b=P().idSelected,{data:u}=await S.get("/inventory/product",{headers:{token:o,farm:b}});return u}catch(o){console.error(o)}},xe=async o=>{try{const n=C(),u=P().idSelected,{data:d}=await S.post("/inventory/product/register",{name:o.name,category:o.category,brand:o.brand,amount:o.amount,description:o.description},{headers:{token:n,farm:u}});return d}catch(n){console.error(n)}},Ve=async o=>{try{const n=C(),u=P().idSelected,{data:d}=await S.put(`/inventory/product/update/${o.id}`,{name:o.name,category:o.category,brand:o.brand,amount:o.amount,description:o.description},{headers:{token:n,farm:u}});return d}catch(n){console.error(n)}},Pe=async o=>{try{const n=C(),u=P().idSelected,{data:d}=await S.put(`/inventory/product/inactive/${o}`,{},{headers:{token:n,farm:u}});return d}catch(n){console.error(n)}},Se=async o=>{try{const n=C(),u=P().idSelected,{data:d}=await S.put(`/inventory/product/active/${o}`,{},{headers:{token:n,farm:u}});return d}catch(n){console.error(n)}};const R=o=>(he("data-v-b0c242e0"),o=o(),qe(),o),Ce={class:"q-py-sm table-container"},Ie=R(()=>i("h6",{class:"title q-my-lg"},"Productos",-1)),Oe={class:"container-content"},ze={class:"container-table q-mt-md q-pa-md",rounded:""},Ae={class:"accions-td"},Be={class:"accions-td"},Ee=R(()=>i("i",{class:"icon icon-check"},null,-1)),Me={class:"q-my-md text-center"},Ue={class:"row q-px-xl"},Fe={class:"col-12"},Ne=R(()=>i("span",{class:"text-required q-pb-sm"},[X("Todos los campos con "),i("span",{class:"text-red"},"*"),X(" son obligatorios")],-1)),Re={class:"row justify-center"},De={__name:"Products",setup(o){const n=de(),b=s(""),u=s(!1),d=s(!0),k=s([]),x=s([]),D=s(),T=pe(()=>p.value==""),I=[e=>!!e||"Este campo es requerido"];let m=s(""),p=s(""),g=s(""),f=s(""),_=s(""),B=s(""),E=s(""),M=s(""),U=s(""),q=s("active");const h=ve(),W=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"category",label:"Categoria",field:"category",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"mark",label:"Marca",field:"mark",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"amount",label:"Cantidad",field:"amount",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Y=e=>{p.value=e},Z=e=>{g.value=e},$=e=>{f.value=e},ee=e=>{_.value=e},te=()=>{b.value="REGISTRAR PRODUCTOS",B.value="",E.value="",M.value="",U.value="",d.value=!0,n.toggleModal(),p.value="",g.value="",f.value="",_.value=""},oe=e=>{b.value="EDITAR PRODUCTOS",d.value=!1,D.value=e._id,B.value=e.name,E.value=e.categories,M.value=e.brand,U.value=e.amount,p.value=e.name,g.value=e.categories,f.value=e.brand,_.value=e.amount,n.toggleModal()};async function ae(e){try{const l=await Pe(e);h.notify({type:"positive",message:"Producto desactivado correctamente",position:"top"}),k.value=[],x.value=[],V()}catch{h.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function ne(){n.toggleModal();try{const e=await xe({name:p.value,categories:g.value,brand:f.value,amount:_.value});h.notify({type:"positive",message:"Producto registrado correctamente",position:"top"}),k.value=[],V()}catch{h.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const V=async()=>{k.value=[],x.value=[],u.value=!0;try{const{products:e}=await ke();let l=1,O=1;e.forEach(y=>{y.status=y.status?"Inactivo":"Activo",y.status=="Activo"?(y.id=l++,k.value.push(y)):(y.id=O++,x.value.push(y))}),u.value=!1}catch{h.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function le(){try{const e=await Ve({id:D.value,name:p.value,categories:g.value,brand:f.value,amount:_.value});h.notify({type:"positive",position:"top",message:"Producto actualizado correctamente"}),n.toggleModal(),k.value=[],V()}catch{h.notify({type:"negative",position:"top",message:"Ocurrió un error"})}p.value="",f.value="",g.value="",_.value=""}async function se(e){try{const l=await Se(e);h.notify({type:"positive",message:"Producto activado correctamente",position:"top"}),k.value=[],x.value=[],V()}catch{h.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return me(()=>{V()}),(e,l)=>{const O=v("q-separator"),y=v("q-tab"),re=v("q-tabs"),j=v("q-icon"),G=v("q-input"),F=v("q-btn"),Q=v("q-btn-group"),H=v("q-table"),J=v("q-tab-panel"),ce=v("q-tab-panels"),ue=v("q-card");return z(),ge(ye,null,[i("div",Ce,[Ie,a(O,{class:"separator"}),i("div",Oe,[a(we,{onOnClick:te,label:"Crear nuevo producto"}),i("div",ze,[a(ue,null,{default:c(()=>[a(re,{modelValue:r(q),"onUpdate:modelValue":l[0]||(l[0]=t=>w(q)?q.value=t:q=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[a(y,{name:"active",label:"Activos"}),a(y,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),a(O),a(ce,{modelValue:r(q),"onUpdate:modelValue":l[3]||(l[3]=t=>w(q)?q.value=t:q=t),animated:""},{default:c(()=>[a(J,{name:"active"},{default:c(()=>[a(H,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:k.value,columns:W.value,filter:r(m),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[a(G,{borderless:"",dense:"",debounce:"300",modelValue:r(m),"onUpdate:modelValue":l[1]||(l[1]=t=>w(m)?m.value=t:m=t),placeholder:"Search"},{append:c(()=>[a(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(t=>[i("td",Ae,[a(Q,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[a(F,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:K=>oe(t.row)},null,8,["onClick"]),a(F,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:K=>ae(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),a(J,{name:"inactive"},{default:c(()=>[a(H,{flat:"",bordered:"",title:"Bodegas","row-key":"name",rows:x.value,columns:W.value,filter:r(m),loading:u.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[a(G,{borderless:"",dense:"",debounce:"300",modelValue:r(m),"onUpdate:modelValue":l[2]||(l[2]=t=>w(m)?m.value=t:m=t),placeholder:"Search"},{append:c(()=>[a(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(t=>[i("td",Be,[a(Q,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[a(F,{"text-color":"blue-10",class:"col q-pa-none",onClick:K=>se(t.row._id)},{default:c(()=>[Ee]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),r(n).modalIsOpen?(z(),N(fe,{key:0},{default:c(()=>[i("h6",Me,be(b.value),1),i("div",Ue,[i("div",Fe,[a(A,{label:"Nombre",required:!0,type:"text",ruless:I,value:r(B),modelValue:r(p),"onUpdate:modelValue":l[4]||(l[4]=t=>w(p)?p.value=t:p=t),onOnWrite:Y},null,8,["value","modelValue"]),a(A,{class:"q-pb-xs",label:"Categoria",required:!0,type:"text",ruless:I,value:r(E),modelValue:r(g),"onUpdate:modelValue":l[5]||(l[5]=t=>w(g)?g.value=t:g=t),onOnWrite:Z},null,8,["value","modelValue"]),a(A,{class:"q-pb-xs",label:"Marca",required:!0,type:"text",ruless:I,value:r(M),modelValue:r(f),"onUpdate:modelValue":l[6]||(l[6]=t=>w(f)?f.value=t:f=t),onOnWrite:$},null,8,["value","modelValue"]),a(A,{class:"q-pb-xs",label:"Cantidad",required:!0,type:"text",ruless:I,value:r(U),modelValue:r(_),"onUpdate:modelValue":l[7]||(l[7]=t=>w(_)?_.value=t:_=t),onOnWrite:ee},null,8,["value","modelValue"]),Ne,i("div",Re,[d.value?(z(),N(L,{key:0,disable:r(T),onOnClick:ne},null,8,["disable"])):(z(),N(L,{key:1,disable:r(T),onOnClick:le},null,8,["disable"]))])])])]),_:1})):_e("",!0)],64)}}},je=ie(De,[["__scopeId","data-v-b0c242e0"]]);export{je as default};
