import{s as V,_ as de,m as ve,g as u,q as pe,f as W,l as ge,v as _e,x as me,r as p,o as x,c as L,a as i,d as e,w as c,h as v,i as N,M as fe,j as Q,F as ye,y as w,t as be,z as H,B as J,p as he,e as qe,A as K}from"./index-a2b1bd69.js";import{g as A,B as Ce}from"./ButtonAdd-ed09f57b.js";const we=async l=>{try{const r=A(),{data:n}=await V.get("/inventory/category",{headers:{token:r,farm:l}});return n}catch(r){return r}},ke=async(l,r)=>{try{const n=A(),{data:s}=await V.post("/inventory/category/register",{name:l.name,description:l.description},{headers:{token:n,farm:r}});return s}catch(n){return n}},xe=async(l,r)=>{try{const n=A(),{data:s}=await V.put(`/inventory/category/update/${l.id}`,{name:l.name,description:l.description},{headers:{token:n,farm:r}});return s}catch(n){return n}},Ve=async(l,r)=>{try{const n=A(),{data:s}=await V.put(`/inventory/category/inactivate/${l}`,{},{headers:{token:n,farm:r}});return s}catch(n){return n}},Ae=async(l,r)=>{try{const n=A(),{data:s}=await V.put(`/inventory/category/activate/${l}`,{},{headers:{token:n,farm:r}});return s}catch(n){return n}};const R=l=>(he("data-v-d3b1ec0e"),l=l(),qe(),l),Ie={class:"q-py-md table-container"},Se={class:"row"},Oe=R(()=>i("h6",{class:"title q-my-lg"},"CATEGORIAS",-1)),Ee={class:"container-content"},ze={class:"container-table q-mt-md q-pa-md",rounded:""},Ne={class:"accions-td"},Re={class:"accions-td"},Be=R(()=>i("i",{class:"icon icon-check"},null,-1)),De={class:"q-my-md text-center"},Me={class:"row q-px-xl"},Te={class:"col-12"},Ue=R(()=>i("span",{class:"text-required q-pb-sm"},[K("Todos los campos con "),i("span",{class:"text-red"},"*"),K(" son obligatorios")],-1)),Fe={class:"row justify-center"},Ge={key:0,class:"spinner"},$e={__name:"Categories",setup(l){const r=ve(),n=u(""),s=u(!1),S=u(!0),h=u([]),k=u([]),B=u(),y=u(!1),P=pe(),D=W(()=>!g.value||!_.value?!0:y.value==!0),X=[t=>!!t||"Este campo es requerido"];let m=u(""),g=u(""),_=u(""),O=u(""),E=u(""),b=u("active");const Y=ge(),M=u([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),Z=t=>{g.value=t},ee=t=>{_.value=t},te=()=>{n.value="REGISTRAR CATEGORIAS",O.value="",E.value="",S.value=!0,r.toggleModal(),g.value="",_.value=""},ae=t=>{n.value="EDITAR CATEGORIAS",S.value=!1,B.value=t._id,O.value=t.name,E.value=t.description,g.value=t.name,_.value=t.description,r.toggleModal()},f=(t,o)=>{Y.notify({type:t,message:o,position:"top"})},q=async()=>{h.value=[],k.value=[],s.value=!0;try{const{category:t}=await we(C.value);let o=1,I=1;t.forEach(d=>{d.status=d.status?"Inactivo":"Activo",d.status=="Activo"?(d.id=o++,h.value.push(d)):(d.id=I++,k.value.push(d)),d.description=d.description.trim()==""?"No registra":d.description}),s.value=!1}catch{s.value=!1,f("negative","Ocurrió un error")}};async function oe(){y.value=!0;try{const t=await ke({name:g.value,description:_.value},C.value);y.value=!1,f("positive","Categorias registrada correctamente"),r.toggleModal(),h.value=[],q()}catch{y.value=!1,f("negative","Ocurrió un error")}}async function ne(){y.value=!0;try{const t=await xe({id:B.value,name:g.value,description:_.value},C.value);y.value=!1,f("positive","Categoria actualizada correctamente"),r.toggleModal(),h.value=[],q()}catch{y.value=!1,f("negative","Ocurrió un error")}g.value="",_.value=""}async function se(t){s.value=!0;try{const o=await Ae(t,C.value);f("positive","Categoria activada correctamente"),s.value=!1,h.value=[],k.value=[],q()}catch{s.value=!1,f("negative","Ocurrió un error")}}async function le(t){s.value=!0;try{const o=await Ve(t,C.value);f("positive","Categoria desactivada correctamente"),s.value=!1,h.value=[],k.value=[],q()}catch{s.value=!1,f("negative","Ocurrió un error")}}const C=W(()=>P.idSelected);return _e(C,()=>{q()}),me(()=>{q()}),(t,o)=>{const I=p("q-separator"),d=p("q-tab"),re=p("q-tabs"),T=p("q-icon"),U=p("q-input"),z=p("q-btn"),F=p("q-btn-group"),G=p("q-table"),$=p("q-tab-panel"),ce=p("q-tab-panels"),ie=p("q-card"),ue=p("q-spinner-ios");return x(),L(ye,null,[i("div",Ie,[i("div",Se,[i("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=a=>t.$router.back())}),Oe]),e(I,{class:"separator"}),i("div",Ee,[e(Ce,{onOnClick:te,label:"Crear nueva categoria"}),i("div",ze,[e(ie,null,{default:c(()=>[e(re,{modelValue:v(b),"onUpdate:modelValue":o[1]||(o[1]=a=>w(b)?b.value=a:b=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[e(d,{name:"active",label:"Activos"}),e(d,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),e(I),e(ce,{modelValue:v(b),"onUpdate:modelValue":o[4]||(o[4]=a=>w(b)?b.value=a:b=a),animated:""},{default:c(()=>[e($,{name:"active"},{default:c(()=>[e(G,{flat:"",bordered:"",title:"Categorias","row-key":"name",rows:h.value,columns:M.value,filter:v(m),loading:s.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[e(U,{borderless:"",dense:"",debounce:"300",modelValue:v(m),"onUpdate:modelValue":o[2]||(o[2]=a=>w(m)?m.value=a:m=a),placeholder:"Search"},{append:c(()=>[e(T,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(a=>[i("td",Ne,[e(F,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[e(z,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:j=>ae(a.row)},null,8,["onClick"]),e(z,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:j=>le(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),e($,{name:"inactive"},{default:c(()=>[e(G,{flat:"",bordered:"",title:"Categorias","row-key":"name",rows:k.value,columns:M.value,filter:v(m),loading:s.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[e(U,{borderless:"",dense:"",debounce:"300",modelValue:v(m),"onUpdate:modelValue":o[3]||(o[3]=a=>w(m)?m.value=a:m=a),placeholder:"Search"},{append:c(()=>[e(T,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(a=>[i("td",Re,[e(F,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[e(z,{"text-color":"blue-10",class:"col q-pa-none",onClick:j=>se(a.row._id)},{default:c(()=>[Be]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),v(r).modalIsOpen?(x(),N(fe,{key:0},{default:c(()=>[i("h6",De,be(n.value),1),i("div",Me,[i("div",Te,[e(H,{label:"Nombre",required:!0,type:"text",ruless:X,value:v(O),modelValue:v(g),"onUpdate:modelValue":o[5]||(o[5]=a=>w(g)?g.value=a:g=a),onOnWrite:Z},null,8,["value","modelValue"]),e(H,{class:"q-mb-md",label:"Descripción",type:"text",required:!1,value:v(E),modelValue:v(_),"onUpdate:modelValue":o[6]||(o[6]=a=>w(_)?_.value=a:_=a),onOnWrite:ee},null,8,["value","modelValue"]),Ue,i("div",Fe,[S.value?(x(),N(J,{key:0,disable:v(D),onOnClick:oe},null,8,["disable"])):(x(),N(J,{key:1,disable:v(D),onOnClick:ne},null,8,["disable"]))]),y.value?(x(),L("div",Ge,[e(ue,{color:"primary",size:"2.5em"})])):Q("",!0)])])]),_:1})):Q("",!0)],64)}}},Le=de($e,[["__scopeId","data-v-d3b1ec0e"]]);export{Le as default};
