import{_ as Oe,m as Ie,q as Ce,g as s,v as Ae,f as te,x as De,y as Ee,r as d,o as x,c as oe,a as n,d as t,w as u,h as o,i as D,M as Ue,j as G,F as Me,D as Ne,z as c,t as Be,A as E,E as U,B as se,p as Te,e as Re,C as ne,X as Fe,Y as We,Z as je,$ as He}from"./index-8f765b36.js";import{B as Je}from"./ButtonAdd-2181087a.js";const P=C=>(Te("data-v-8adc517b"),C=C(),Re(),C),Ge={class:"q-py-md table-container"},Pe={class:"row"},Qe=P(()=>n("h6",{class:"title q-my-lg"},"LOTES",-1)),Xe={class:"container-content"},Ye={class:"container-table q-mt-md q-pa-md",rounded:""},Ze={class:"accions-td"},Ke={class:"accions-td"},$e=P(()=>n("i",{class:"icon icon-check"},null,-1)),ea={class:"modal-lots"},aa={class:"q-my-md text-center"},la={class:"row q-px-xl"},ta={class:"col-12"},oa=P(()=>n("span",{class:"text-required q-pb-sm"},[ne("Todos los campos con "),n("span",{class:"text-red"},"*"),ne(" son obligatorios")],-1)),sa={class:"row justify-center"},na={key:1,class:"spinner"},ua={__name:"Lots",setup(C){const ue=Ie(),O=Ce(),M=s(""),v=s(!1),N=s(!0),w=s([]),I=s([]),Q=s(),re=Ae(),h=s(!1),X=te(()=>(f.value,m.value,g.value,b.value,i.value,_.value?h.value==!0:!0)),V=[e=>!!e||"Este campo es requerido"];let p=s(""),S=s("active"),f=s(""),m=s(""),g=s(""),b=s(""),i=s(""),_=s(""),y=s(""),L=s(""),B=s(""),T=s(""),R=s(""),F=s(""),W=s(""),j=s(""),H=s(""),ie=s("");const Y=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"areasize",label:"Tamaño",field:"areasize",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"soildstate",label:"Estado del suelo",field:"soildstate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"classlot",label:"Clase",field:"classlote",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"fatherlot",label:"Lote padre",field:"fatherlot",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"sowingdensity",label:"Densidad de siembra",field:"sowingdensity",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),de=e=>{f.value=e},ce=e=>{m.value=e},ve=e=>{g.value=e},pe=e=>{b.value=e},fe=e=>{i.value=e},me=e=>{_.value=e},ge=e=>{y.value=e},be=e=>{L.value=e},_e=()=>{M.value="REGISTRAR LOTE",ye(),N.value=!0,O.toggleModal()},ye=()=>{B.value="",T.value="",R.value="",F.value="",W.value="",j.value="",H.value="",f.value="",m.value="",g.value="",b.value="",i.value="",_.value="",y.value=""},qe=e=>{M.value="EDITAR LOTE",N.value=!1,Q.value=e._id,B.value=e.name,T.value=e.areasize,R.value=e.lotestate,F.value=e.soildstate,W.value=e.classlot,j.value=e.sowingdensity,H.value=e.description,f.value=e.name,m.value=e.areasize,g.value=e.lotestate,b.value=e.soildstate,i.value=e.classlot,_.value=e.sowingdensity,y.value=e.description,O.toggleModal()},q=(e,l)=>{ue.notify({type:e,message:l,position:"top"})},z=async()=>{w.value=[],I.value=[],v.value=!0;try{const{lots:e}=await Ne(k.value);let l=1,A=1;e.forEach(r=>{r.status=r.status?"Inactivo":"Activo",r.status=="Activo"?(r.id=l++,w.value.push(r)):(r.id=A++,I.value.push(r)),r.description=r.description.trim()==""?"No registra":r.description}),v.value=!1}catch{v.value=!1,q("negative","Ocurrió un error")}};async function he(){h.value=!0;try{await Fe({name:f.value,areasize:m.value,lotestate:g.value,soildstate:b.value,classlote:i.value,fatherlot:L.value,sowingdensity:_.value,description:y.value},k.value),h.value=!1,q("positive","Lote registrado correctamente"),O.toggleModal(),w.value=[],z()}catch{h.value=!1,q("negative","Ocurrió un error, por favor verifique los datos")}}async function Se(){h.value=!0;try{const e=await We({id:Q.value,name:f.value,areasize:m.value,lotestate:g.value,soildstate:b.value,classlot:i.value,fatherlot:fatherlot.value,sowingdensity:_.value,description:y.value},k.value);h.value=!1,q("positive","Lote actualizado correctamente"),O.toggleModal(),w.value=[],z()}catch{h.value=!1,q("negative","Ocurrió un error, por favor verifique los datos")}}async function we(e){v.value=!0;try{const l=await je(e,k.value);q("positive","Eps activada correctamente"),v.value=!1,w.value=[],I.value=[],z()}catch{v.value=!1,q("negative","Ocurrió un error")}}async function Ve(e){try{const l=await He(e,k.value);v.value=!1,q("positive","Eps desactivada correctamente"),w.value=[],I.value=[],z()}catch{v.value=!1,q("negative","Ocurrió un error")}}const k=te(()=>re.idSelected);return De(k,()=>{z()}),Ee(()=>{z()}),(e,l)=>{const A=d("q-separator"),r=d("q-tab"),Le=d("q-tabs"),Z=d("q-icon"),K=d("q-input"),J=d("q-btn"),$=d("q-btn-group"),ee=d("q-table"),ae=d("q-tab-panel"),ze=d("q-tab-panels"),ke=d("q-card"),xe=d("q-spinner-ios");return x(),oe(Me,null,[n("div",Ge,[n("div",Pe,[n("i",{class:"icon icon-backRoute q-pt-lg",onClick:l[0]||(l[0]=a=>e.$router.back())}),Qe]),t(A,{class:"separator"}),n("div",Xe,[t(Je,{onOnClick:_e,label:"Crear nuevo lote"}),n("div",Ye,[t(ke,null,{default:u(()=>[t(Le,{modelValue:o(S),"onUpdate:modelValue":l[1]||(l[1]=a=>c(S)?S.value=a:S=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[t(r,{name:"active",label:"Activos"}),t(r,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),t(A),t(ze,{modelValue:o(S),"onUpdate:modelValue":l[4]||(l[4]=a=>c(S)?S.value=a:S=a),animated:""},{default:u(()=>[t(ae,{name:"active"},{default:u(()=>[t(ee,{flat:"",bordered:"",title:"Lotes","row-key":"name",rows:w.value,columns:Y.value,filter:o(p),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":u(()=>[t(K,{borderless:"",dense:"",debounce:"300",modelValue:o(p),"onUpdate:modelValue":l[2]||(l[2]=a=>c(p)?p.value=a:p=a),placeholder:"Search"},{append:u(()=>[t(Z,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":u(a=>[n("td",Ze,[t($,{class:"full-width full-height",outline:"",square:""},{default:u(()=>[t(J,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:le=>qe(a.row)},null,8,["onClick"]),t(J,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:le=>Ve(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),t(ae,{name:"inactive"},{default:u(()=>[t(ee,{flat:"",bordered:"",title:"Lotes","row-key":"name",rows:I.value,columns:Y.value,filter:o(p),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":u(()=>[t(K,{borderless:"",dense:"",debounce:"300",modelValue:o(p),"onUpdate:modelValue":l[3]||(l[3]=a=>c(p)?p.value=a:p=a),placeholder:"Search"},{append:u(()=>[t(Z,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":u(a=>[n("td",Ke,[t($,{class:"full-width full-height",outline:"",square:""},{default:u(()=>[t(J,{"text-color":"blue-10",class:"col q-pa-none",onClick:le=>we(a.row._id)},{default:u(()=>[$e]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),o(O).modalIsOpen?(x(),D(Ue,{key:0,class:"modal"},{default:u(()=>[n("div",ea,[n("h6",aa,Be(M.value),1),n("div",la,[n("div",ta,[t(E,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:V,value:o(B),modelValue:o(f),"onUpdate:modelValue":l[5]||(l[5]=a=>c(f)?f.value=a:f=a),onOnWrite:de},null,8,["value","modelValue"]),t(E,{class:"q-pb-xs",label:"Tamaño",type:"number",required:!0,ruless:V,value:o(T),modelValue:o(m),"onUpdate:modelValue":l[6]||(l[6]=a=>c(m)?m.value=a:m=a),onOnWrite:ce},null,8,["value","modelValue"]),t(U,{class:"q-pb-lg",label:"Estado del lote",type:"lotState",required:!0,ruless:V,value:o(R),modelValue:o(g),"onUpdate:modelValue":l[7]||(l[7]=a=>c(g)?g.value=a:g=a),onOnSelect:ve},null,8,["value","modelValue"]),t(U,{class:"q-pb-lg",label:"Estado del suelo",type:"soildState",required:!0,ruless:V,value:o(F),modelValue:o(b),"onUpdate:modelValue":l[8]||(l[8]=a=>c(b)?b.value=a:b=a),onOnSelect:pe},null,8,["value","modelValue"]),t(U,{class:"q-pb-lg",label:"Clase",type:"typeLot",required:!0,ruless:V,value:o(W),modelValue:o(i),"onUpdate:modelValue":l[9]||(l[9]=a=>c(i)?i.value=a:i=a),onOnSelect:fe},null,8,["value","modelValue"]),o(i)=="HIJO"||o(i)=="PADRE-HIJO"?(x(),D(U,{key:0,class:"q-pb-lg",label:"Lote padre",type:"fatherLot",required:!0,ruless:V,value:o(ie),modelValue:o(L),"onUpdate:modelValue":l[10]||(l[10]=a=>c(L)?L.value=a:L=a),onOnSelect:be},null,8,["value","modelValue"])):G("",!0),t(E,{class:"q-pb-xs",label:"Densidad de siembra",type:"number",required:!0,ruless:V,value:o(j),modelValue:o(_),"onUpdate:modelValue":l[11]||(l[11]=a=>c(_)?_.value=a:_=a),onOnWrite:me},null,8,["value","modelValue"]),t(E,{class:"q-pb-xs",label:"Descripción",type:"text",required:!1,value:o(H),modelValue:o(y),"onUpdate:modelValue":l[12]||(l[12]=a=>c(y)?y.value=a:y=a),onOnWrite:ge},null,8,["value","modelValue"]),oa,n("div",sa,[N.value?(x(),D(se,{key:0,disable:o(X),onOnClick:he},null,8,["disable"])):(x(),D(se,{key:1,disable:o(X),onOnClick:Se},null,8,["disable"]))]),h.value?(x(),oe("div",na,[t(xe,{color:"primary",size:"2.5em"})])):G("",!0)])])])]),_:1})):G("",!0)],64)}}},da=Oe(ua,[["__scopeId","data-v-8adc517b"]]);export{da as default};
