import{s as V,_ as de,m as ve,g as s,f as me,l as pe,x as fe,r as u,o as x,c as Q,a as i,d as t,w as r,h as c,i as E,M as _e,j as H,F as ge,y as q,t as be,z as B,B as J,p as ye,e as he,A as K}from"./index-a2b1bd69.js";import{g as A,B as we}from"./ButtonAdd-ed09f57b.js";const qe=async()=>{try{const l=A(),{data:n}=await V.get("/maintenance/farm",{headers:{token:l}});return n}catch(l){return l}},ke=async l=>{try{const n=A(),{data:d}=await V.post("/maintenance/farm/register",{name:l.name,address:l.address,owner:l.owner},{headers:{token:n}});return d}catch(n){return n}},Fe=async l=>{try{const n=A(),{data:d}=await V.put(`/maintenance/farm/update/${l.id}`,{name:l.name,address:l.address,owner:l.owner},{headers:{token:n}});return d}catch(n){return n}},xe=async l=>{try{const n=A(),{data:d}=await V.put(`/maintenance/farm/inactive/${l}`,{},{headers:{token:n}});return d}catch(n){return n}},Ve=async l=>{try{const n=A(),{data:d}=await V.put(`/maintenance/farm/active/${l}`,{},{headers:{token:n}});return d}catch(n){return n}};const U=l=>(ye("data-v-0157dcd5"),l=l(),he(),l),Ae={class:"q-py-md table-container"},Ie={class:"row"},Ce=U(()=>i("h6",{class:"title q-my-lg"},"FINCA",-1)),Se={class:"container-content"},Oe={class:"container-table q-mt-md q-pa-md",rounded:""},ze={class:"accions-td"},Ne={class:"accions-td"},Me=U(()=>i("i",{class:"icon icon-check"},null,-1)),Ee={class:"q-my-md text-center"},Be={class:"row q-px-xl"},Ue={class:"col-12"},Re=U(()=>i("span",{class:"text-required q-pb-sm"},[K("Todos los campos con "),i("span",{class:"text-red"},"*"),K(" son obligatorios")],-1)),De={class:"row justify-center"},Te={key:0,class:"spinner"},je={__name:"Farm",setup(l){const n=ve(),d=s(""),v=s(!1),C=s(!0),y=s(!1),w=s([]),k=s([]),R=s(),D=me(()=>m.value==""||p.value==""||f.value==""?!0:y.value==!0),S=[e=>!!e||"Este campo es requerido"];let _=s(""),m=s(""),p=s(""),f=s(""),O=s(""),z=s(""),N=s(""),h=s("active");const X=pe(),T=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"address",label:"Ubicación",field:"address",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"owner",label:"Propietario",field:"owner",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Y=e=>{m.value=e},Z=e=>{p.value=e},ee=e=>{f.value=e},ae=()=>{d.value="REGISTRAR FINCA",O.value="",z.value="",N.value="",C.value=!0,n.toggleModal(),m.value="",p.value="",f.value=""},te=e=>{d.value="EDITAR FINCA",C.value=!1,R.value=e._id,O.value=e.name,z.value=e.address,N.value=e.owner,m.value=e.name,p.value=e.address,f.value=e.owner,n.toggleModal()},b=(e,o)=>{X.notify({type:e,message:o,position:"top"})};async function F(){w.value=[],k.value=[],v.value=!0;try{const{farms:e}=await qe();let o=1,I=1;e.forEach(g=>{g.status=g.status?"Inactivo":"Activo",g.status=="Activo"?(g.id=o++,w.value.push(g)):(g.id=I++,k.value.push(g))}),v.value=!1}catch{v.value=!1,b("negative","Ocurrió un error")}}async function oe(){y.value=!0;try{const e=await ke({name:m.value,address:p.value,owner:f.value});y.value=!1,n.toggleModal(),b("positive","Finca registrada correctamente"),w.value=[],F()}catch{y.value=!1,b("negative","Ocurrió un error")}}async function ne(){y.value=!0;try{const e=await Fe({id:R.value,name:m.value,address:p.value,owner:f.value});y.value=!1,b("positive","Finca actualizada correctamente"),n.toggleModal(),w.value=[],F()}catch{y.value=!1,b("negative","Ocurrió un error")}m.value="",p.value="",f.value=""}async function le(e){v.value=!0;try{const o=await Ve(e);v.value=!1,b("positive","Finca activada correctamente"),w.value=[],k.value=[],F()}catch{v.value=!1,b("negative","Ocurrió un error")}}async function se(e){v.value=!0;try{const o=await xe(e);v.value=!1,b("positive","Finca desactivada correctamente"),w.value=[],k.value=[],F()}catch{v.value=!1,b("negative","Ocurrió un error")}}return fe(()=>{F()}),(e,o)=>{const I=u("q-separator"),g=u("q-tab"),re=u("q-tabs"),j=u("q-icon"),W=u("q-input"),M=u("q-btn"),$=u("q-btn-group"),P=u("q-table"),G=u("q-tab-panel"),ce=u("q-tab-panels"),ie=u("q-card"),ue=u("q-spinner-ios");return x(),Q(ge,null,[i("div",Ae,[i("div",Ie,[i("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=a=>e.$router.back())}),Ce]),t(I,{class:"separator"}),i("div",Se,[t(we,{onOnClick:ae,label:"Crear nueva finca"}),i("div",Oe,[t(ie,null,{default:r(()=>[t(re,{modelValue:c(h),"onUpdate:modelValue":o[1]||(o[1]=a=>q(h)?h.value=a:h=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[t(g,{name:"active",label:"Activos"}),t(g,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),t(I),t(ce,{modelValue:c(h),"onUpdate:modelValue":o[4]||(o[4]=a=>q(h)?h.value=a:h=a),animated:""},{default:r(()=>[t(G,{name:"active"},{default:r(()=>[t(P,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:w.value,columns:T.value,filter:c(_),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[t(W,{borderless:"",dense:"",debounce:"300",modelValue:c(_),"onUpdate:modelValue":o[2]||(o[2]=a=>q(_)?_.value=a:_=a),placeholder:"Search"},{append:r(()=>[t(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(a=>[i("td",ze,[t($,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[t(M,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:L=>te(a.row)},null,8,["onClick"]),t(M,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:L=>se(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),t(G,{name:"inactive"},{default:r(()=>[t(P,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:k.value,columns:T.value,filter:c(_),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[t(W,{borderless:"",dense:"",debounce:"300",modelValue:c(_),"onUpdate:modelValue":o[3]||(o[3]=a=>q(_)?_.value=a:_=a),placeholder:"Search"},{append:r(()=>[t(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(a=>[i("td",Ne,[t($,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[t(M,{"text-color":"blue-10",class:"col q-pa-none",onClick:L=>le(a.row._id)},{default:r(()=>[Me]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(n).modalIsOpen?(x(),E(_e,{key:0},{default:r(()=>[i("h6",Ee,be(d.value),1),i("div",Be,[i("div",Ue,[t(B,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:S,value:c(O),modelValue:c(m),"onUpdate:modelValue":o[5]||(o[5]=a=>q(m)?m.value=a:m=a),onOnWrite:Y},null,8,["value","modelValue"]),t(B,{class:"q-pb-xs",label:"Ubicación",type:"text",required:!0,ruless:S,value:c(z),modelValue:c(p),"onUpdate:modelValue":o[6]||(o[6]=a=>q(p)?p.value=a:p=a),onOnWrite:Z},null,8,["value","modelValue"]),t(B,{class:"q-pb-xs",label:"Propietario",required:!0,type:"text",ruless:S,value:c(N),modelValue:c(f),"onUpdate:modelValue":o[7]||(o[7]=a=>q(f)?f.value=a:f=a),onOnWrite:ee},null,8,["value","modelValue"]),Re,i("div",De,[C.value?(x(),E(J,{key:0,disable:c(D),onOnClick:oe},null,8,["disable"])):(x(),E(J,{key:1,disable:c(D),onOnClick:ne},null,8,["disable"]))]),y.value?(x(),Q("div",Te,[t(ue,{color:"primary",size:"2.5em"})])):H("",!0)])])]),_:1})):H("",!0)],64)}}},Pe=de(je,[["__scopeId","data-v-0157dcd5"]]);export{Pe as default};
