import{l as I,s as C,_ as fe,m as _e,q as ye,g as l,v as ge,f as K,x as he,y as be,r as d,o as V,c as P,a as i,d as a,w as r,h as c,i as T,M as xe,j as X,F as we,z as q,t as qe,A as M,B as Y,p as Ae,e as ke,C as Z}from"./index-6c614867.js";import{B as Ee}from"./ButtonAdd-91711192.js";const Ve=async n=>{try{const u=I(),{data:s}=await C.get("/costs/activityexpenses",{headers:{token:u,farm:n}});return s}catch(u){return u}},Ie=async(n,u)=>{try{const s=I(),{data:v}=await C.post("/costs/activityexpenses/register",{name:n.name,description:n.description,worth:n.worth},{headers:{token:s,farm:u}});return v}catch(s){return s}},Ce=async(n,u)=>{try{const s=I(),{data:v}=await C.put(`/costs/activityexpenses/update/${n.id}`,{name:n.name,description:n.description,worth:n.worth},{headers:{token:s,farm:u}});return v}catch(s){return s}},Se=async(n,u)=>{try{const s=I(),{data:v}=await C.put(`/costs/activityexpenses/inactivate/${n}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}},De=async(n,u)=>{try{const s=I(),{data:v}=await C.put(`/costs/activityexpenses/activate/${n}`,{},{headers:{token:s,farm:u}});return v}catch(s){return s}};const R=n=>(Ae("data-v-6ca21939"),n=n(),ke(),n),Oe={class:"q-py-sm table-container"},ze={class:"row"},Ge=R(()=>i("h6",{class:"title q-my-lg"},"Gastos de Actividades",-1)),Be={class:"container-content"},Ne={class:"container-table q-mt-md q-pa-md",rounded:""},Te={class:"accions-td"},Me={class:"accions-td"},Re=R(()=>i("i",{class:"icon icon-check"},null,-1)),Ue={class:"modal-activity"},Fe={class:"q-my-md text-center"},We={class:"row q-px-xl"},je={class:"col-12"},$e=R(()=>i("span",{class:"text-required q-pb-sm"},[Z("Todos los campos con "),i("span",{class:"text-red"},"*"),Z(" son obligatorios")],-1)),Le={class:"row justify-center"},Qe={key:0,class:"spinner"},He={__name:"ActivityExpenses",setup(n){const u=_e(),s=ye(),v=l(""),p=l(!1),D=l(!0),w=l([]),E=l([]),U=l(),ee=ge(),b=l(!1),F=K(()=>m.value==""||_.value==""||f.value==""?!0:b.value==!0),O=[e=>!!e||"Este campo es requerido"];let y=l(""),x=l("active"),m=l(""),f=l(""),_=l(""),z=l(""),G=l(""),B=l("");const W=l([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"worth",label:"Valor",field:"worth",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),te=e=>{m.value=e},ae=e=>{f.value=e},oe=e=>{_.value=e},se=()=>{v.value="REGISTRAR GASTO DE ACITIVIDAD",ne(),D.value=!0,s.toggleModal()},ne=()=>{z.value="",G.value="",B.value="",m.value="",f.value="",_.value=""},le=e=>{v.value="EDITAR GASTO DE ACTIVIDAD",D.value=!1,U.value=e._id,z.value=e.name,G.value=e.description,B.value=e.worth,m.value=e.name,f.value=e.description,_.value=e.worth,s.toggleModal()},h=(e,o)=>{u.notify({type:e,message:o,position:"top"})},A=async()=>{w.value=[],E.value=[],p.value=!0;try{const{activityexpenses:e}=await Ve(k.value);let o=1,S=1;e.forEach(g=>{g.status=g.status?"Inactivo":"Activo",g.status=="Activo"?(g.id=o++,w.value.push(g)):(g.id=S++,E.value.push(g))}),p.value=!1}catch{p.value=!1,h("negative","Ocurrió un error")}};async function ie(){b.value=!0;try{const e=await Ie({name:m.value,description:f.value,worth:_.value},k.value);b.value=!1,h("positive","Gasto de actividad registrado correctamente"),s.toggleModal(),w.value=[],A()}catch{b.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}}async function re(){b.value=!0;try{const e=await Ce({id:U.value,name:m.value,description:f.value,worth:_.value},k.value);b.value=!1,h("positive","Gasto de actividad actualizado correctamente"),s.toggleModal(),w.value=[],A()}catch{b.value=!1,h("negative","Ocurrió un error, por favor verifique los datos")}m.value="",f.value="",_.value=""}async function ce(e){p.value=!0;try{const o=await De(e,k.value);h("positive","Gasto de actividad activado correctamente"),p.value=!1,w.value=[],E.value=[],A()}catch{p.value=!1,h("negative","Ocurrió un error")}}async function ue(e){p.value=!1;try{const o=await Se(e,k.value);p.value=!1,h("positive","Gasto de actividad desactivado correctamente"),w.value=[],E.value=[],A()}catch{p.value=!1,h("negative","Ocurrió un error")}}const k=K(()=>ee.idSelected);return he(k,()=>{A()}),be(()=>{A()}),(e,o)=>{const S=d("q-separator"),g=d("q-tab"),de=d("q-tabs"),j=d("q-icon"),$=d("q-input"),N=d("q-btn"),L=d("q-btn-group"),Q=d("q-table"),H=d("q-tab-panel"),ve=d("q-tab-panels"),pe=d("q-card"),me=d("q-spinner-ios");return V(),P(we,null,[i("div",Oe,[i("div",ze,[i("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=t=>e.$router.back())}),Ge]),a(S,{class:"separator"}),i("div",Be,[a(Ee,{onOnClick:se,label:"Crear nuevo gasto de actividad"}),i("div",Ne,[a(pe,null,{default:r(()=>[a(de,{modelValue:c(x),"onUpdate:modelValue":o[1]||(o[1]=t=>q(x)?x.value=t:x=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[a(g,{name:"active",label:"Activos"}),a(g,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),a(S),a(ve,{modelValue:c(x),"onUpdate:modelValue":o[4]||(o[4]=t=>q(x)?x.value=t:x=t),animated:""},{default:r(()=>[a(H,{name:"active"},{default:r(()=>[a(Q,{flat:"",bordered:"",title:"Gastos de Actividades","row-key":"name",rows:w.value,columns:W.value,filter:c(y),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[a($,{borderless:"",dense:"",debounce:"300",modelValue:c(y),"onUpdate:modelValue":o[2]||(o[2]=t=>q(y)?y.value=t:y=t),placeholder:"Search"},{append:r(()=>[a(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(t=>[i("td",Te,[a(L,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[a(N,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:J=>le(t.row)},null,8,["onClick"]),a(N,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:J=>ue(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),a(H,{name:"inactive"},{default:r(()=>[a(Q,{flat:"",bordered:"",title:"Gastos de Actividades","row-key":"name",rows:E.value,columns:W.value,filter:c(y),loading:p.value,"rows-per-page-options":[5,10,20]},{"top-right":r(()=>[a($,{borderless:"",dense:"",debounce:"300",modelValue:c(y),"onUpdate:modelValue":o[3]||(o[3]=t=>q(y)?y.value=t:y=t),placeholder:"Search"},{append:r(()=>[a(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":r(t=>[i("td",Me,[a(L,{class:"full-width full-height",outline:"",square:""},{default:r(()=>[a(N,{"text-color":"blue-10",class:"col q-pa-none",onClick:J=>ce(t.row._id)},{default:r(()=>[Re]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(s).modalIsOpen?(V(),T(xe,{key:0,class:"modal"},{default:r(()=>[i("div",Ue,[i("h6",Fe,qe(v.value),1),i("div",We,[i("div",je,[a(M,{label:"Nombre",required:!0,type:"text",ruless:O,value:c(z),modelValue:c(m),"onUpdate:modelValue":o[5]||(o[5]=t=>q(m)?m.value=t:m=t),onOnWrite:te},null,8,["value","modelValue"]),a(M,{class:"q-mb-md",label:"Descripción",required:!0,type:"text",ruless:O,value:c(G),modelValue:c(f),"onUpdate:modelValue":o[6]||(o[6]=t=>q(f)?f.value=t:f=t),onOnWrite:ae},null,8,["value","modelValue"]),a(M,{class:"q-pb-xs",label:"Valor",required:!0,type:"text",ruless:O,value:c(B),modelValue:c(_),"onUpdate:modelValue":o[7]||(o[7]=t=>q(_)?_.value=t:_=t),onOnWrite:oe},null,8,["value","modelValue"]),$e,i("div",Le,[D.value?(V(),T(Y,{key:0,disable:c(F),onOnClick:ie},null,8,["disable"])):(V(),T(Y,{key:1,disable:c(F),onOnClick:re},null,8,["disable"]))]),b.value?(V(),P("div",Qe,[a(me,{color:"primary",size:"2.5em"})])):X("",!0)])])])]),_:1})):X("",!0)],64)}}},Pe=fe(He,[["__scopeId","data-v-6ca21939"]]);export{Pe as default};
