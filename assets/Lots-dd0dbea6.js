import{s as D,_ as ke,l as Le,m as Ie,g as s,q as Ee,f as le,v as Oe,x as Ce,r as v,o as A,c as oe,a as u,d as l,w as i,h as r,i as H,M as Ae,j as se,F as De,y as w,t as Me,z as L,B as ne,p as Ue,e as Ne,A as re}from"./index-d466a28b.js";import{g as M,B as Te}from"./ButtonAdd-005d7d30.js";const Be=async o=>{try{const c=M(),{data:n}=await D.get("/maintenance/lots",{headers:{token:c,farm:o}});return n}catch(c){return c}},Re=async(o,c)=>{try{const n=M(),{data:p}=await D.post("/maintenance/lots/register",{name:o.name,areasize:o.areasize,lotestate:o.lotestate,soildstate:o.soildstate,classlote:o.classlote,sowingdensity:o.sowingdensity,description:o.description},{headers:{token:n,farm:c}});return p}catch(n){return n}},We=async(o,c)=>{try{const n=M(),{data:p}=await D.put(`/maintenance/lots/update/${o.id}`,{name:o.name,areasize:o.areasize,lotestate:o.lotestate,soildstate:o.soildstate,classlote:o.classlote,sowingdensity:o.sowingdensity,description:o.description},{headers:{token:n,farm:c}});return p}catch(n){return n}},Fe=async(o,c)=>{try{const n=M(),{data:p}=await D.put(`/maintenance/lots/inactive/${o}`,{},{headers:{token:n,farm:c}});return p}catch(n){return n}},je=async(o,c)=>{try{const n=M(),{data:p}=await D.put(`/maintenance/lots/active/${o}`,{},{headers:{token:n,farm:c}});return p}catch(n){return n}};const J=o=>(Ue("data-v-f4d76663"),o=o(),Ne(),o),Ge={class:"q-py-md table-container"},Qe={class:"row"},He=J(()=>u("h6",{class:"title q-my-lg"},"LOTES",-1)),Je={class:"container-content"},Ke={class:"container-table q-mt-md q-pa-md",rounded:""},Pe={class:"accions-td"},Xe={class:"accions-td"},Ye=J(()=>u("i",{class:"icon icon-check"},null,-1)),Ze={class:"q-my-md text-center"},$e={class:"row q-px-xl"},et={class:"col-12"},tt=J(()=>u("span",{class:"text-required q-pb-sm"},[re("Todos los campos con "),u("span",{class:"text-red"},"*"),re(" son obligatorios")],-1)),at={class:"row justify-center"},lt={key:0,class:"spinner"},ot={__name:"Lots",setup(o){const c=Le(),n=Ie(),p=s(""),f=s(!1),N=s(!0),x=s([]),C=s([]),K=s(),ie=Ee(),k=s(!1),P=le(()=>g.value==""||m.value==""||b.value==""||_.value==""||y.value||q.value?!0:k.value==!0),I=[e=>!!e||"Este campo es requerido"];let h=s(""),S=s("active"),g=s(""),m=s(""),b=s(""),_=s(""),y=s(""),q=s(""),V=s(""),T=s(""),B=s(""),R=s(""),W=s(""),F=s(""),j=s(""),G=s("");const X=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"areasize",label:"Tamaño",field:"areasize",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"lotestate",label:"Estado del lote",field:"lotestate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"soildstate",label:"Estado del suelo",field:"soildstate",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"classlot",label:"Clase",field:"classlot",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"sowingdensity",label:"Densidad de siembra",field:"sowingdensity",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),ue=e=>{g.value=e},ce=e=>{m.value=e},de=e=>{b.value=e},ve=e=>{_.value=e},pe=e=>{y.value=e},fe=e=>{q.value=e},ge=e=>{V.value=e},me=()=>{p.value="REGISTRAR LOTE",be(),N.value=!0,n.toggleModal()},be=()=>{T.value="",B.value="",R.value="",W.value="",F.value="",j.value="",G.value="",g.value="",m.value="",b.value="",_.value="",y.value="",q.value="",V.value=""},_e=e=>{p.value="EDITAR LOTE",N.value=!1,K.value=e._id,T.value=e.name,B.value=e.areasize,R.value=e.lotestate,W.value=e.soildstate,F.value=e.classlot,j.value=e.sowingdensity,G.value=e.description,g.value=e.name,m.value=e.areasize,b.value=e.lotestate,_.value=e.soildstate,y.value=e.classlot,q.value=e.sowingdensity,V.value=e.description,n.toggleModal()},z=(e,a)=>{c.notify({type:e,message:a,position:"top"})},E=async()=>{x.value=[],C.value=[],f.value=!0;try{const{lots:e}=await Be(O.value);let a=1,U=1;e.forEach(d=>{d.status=d.status?"Inactivo":"Activo",d.status=="Activo"?(d.id=a++,x.value.push(d)):(d.id=U++,C.value.push(d)),d.description=d.description.trim()==""?"No registra":d.description}),f.value=!1}catch{f.value=!1,z("negative","Ocurrió un error")}};async function ye(){k.value=!0;try{const e=await Re({name:g.value,areasize:m.value,lotestate:b.value,soildstate:_.value,classlot:y.value,sowingdensity:q.value,description:V.value},O.value);k.value=!1,z("positive","Lote registrado correctamente"),n.toggleModal(),x.value=[],E()}catch{f.value=!1,z("negative","Ocurrió un error, por favor verifique los datos")}}async function qe(){k.value=!0;try{const e=await We({id:K.value,name:g.value,areasize:m.value,lotestate:b.value,soildstate:_.value,classlot:y.value,sowingdensity:q.value,description:V.value},O.value);k.value=!1,z("positive","Lote actualizado correctamente"),n.toggleModal(),x.value=[],E()}catch{k.value=!1,z("negative","Ocurrió un error, por favor verifique los datos")}g.value="",m.value="",b.value="",_.value="",y.value="",q.value="",V.value=""}async function we(e){f.value=!0;try{const a=await je(e,O.value);z("positive","Eps activada correctamente"),f.value=!1,x.value=[],C.value=[],E()}catch{f.value=!1,z("negative","Ocurrió un error")}}async function he(e){try{const a=await Fe(e,O.value);f.value=!1,z("positive","Eps desactivada correctamente"),x.value=[],C.value=[],E()}catch{f.value=!1,z("negative","Ocurrió un error")}}const O=le(()=>ie.idSelected);return Oe(O,()=>{E()}),Ce(()=>{E()}),(e,a)=>{const U=v("q-separator"),d=v("q-tab"),Ve=v("q-tabs"),Y=v("q-icon"),Z=v("q-input"),Q=v("q-btn"),$=v("q-btn-group"),ee=v("q-table"),te=v("q-tab-panel"),ze=v("q-tab-panels"),Se=v("q-card"),xe=v("q-spinner-ios");return A(),oe(De,null,[u("div",Ge,[u("div",Qe,[u("i",{class:"icon icon-backRoute q-pt-lg",onClick:a[0]||(a[0]=t=>e.$router.back())}),He]),l(U,{class:"separator"}),u("div",Je,[l(Te,{onOnClick:me,label:"Crear nuevo lote"}),u("div",Ke,[l(Se,null,{default:i(()=>[l(Ve,{modelValue:r(S),"onUpdate:modelValue":a[1]||(a[1]=t=>w(S)?S.value=t:S=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[l(d,{name:"active",label:"Activos"}),l(d,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),l(U),l(ze,{modelValue:r(S),"onUpdate:modelValue":a[4]||(a[4]=t=>w(S)?S.value=t:S=t),animated:""},{default:i(()=>[l(te,{name:"active"},{default:i(()=>[l(ee,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:x.value,columns:X.value,filter:r(h),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[l(Z,{borderless:"",dense:"",debounce:"300",modelValue:r(h),"onUpdate:modelValue":a[2]||(a[2]=t=>w(h)?h.value=t:h=t),placeholder:"Search"},{append:i(()=>[l(Y,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(t=>[u("td",Pe,[l($,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[l(Q,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:ae=>_e(t.row)},null,8,["onClick"]),l(Q,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:ae=>he(t.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),l(te,{name:"inactive"},{default:i(()=>[l(ee,{flat:"",bordered:"",title:"Etapas","row-key":"name",rows:C.value,columns:X.value,filter:r(h),loading:f.value,"rows-per-page-options":[5,10,20]},{"top-right":i(()=>[l(Z,{borderless:"",dense:"",debounce:"300",modelValue:r(h),"onUpdate:modelValue":a[3]||(a[3]=t=>w(h)?h.value=t:h=t),placeholder:"Search"},{append:i(()=>[l(Y,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":i(t=>[u("td",Xe,[l($,{class:"full-width full-height",outline:"",square:""},{default:i(()=>[l(Q,{"text-color":"blue-10",class:"col q-pa-none",onClick:ae=>we(t.row._id)},{default:i(()=>[Ye]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),r(n).modalIsOpen?(A(),H(Ae,{key:0},{default:i(()=>[u("h6",Ze,Me(p.value),1),u("div",$e,[u("div",et,[l(L,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:I,value:r(T),modelValue:r(g),"onUpdate:modelValue":a[5]||(a[5]=t=>w(g)?g.value=t:g=t),onOnWrite:ue},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Tamaño",type:"number",required:!0,ruless:I,value:r(B),modelValue:r(m),"onUpdate:modelValue":a[6]||(a[6]=t=>w(m)?m.value=t:m=t),onOnWrite:ce},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Estado del lote",type:"text",required:!0,ruless:I,value:r(R),modelValue:r(b),"onUpdate:modelValue":a[7]||(a[7]=t=>w(b)?b.value=t:b=t),onOnWrite:de},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Estado del suelo",type:"text",required:!0,ruless:I,value:r(W),modelValue:r(_),"onUpdate:modelValue":a[8]||(a[8]=t=>w(_)?_.value=t:_=t),onOnWrite:ve},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Clase",type:"text",required:!0,ruless:I,value:r(F),modelValue:r(y),"onUpdate:modelValue":a[9]||(a[9]=t=>w(y)?y.value=t:y=t),onOnWrite:pe},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Densidad de siembra",type:"number",required:!0,ruless:I,value:r(j),modelValue:r(q),"onUpdate:modelValue":a[10]||(a[10]=t=>w(q)?q.value=t:q=t),onOnWrite:fe},null,8,["value","modelValue"]),l(L,{class:"q-pb-xs",label:"Descripción",type:"text",required:!1,value:r(G),modelValue:r(V),"onUpdate:modelValue":a[11]||(a[11]=t=>w(V)?V.value=t:V=t),onOnWrite:ge},null,8,["value","modelValue"]),tt,u("div",at,[N.value?(A(),H(ne,{key:0,disable:r(P),onOnClick:ye},null,8,["disable"])):(A(),H(ne,{key:1,disable:r(P),onOnClick:qe},null,8,["disable"]))]),k.value?(A(),oe("div",lt,[l(xe,{color:"primary",size:"2.5em"})])):se("",!0)])])]),_:1})):se("",!0)],64)}}},rt=ke(ot,[["__scopeId","data-v-f4d76663"]]);export{rt as default};
