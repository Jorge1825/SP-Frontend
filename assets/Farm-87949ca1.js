import{l as V,s as A,_ as de,q as ve,g as s,f as me,m as pe,y as fe,r as u,o as x,c as Q,a as r,d as t,w as c,h as i,i as E,M as _e,j as H,F as be,z as q,t as ge,A as B,B as J,p as ye,e as he,C as K}from"./index-8f765b36.js";import{B as we}from"./ButtonAdd-2181087a.js";const qe=async()=>{try{const l=V(),{data:n}=await A.get("/maintenance/farm",{headers:{token:l}});return n}catch(l){return l}},ke=async l=>{try{const n=V(),{data:d}=await A.post("/maintenance/farm/register",{name:l.name,address:l.address,owner:l.owner},{headers:{token:n}});return d}catch(n){return n}},Fe=async l=>{try{const n=V(),{data:d}=await A.put(`/maintenance/farm/update/${l.id}`,{name:l.name,address:l.address,owner:l.owner},{headers:{token:n}});return d}catch(n){return n}},xe=async l=>{try{const n=V(),{data:d}=await A.put(`/maintenance/farm/inactive/${l}`,{},{headers:{token:n}});return d}catch(n){return n}},Ve=async l=>{try{const n=V(),{data:d}=await A.put(`/maintenance/farm/active/${l}`,{},{headers:{token:n}});return d}catch(n){return n}};const U=l=>(ye("data-v-ef685a11"),l=l(),he(),l),Ae={class:"q-py-md table-container"},Ie={class:"row"},Ce=U(()=>r("h6",{class:"title q-my-lg"},"FINCA",-1)),Se={class:"container-content"},Oe={class:"container-table q-mt-md q-pa-md",rounded:""},ze={class:"accions-td"},Ne={class:"accions-td"},Me=U(()=>r("i",{class:"icon icon-check"},null,-1)),Ee={class:"modal-farm"},Be={class:"q-my-md text-center"},Ue={class:"row q-px-xl"},Re={class:"col-12"},De=U(()=>r("span",{class:"text-required q-pb-sm"},[K("Todos los campos con "),r("span",{class:"text-red"},"*"),K(" son obligatorios")],-1)),Te={class:"row justify-center"},je={key:0,class:"spinner"},We={__name:"Farm",setup(l){const n=ve(),d=s(""),v=s(!1),C=s(!0),y=s(!1),w=s([]),k=s([]),R=s(),D=me(()=>m.value==""||p.value==""||f.value==""?!0:y.value==!0),S=[e=>!!e||"Este campo es requerido"];let _=s(""),m=s(""),p=s(""),f=s(""),O=s(""),z=s(""),N=s(""),h=s("active");const X=pe(),T=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"address",label:"Ubicación",field:"address",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"owner",label:"Propietario",field:"owner",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Y=e=>{m.value=e},Z=e=>{p.value=e},ee=e=>{f.value=e},ae=()=>{d.value="REGISTRAR FINCA",O.value="",z.value="",N.value="",C.value=!0,n.toggleModal(),m.value="",p.value="",f.value=""},te=e=>{d.value="EDITAR FINCA",C.value=!1,R.value=e._id,O.value=e.name,z.value=e.address,N.value=e.owner,m.value=e.name,p.value=e.address,f.value=e.owner,n.toggleModal()},g=(e,o)=>{X.notify({type:e,message:o,position:"top"})};async function F(){w.value=[],k.value=[],v.value=!0;try{const{farms:e}=await qe();let o=1,I=1;e.forEach(b=>{b.status=b.status?"Inactivo":"Activo",b.status=="Activo"?(b.id=o++,w.value.push(b)):(b.id=I++,k.value.push(b))}),v.value=!1}catch{v.value=!1,g("negative","Ocurrió un error")}}async function oe(){y.value=!0;try{const e=await ke({name:m.value,address:p.value,owner:f.value});y.value=!1,n.toggleModal(),g("positive","Finca registrada correctamente"),w.value=[],F()}catch{y.value=!1,g("negative","Ocurrió un error")}}async function ne(){y.value=!0;try{const e=await Fe({id:R.value,name:m.value,address:p.value,owner:f.value});y.value=!1,g("positive","Finca actualizada correctamente"),n.toggleModal(),w.value=[],F()}catch{y.value=!1,g("negative","Ocurrió un error")}m.value="",p.value="",f.value=""}async function le(e){v.value=!0;try{const o=await Ve(e);v.value=!1,g("positive","Finca activada correctamente"),w.value=[],k.value=[],F()}catch{v.value=!1,g("negative","Ocurrió un error")}}async function se(e){v.value=!0;try{const o=await xe(e);v.value=!1,g("positive","Finca desactivada correctamente"),w.value=[],k.value=[],F()}catch{v.value=!1,g("negative","Ocurrió un error")}}return fe(()=>{F()}),(e,o)=>{const I=u("q-separator"),b=u("q-tab"),re=u("q-tabs"),j=u("q-icon"),W=u("q-input"),M=u("q-btn"),$=u("q-btn-group"),P=u("q-table"),G=u("q-tab-panel"),ce=u("q-tab-panels"),ie=u("q-card"),ue=u("q-spinner-ios");return x(),Q(be,null,[r("div",Ae,[r("div",Ie,[r("i",{class:"icon icon-backRoute q-pt-lg",onClick:o[0]||(o[0]=a=>e.$router.back())}),Ce]),t(I,{class:"separator"}),r("div",Se,[t(we,{onOnClick:ae,label:"Crear nueva finca"}),r("div",Oe,[t(ie,null,{default:c(()=>[t(re,{modelValue:i(h),"onUpdate:modelValue":o[1]||(o[1]=a=>q(h)?h.value=a:h=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[t(b,{name:"active",label:"Activos"}),t(b,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),t(I),t(ce,{modelValue:i(h),"onUpdate:modelValue":o[4]||(o[4]=a=>q(h)?h.value=a:h=a),animated:""},{default:c(()=>[t(G,{name:"active"},{default:c(()=>[t(P,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:w.value,columns:T.value,filter:i(_),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[t(W,{borderless:"",dense:"",debounce:"300",modelValue:i(_),"onUpdate:modelValue":o[2]||(o[2]=a=>q(_)?_.value=a:_=a),placeholder:"Search"},{append:c(()=>[t(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(a=>[r("td",ze,[t($,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[t(M,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:L=>te(a.row)},null,8,["onClick"]),t(M,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:L=>se(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),t(G,{name:"inactive"},{default:c(()=>[t(P,{flat:"",bordered:"",title:"Finca","row-key":"name",rows:k.value,columns:T.value,filter:i(_),loading:v.value,"rows-per-page-options":[5,10,20]},{"top-right":c(()=>[t(W,{borderless:"",dense:"",debounce:"300",modelValue:i(_),"onUpdate:modelValue":o[3]||(o[3]=a=>q(_)?_.value=a:_=a),placeholder:"Search"},{append:c(()=>[t(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":c(a=>[r("td",Ne,[t($,{class:"full-width full-height",outline:"",square:""},{default:c(()=>[t(M,{"text-color":"blue-10",class:"col q-pa-none",onClick:L=>le(a.row._id)},{default:c(()=>[Me]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),i(n).modalIsOpen?(x(),E(_e,{key:0,class:"modal"},{default:c(()=>[r("div",Ee,[r("h6",Be,ge(d.value),1),r("div",Ue,[r("div",Re,[t(B,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:S,value:i(O),modelValue:i(m),"onUpdate:modelValue":o[5]||(o[5]=a=>q(m)?m.value=a:m=a),onOnWrite:Y},null,8,["value","modelValue"]),t(B,{class:"q-pb-xs",label:"Ubicación",type:"text",required:!0,ruless:S,value:i(z),modelValue:i(p),"onUpdate:modelValue":o[6]||(o[6]=a=>q(p)?p.value=a:p=a),onOnWrite:Z},null,8,["value","modelValue"]),t(B,{class:"q-pb-xs",label:"Propietario",required:!0,type:"text",ruless:S,value:i(N),modelValue:i(f),"onUpdate:modelValue":o[7]||(o[7]=a=>q(f)?f.value=a:f=a),onOnWrite:ee},null,8,["value","modelValue"]),De,r("div",Te,[C.value?(x(),E(J,{key:0,disable:i(D),onOnClick:oe},null,8,["disable"])):(x(),E(J,{key:1,disable:i(D),onOnClick:ne},null,8,["disable"]))]),y.value?(x(),Q("div",je,[t(ue,{color:"primary",size:"2.5em"})])):H("",!0)])])])]),_:1})):H("",!0)],64)}}},Ge=de(We,[["__scopeId","data-v-ef685a11"]]);export{Ge as default};
