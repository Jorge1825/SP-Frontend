import{g as C,m as ve,M as fe,B as ye,a as J}from"./ButtonSave-fa15d2e0.js";import{s as I,_ as _e,x as ge,f as s,h as be,l as he,r as i,o as S,c as we,a as c,d as a,w as u,i as r,g as A,j as K,F as qe,m as b,v as R,t as Se,q as X,A as Y,C as xe,p as Ve,e as Ue}from"./index-dd023763.js";const ke=async()=>{try{const n=C(),{data:l}=await I.get("/users",{headers:{token:n}});return l}catch(n){return n}},Ae=async n=>{try{const l=C(),{data:d}=await I.post("/users/register",{name:n.name,tpdocument:n.tpdocument,numdocument:n.numdocument,role:n.role,password:n.password},{headers:{token:l}});console.log(d)}catch(l){return l}},Ce=async n=>{try{const l=C(),{data:d}=await I.put(`/users/inactive/${n}`,{},{headers:{token:l}});return d}catch(l){return l}},Ie=async n=>{try{const l=C(),{data:d}=await I.put(`/users/active/${n}`,{},{headers:{token:l}});return d}catch(l){return l}};const M=n=>(Ve("data-v-9c682193"),n=n(),Ue(),n),De={class:"q-py-md table-container"},Oe=M(()=>c("h6",{class:"title q-my-lg"},"ACCESO AL SISTEMA",-1)),ze={class:"container-content"},Ee={class:"container-table q-mt-md q-pa-md",rounded:""},Ne={style:{padding:"0px",margin:"0px","min-width":"100px","max-width":"20px"}},Te={style:{padding:"0px",margin:"0px","min-width":"100px","max-width":"100px"}},Be=M(()=>c("i",{class:"icon icon-check"},null,-1)),Re={class:"q-my-md text-center"},Me={class:"row q-px-xl"},Fe={class:"col-12"},Pe=M(()=>c("span",{class:"text-required q-py-sm"},[R("Todos los campos con "),c("span",{class:"text-red"},"*"),R(" son obligatorios")],-1)),je={class:"row justify-center q-mt-sm"},Ge={__name:"SystemView",setup(n){const l=ge(),d=ve(),D=s(""),x=s(!1),O=s(!0),w=s([]),q=s([]),Z=s();let z=s(""),E=s(""),N=s(""),T=s(""),v=s(""),f=s(""),y=s(""),_=s(""),g=s(""),m=s(""),h=s("active");const F=be(()=>!v.value||!f.value||!y.value||!_.value||!g.value),V=[t=>!!t||"Este campo es requerido"],P=s([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Nombre",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Tipo",label:"Tipo",field:"tpdocument",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Documento",label:"Documento",field:"numdocument",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"role",label:"Rol",field:"role",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"}]),$=t=>{v.value=t},ee=t=>{f.value=t},te=t=>{y.value=t},ae=t=>{_.value=t},oe=t=>{g.value=t},le=t=>{D.value="REGISTRAR ACCESO",ne(),O.value=!0,d.toggleModal()},ne=()=>{z.value="",E.value="",N.value="",T.value="",v.value="",f.value="",y.value="",_.value="",g.value=""},se=t=>{D.value="EDITAR TIPO DE PAGO",O.value=!1,Z.value=t._id,z.value=t.name,E.value=t.tpdocument,N.value=t.numdocument,T.value=t.role,v.value=t.name,f.value=t.tpdocument,y.value=t.numdocument,_.value=t.role,d.toggleModal()};async function re(){console.log(g.value)}async function U(){w.value=[],q.value=[],x.value=!0;try{const t=await ke();let o=1,k=1;t.forEach(p=>{p.status=p.status?"Inactivo":"Activo",p.status=="Activo"?(p.id=o++,w.value.push(p)):(p.id=k++,q.value.push(p))}),x.value=!1}catch{l.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function ue(t){try{const o=await Ce(t);l.notify({type:"positive",message:"Usuario desactivado correctamente",position:"top"}),w.value=[],q.value=[],U()}catch{l.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function ce(t){try{const o=await Ie(t);l.notify({type:"positive",message:"Usuario activado correctamente",position:"top"}),w.value=[],q.value=[],U()}catch{l.notify({type:"negative",message:"Ocurrió un error"})}}async function ie(){try{const{data:t}=await Ae({name:v.value,tpdocument:f.value,numdocument:y.value,role:_.value,password:g.value});d.toggleModal(),w.value=[],l.notify({type:"positive",message:"Usuario registrado correctamente",position:"top"}),U()}catch{l.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}return he(()=>{U()}),(t,o)=>{const k=i("q-separator"),p=i("q-tab"),de=i("q-tabs"),j=i("q-icon"),G=i("q-input"),B=i("q-btn"),W=i("q-btn-group"),L=i("q-table"),Q=i("q-tab-panel"),me=i("q-tab-panels"),pe=i("q-card");return S(),we(qe,null,[c("div",De,[Oe,a(k,{class:"separator"}),c("div",ze,[a(ye,{onOnClick:le,label:"Crear nuevo usuario"}),c("div",Ee,[a(pe,null,{default:u(()=>[a(de,{modelValue:r(h),"onUpdate:modelValue":o[0]||(o[0]=e=>b(h)?h.value=e:h=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[a(p,{name:"active",label:"Activos"}),a(p,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),a(k),a(me,{modelValue:r(h),"onUpdate:modelValue":o[3]||(o[3]=e=>b(h)?h.value=e:h=e),animated:""},{default:u(()=>[a(Q,{name:"active"},{default:u(()=>[a(L,{flat:"",bordered:"",title:"Usuarios","row-key":"name",rows:w.value,columns:P.value,filter:r(m),loading:x.value,"rows-per-page-options":[5,10,20]},{"top-right":u(()=>[a(G,{borderless:"",dense:"",debounce:"300",modelValue:r(m),"onUpdate:modelValue":o[1]||(o[1]=e=>b(m)?m.value=e:m=e),placeholder:"Buscar"},{append:u(()=>[a(j,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":u(e=>[c("td",Ne,[a(W,{class:"full-width full-height",outline:"",square:""},{default:u(()=>[a(B,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:H=>se(e.row)},null,8,["onClick"]),e.row.role=="ADMIN"?(S(),A(B,{key:0,icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none icon-table",onClick:H=>ue(e.row._id)},null,8,["onClick"])):K("",!0)]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),a(Q,{name:"inactive"},{default:u(()=>[a(L,{flat:"",bordered:"",title:"Usuarios","row-key":"name",rows:q.value,columns:P.value,filter:r(m),loading:x.value,"rows-per-page-options":[5,10,20]},{"top-right":u(()=>[a(G,{borderless:"",dense:"",debounce:"300",modelValue:r(m),"onUpdate:modelValue":o[2]||(o[2]=e=>b(m)?m.value=e:m=e),placeholder:"Buscar"},{append:u(()=>[a(j,{name:"search"})]),_:1},8,["modelValue"]),R("´ ")]),"body-cell-Acciones":u(e=>[c("td",Te,[a(W,{class:"full-width full-height",outline:"",square:""},{default:u(()=>[a(B,{"text-color":"blue-10",class:"col q-pa-none",onClick:H=>ce(e.row._id)},{default:u(()=>[Be]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),r(d).modalIsOpen?(S(),A(fe,{key:0},{default:u(()=>[c("h6",Re,Se(D.value),1),c("div",Me,[c("div",Fe,[a(X,{label:"Nombre",type:"text",required:!0,ruless:V,value:r(z),modelValue:r(v),"onUpdate:modelValue":o[4]||(o[4]=e=>b(v)?v.value=e:v=e),onOnWrite:$},null,8,["value","modelValue"]),a(Y,{class:"q-pb-xs q-mb-md",type:"documents",label:"Tipo de documento",required:!0,ruless:V,value:r(E),modelValue:r(f),"onUpdate:modelValue":o[5]||(o[5]=e=>b(f)?f.value=e:f=e),onOnSelect:ee},null,8,["value","modelValue"]),a(X,{label:"Número documento",type:"number",required:!0,ruless:V,value:r(N),modelValue:r(y),"onUpdate:modelValue":o[6]||(o[6]=e=>b(y)?y.value=e:y=e),onOnWrite:te},null,8,["value","modelValue"]),a(Y,{class:"q-pb-xs q-mb-md",type:"roles",label:"Rol",required:!0,value:r(T),modelValue:r(_),"onUpdate:modelValue":o[7]||(o[7]=e=>b(_)?_.value=e:_=e),onOnSelect:ae},null,8,["value","modelValue"]),a(xe,{label:"Contraseña",required:!0,ruless:V,modelValue:r(g),"onUpdate:modelValue":o[8]||(o[8]=e=>b(g)?g.value=e:g=e),onOnPassword:oe},null,8,["modelValue"]),Pe,c("div",je,[O.value?(S(),A(J,{key:0,disable:r(F),onOnClick:ie},null,8,["disable"])):(S(),A(J,{key:1,disable:r(F),onOnClick:re},null,8,["disable"]))])])])]),_:1})):K("",!0)],64)}}},Qe=_e(Ge,[["__scopeId","data-v-9c682193"]]);export{Qe as default};
