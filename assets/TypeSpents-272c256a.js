import{x as w,_ as oe,f as r,h as ne,l as se,m as le,r as v,o as x,c as ie,a as d,d as t,w as l,i as c,g as E,j as re,F as ce,q as b,t as de,s as j,p as ue,e as pe,v as F}from"./index-a0c708ca.js";import{g as S,m as ve,M as me,B as fe,a as W}from"./ModalForm-cb6eb8ec.js";const _e=async()=>{const s=S();try{const{data:e}=await w.get("/maintenance/spents",{headers:{token:s}});return e}catch(e){console.error(e)}},ye=async s=>{try{const e=S(),{data:u}=await w.post("/maintenance/spents/register",{name:s.name,description:s.description},{headers:{token:e}});return u}catch(e){console.error(e)}},ge=async s=>{try{const e=S(),{data:u}=await w.put(`/maintenance/spents/update/${s.id}`,{name:s.name,description:s.description},{headers:{token:e}});return u}catch(e){console.error(e)}},be=async s=>{try{const e=S(),{data:u}=await w.put(`/maintenance/spents/inactive/${s}`,{},{headers:{token:e}});return u}catch(e){console.error(e)}},he=async s=>{try{const e=S(),{data:u}=await w.put(`/maintenance/spents/active/${s}`,{},{headers:{token:e}});return u}catch(e){console.error(e)}};const C=s=>(ue("data-v-a65f96ed"),s=s(),pe(),s),qe={class:"q-py-md table-container"},we=C(()=>d("h6",{class:"title q-my-lg"},"TIPOS DE GASTOS",-1)),Se={class:"container-content"},ke={class:"container-table q-mt-md q-pa-md",rounded:""},Te={class:"accions-td"},xe={class:"accions-td"},Ve=C(()=>d("i",{class:"icon icon-check"},null,-1)),Ie={class:"q-my-md text-center"},Oe={class:"row q-px-xl"},Ae={class:"col-12"},Ee=C(()=>d("span",{class:"text-required q-pb-sm"},[F("Todos los campos con "),d("span",{class:"text-red"},"*"),F(" son obligatorios")],-1)),Ce={class:"row justify-center"},De={__name:"TypeSpents",setup(s){const e=ve(),u=r(""),k=r(!1),V=r(!0),g=r([]),h=r([]),D=r(),z=ne(()=>p.value==""),$=[o=>!!o||"Este campo es requerido"];let m=r(""),p=r(""),f=r(""),I=r(""),O=r(""),y=r("active");const _=se(),M=r([{name:"id",label:"#",field:"id",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"description",label:"Descripción",field:"description",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"status",label:"Estado",field:"status",align:"left",sortable:!0,headerStyle:"font-size: var(--font-large); font-weight: bold;",style:"font-size: var(--font-large);"},{name:"Acciones",label:"Acciones",field:"acciones",align:"left",sortable:!0,headerStyle:"font-size: var(--font-medium); font-weight: bold;",style:"font-size: var(--font-medium);"}]),Q=o=>{p.value=o},H=o=>{f.value=o},J=()=>{u.value="REGISTRAR TIPO DE GASTO",O.value="",I.value="",V.value=!0,e.toggleModal(),p.value="",f.value=""},K=o=>{u.value="EDITAR TIPO DE GASTO",V.value=!1,D.value=o._id,O.value=o.description,I.value=o.name,p.value=o.name,f.value=o.description,e.toggleModal()};async function L(o){try{const n=await be(o);_.notify({type:"positive",message:"Tipo de gasto desactivado correctamente",position:"top"}),g.value=[],h.value=[],q()}catch{_.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}async function X(){e.toggleModal();try{const o=await ye({name:p.value,description:f.value});_.notify({type:"positive",message:"Tipo de gasto registrado correctamente",position:"top"}),g.value=[],q()}catch{_.notify({type:"negative",message:"Ocurrió un error",position:"top"})}}const q=async()=>{g.value=[],h.value=[],k.value=!0;try{const{spents:o}=await _e();let n=1,T=1;o.forEach(i=>{i.status=i.status?"Inactivo":"Activo",i.status=="Activo"?(i.id=n++,g.value.push(i)):(i.id=T++,h.value.push(i)),i.description=i.description.trim()==""?"No registra":i.description}),k.value=!1}catch{_.notify({type:"negative",message:"Ocurrió un error",position:"top"})}};async function Y(){try{const o=await ge({id:D.value,name:p.value,description:f.value});_.notify({type:"positive",position:"top",message:"Tipo de gasto actualizado correctamente"}),e.toggleModal(),g.value=[],q()}catch{_.notify({type:"negative",position:"top",message:"Ocurrió un error"})}p.value="",f.value=""}async function Z(o){try{const n=await he(o);_.notify({type:"positive",message:"Tipo de gasto activado correctamente",position:"top"}),g.value=[],h.value=[],q()}catch{_.notify({type:"negative",message:"Ocurrió un error"})}}return le(()=>{q()}),(o,n)=>{const T=v("q-separator"),i=v("q-tab"),ee=v("q-tabs"),N=v("q-icon"),B=v("q-input"),A=v("q-btn"),G=v("q-btn-group"),R=v("q-table"),U=v("q-tab-panel"),te=v("q-tab-panels"),ae=v("q-card");return x(),ie(ce,null,[d("div",qe,[we,t(T,{class:"separator"}),d("div",Se,[t(fe,{onOnClick:J,label:"Crear tipo de gasto"}),d("div",ke,[t(ae,null,{default:l(()=>[t(ee,{modelValue:c(y),"onUpdate:modelValue":n[0]||(n[0]=a=>b(y)?y.value=a:y=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[t(i,{name:"active",label:"Activos"}),t(i,{name:"inactive",label:"Inactivos"})]),_:1},8,["modelValue"]),t(T),t(te,{modelValue:c(y),"onUpdate:modelValue":n[3]||(n[3]=a=>b(y)?y.value=a:y=a),animated:""},{default:l(()=>[t(U,{name:"active"},{default:l(()=>[t(R,{flat:"",bordered:"",title:"Gastos","row-key":"name",rows:g.value,columns:M.value,filter:c(m),loading:k.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(B,{borderless:"",dense:"",debounce:"300",modelValue:c(m),"onUpdate:modelValue":n[1]||(n[1]=a=>b(m)?m.value=a:m=a),placeholder:"Search"},{append:l(()=>[t(N,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(a=>[d("td",Te,[t(G,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t(A,{icon:"edit_note","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>K(a.row)},null,8,["onClick"]),t(A,{icon:"highlight_off","text-color":"blue-10",class:"col text-bold q-pa-none",onClick:P=>L(a.row._id)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1}),t(U,{name:"inactive"},{default:l(()=>[t(R,{flat:"",bordered:"",title:"Gastos","row-key":"name",rows:h.value,columns:M.value,filter:c(m),loading:k.value,"rows-per-page-options":[5,10,20]},{"top-right":l(()=>[t(B,{borderless:"",dense:"",debounce:"300",modelValue:c(m),"onUpdate:modelValue":n[2]||(n[2]=a=>b(m)?m.value=a:m=a),placeholder:"Search"},{append:l(()=>[t(N,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-Acciones":l(a=>[d("td",xe,[t(G,{class:"full-width full-height",outline:"",square:""},{default:l(()=>[t(A,{"text-color":"blue-10",class:"col q-pa-none",onClick:P=>Z(a.row._id)},{default:l(()=>[Ve]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["rows","columns","filter","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),c(e).modalIsOpen?(x(),E(me,{key:0},{default:l(()=>[d("h6",Ie,de(u.value),1),d("div",Oe,[d("div",Ae,[t(j,{class:"q-pb-xs",label:"Nombre",required:!0,type:"text",ruless:$,value:c(I),modelValue:c(p),"onUpdate:modelValue":n[4]||(n[4]=a=>b(p)?p.value=a:p=a),onOnWrite:Q},null,8,["value","modelValue"]),t(j,{label:"Descripción",type:"text",required:!1,value:c(O),modelValue:c(f),"onUpdate:modelValue":n[5]||(n[5]=a=>b(f)?f.value=a:f=a),onOnWrite:H},null,8,["value","modelValue"]),Ee,d("div",Ce,[V.value?(x(),E(W,{key:0,disable:c(z),onOnClick:X},null,8,["disable"])):(x(),E(W,{key:1,disable:c(z),onOnClick:Y},null,8,["disable"]))])])])]),_:1})):re("",!0)],64)}}},Ne=oe(De,[["__scopeId","data-v-a65f96ed"]]);export{Ne as default};
